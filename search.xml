<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[mysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆäºŒï¼‰â€”â€”ç´¢å¼•æ¦‚è¿°]]></title>
    <url>%2F2018%2F08%2F30%2FsqlIndexAndQueryOptimize-2%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢éš”äº†é‚£ä¹ˆä¹…ï¼Œç»ˆäºå†™äº†ç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–çš„ç¬¬äºŒç¯‡åšæ–‡ï¼Œç¡®å®ç”¨äº†å¥½é•¿çš„æ—¶é—´å»çœ‹ä¹¦ï¼Œçœ‹åšå®¢ç„¶åæ€»ç»“ã€‚ç„¶è€Œï¼Œä¸å¾—ä¸è¯´æˆ‘ä¹‹å‰å¯¹sqlä»¥åŠç´¢å¼•ç›¸å…³çš„çŸ¥è¯†äº†è§£ç¡®å®ç”šå°‘ï¼ˆå¹¶ä¸”åœ¨å®é™…ä¸­ç”¨çš„ä¹Ÿä¸å¤ªå¤šï¼‰ï¼Œå› æ­¤å³ä½¿è¡¥å……äº†ä¸€äº›ç›¸å…³çŸ¥è¯†ï¼Œ å†™å‡ºæ¥çš„æ–‡ç« ä¹Ÿä¼šæœ‰å¾ˆå¤šçš„ä¸è¶³ä¸çº°æ¼ã€‚åœ¨æ­¤ä¹Ÿå¸Œæœ›ä»æ–‡ç« ä¸­çœ‹å‡ºæœ‰ä»€ä¹ˆä¸è¶³çš„æœ‹å‹å¯ä»¥å°½æƒ…æ‰¹è¯„æŒ‡æ­£ï½è¿™ç¯‡åšå®¢ä¸»è¦åˆ†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ç®€å•ä»‹ç»äº†ç´¢å¼•çš„æ¦‚å¿µåŠç±»å‹ï¼›ç¬¬äºŒéƒ¨åˆ†ä»‹ç»äº†å¦‚ä½•é€šè¿‡ExplainæŒ‡ä»¤åˆ†æsqlï¼›ç¬¬ä¸‰éƒ¨åˆ†ç»™å‡ºäº†ä¸€äº›sqlçš„å®ä¾‹ã€‚ â… . ç´¢å¼•æ¦‚å¿µåŠç±»å‹1 ç´¢å¼•æ¦‚å¿µç´¢å¼•æ˜¯å­˜å‚¨å¼•æ“ç”¨æ¥å¿«é€Ÿæ‰¾åˆ°è®°å½•çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚ç±»ä¼¼äºä¹¦ç›®å½•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ‰¾â€œç¬¬ä¸‰ç« ç¬¬å››å°èŠ‚â€çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå…ˆä»ç›®å½•ä¸­æ‰¾åˆ°å…¶æ‰€åœ¨çš„é¡µæ•°ï¼Œç„¶åå†ä»å…·ä½“çš„é¡µä¸­æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚ç´¢å¼•ä¹Ÿæ˜¯ä¸€æ ·ï¼Œåœ¨æŸ¥è¯¢æ—¶ï¼Œå…ˆæ‰¾åˆ°ç´¢å¼•æ‰€åœ¨çš„ä½ç½®ï¼Œç„¶åæ ¹æ®ç´¢å¼•åŒ¹é…åˆ°çš„è®°å½•æ¥æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ã€‚ 2 ç´¢å¼•ç±»å‹ 2.1 b-treeç´¢å¼•b-treeç´¢å¼•æ˜¯mysqlå¼•æ“ä¸­ç”¨çš„è¾ƒå¤šçš„ä¸€ç§ç±»å‹ï¼Œå¤§å¤šæ•°çš„å¼•æ“éƒ½æ”¯æŒï¼Œé™¤äº†archiveå¼•æ“ï¼ˆå¯¹è¿™ä¸ªå¥½é™Œç”Ÿ - -ï¼‰ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“ä½¿ç”¨ä¸åŒçš„b-treeç´¢å¼•ï¼Œå¹¶ä¸”æ€§èƒ½ä¹Ÿæœ‰å·®åˆ«ã€‚æ¯”å¦‚åœ¨innodbå¼•æ“ä¸­ä½¿ç”¨b+treeç´¢å¼•ã€‚myisamå¼•æ“ä¼šå¯¹ç´¢å¼•è¿›è¡Œå‰ç¼€å‹ç¼©ï¼Œæ‰€ä»¥ç´¢å¼•å¾ˆæ›´å°ï¼›myisamä¸­ç´¢å¼•é€šè¿‡æ•°æ®çš„ç‰©ç†ä½ç½®æ¥å¼•ç”¨ç´¢å¼•è¡Œï¼Œè€Œinnodbä¸­æ ¹æ®ä¸»é”®å¼•ç”¨ç´¢å¼•è¡Œã€‚b-treeç´¢å¼•å¯¹ç´¢å¼•æŒ‰ç…§é¡ºåºç»„ç»‡å­˜å‚¨çš„ï¼Œå› æ­¤é€‚åˆæŸ¥æ‰¾èŒƒå›´æ•°æ®ã€‚ B-treeç´¢å¼•åœ¨å®é™…å¼€å‘ä¸­æ˜¯ç”¨çš„æœ€å¤šæœ€å¹¿æ³›çš„ç´¢å¼•ç»“æ„ï¼Œä¹‹åçš„è®¨è®ºéƒ½é»˜è®¤æ˜¯ä»¥B-treeç´¢å¼•ä¸ºä¾‹ã€‚åœ¨æŸäº›ä¸å½“çš„æŸ¥è¯¢æˆ–è€…ç´¢å¼•çš„ä½¿ç”¨ä¸­ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œä¸»è¦æœ‰ä»¥ä¸‹è¿™å‡ ç§æƒ…å†µï¼š ä¸¥æ ¼éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ã€‚å³æŸ¥è¯¢å¿…é¡»ä»ç´¢å¼•çš„æœ€å·¦å‰åˆ—å¼€å§‹ã€‚æ¯”å¦‚ä¸€ä¸ªç´¢å¼•(name_age_dob)ï¼Œå¦‚æœè¦æŸ¥è¯¢age=18çš„ç”¨æˆ·ï¼Œå°±æ— æ³•ä½¿ç”¨(name_age_dob)è¿™ä¸ªç´¢å¼•äº†ã€‚ ä¸èƒ½è·³è¿‡ç´¢å¼•ä¸­é—´çš„åˆ—ã€‚æ¯”å¦‚æˆ‘ä»¬è¦æŸ¥æ‰¾age=18å¹¶ä¸”dob=1024çš„ç”¨æˆ·ï¼Œä½†ä¸æŒ‡å®šageï¼Œé‚£ä¹ˆå°±æ— æ³•ä½¿ç”¨åˆ°(name_age_dob)ç´¢å¼•ï¼Œåªèƒ½ä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚ æŸ¥è¯¢ä¸­æŸä¸ªåˆ—å‡ºç°äº†èŒƒå›´æŸ¥è¯¢ï¼Œé‚£ä¹ˆå®ƒå³è¾¹çš„åˆ—éƒ½æ— æ³•é€šè¿‡ç´¢å¼•æ¥è¿›è¡Œä¼˜åŒ–æŸ¥è¯¢ã€‚è¿™åœ¨å‰ä¸€ç¯‡åšå®¢ï¼ˆxxxxï¼‰ä¸­å°±è®²è¿°è¿‡ã€‚ ç´¢å¼•å­—æ®µä¸Šä½¿ç”¨äº†ï¼ˆ!= &lt;&gt; is null is not null or æˆ–è€…likeä»¥â€%_â€ å¼€å¤´ï¼‰ç­‰ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å…¥å…¨è¡¨æ‰«æ å¯¹ç´¢å¼•åˆ—è¿›è¡Œæ“ä½œï¼ˆè¿™é‡ŒæŒ‡ç´¢å¼•åˆ—ä¸èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸èƒ½æ˜¯å‡½æ•°çš„å‚æ•°ï¼‰ï¼Œæ¯”å¦‚ä¸‹è¾¹çš„sqlå°±ä¸èƒ½ä½¿ç”¨ç´¢å¼•ï¼Œæ˜çœ¼äººä¸€çœ‹å°±çŸ¥é“id=1023å•Šï¼Œç„¶è€ŒMysqlå¼•æ“å¹¶ä¸ä¼šé‚£ä¹ˆçš„æ™ºèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æŸ¥è¯¢æ—¶èƒ½ç®€åŒ–æ¡ä»¶å°±ç®€åŒ–æ¡ä»¶ï¼Œè¶Šç®€å•è¶Šå¥½ã€‚ 1select id from user where id+1=1024 2.2 å“ˆå¸Œç´¢å¼•å“ˆå¸Œç´¢å¼•åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œmysqlå¼•æ“ä¸­åªæœ‰memoryæ”¯æŒå“ˆå¸Œç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“å“ˆå¸Œè¡¨ä¼šå­˜åœ¨â€œå“ˆå¸Œç¢°æ’â€çš„é—®é¢˜ï¼Œmemoryå¼•æ“æ ¹æ®é“¾è¡¨æ³•æ¥è§£å†³é”®å€¼å†²çªçš„æƒ…å†µã€‚ç±»æ¯”äºå“ˆå¸Œè¡¨ï¼Œä½¿ç”¨å“ˆå¸Œç´¢å¼•æŸ¥æ‰¾çš„é€Ÿåº¦ååˆ†å¿«ã€‚ä½†ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼š å“ˆå¸Œç´¢å¼•åªåŒ…å«å“ˆå¸Œå€¼ä»¥åŠè¡ŒæŒ‡é’ˆï¼Œä¸å­˜å‚¨å…·ä½“å­—æ®µçš„å€¼ï¼Œæ‰€ä»¥ä¸èƒ½æ ¹æ®åŒ¹é…ç´¢å¼•æ¥é¿å…è¯»å–è¡¨è¡Œ å“ˆå¸Œç´¢å¼•çš„æ•°æ®ä¸æ˜¯æŒ‰ç…§ç´¢å¼•å€¼é¡ºåºå­˜å‚¨çš„ï¼Œå› æ­¤æ— æ³•ç”¨äºæ’åºï¼ˆè¿™ä¸ªåº”è¯¥å¾ˆå¥½ç†è§£ï¼‰ å“ˆå¸Œç´¢å¼•å› ä¸ºæ˜¯æ ¹æ®å¯¹keyè¿›è¡Œhashæ¥æŸ¥æ‰¾çš„ï¼Œå› æ­¤ä¸æ”¯æŒéƒ¨åˆ†ç´¢å¼•åŒ¹é…çš„æƒ…å†µã€‚ å“ˆå¸Œç´¢å¼•ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼Œåªæ”¯æŒç­‰å€¼æŸ¥è¯¢ï¼ˆæ³¨æ„IN()ä¹Ÿæ˜¯ä¸€ç§ç­‰å€¼æŸ¥è¯¢ï¼ï¼‰ ä¸Šé¢è¯´åˆ°äº†å“ˆå¸Œç¢°æ’ï¼Œå¦‚æœç¢°æ’è¿‡å¤šï¼Œå“ˆå¸Œç´¢å¼•çš„æ€§èƒ½å°†å—å¾ˆå¤§çš„å½±å“ 2.3 å…¨æ–‡ç´¢å¼•å…¨æ–‡ç´¢å¼•æŸ¥æ‰¾çš„æ˜¯æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œè€Œä¸æ˜¯ç›´æ¥æ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼ã€‚ç”¨çš„ä¸å¤šï¼ˆæˆ‘æ ¹æœ¬æ²¡ç”¨è¿‡ï¼‰ï¼Œè¿™ä¹Ÿä¸æ˜¯æˆ‘æƒ³è¯´çš„é‡ç‚¹ï¼Œæ‰€ä»¥ä¸è¯¦ç»†å±•å¼€ã€‚ 2.4 èšç°‡ç´¢å¼•é¦–å…ˆï¼Œèšç°‡ç´¢å¼•å¹¶ä¸æ˜¯ä¸€ç§ç®€å•çš„ç´¢å¼•ç±»å‹ï¼Œè€Œæ˜¯ä¸€ç§æ•°æ®å­˜å‚¨æ–¹å¼ã€‚åœ¨innodbä¸­ï¼Œèšç°‡ç´¢å¼•å®é™…åœ¨ä¸€ä¸ªç»“æ„ä¸­åŒæ—¶ä¿å­˜äº†b-treeç´¢å¼•ä»¥åŠæ•°æ®è¡Œã€‚ èšç°‡ç´¢å¼•çš„æ•°æ®çš„ç‰©ç†å­˜æ”¾é¡ºåºä¸ç´¢å¼•é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œå³ï¼šåªè¦ç´¢å¼•æ˜¯ç›¸é‚»çš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®ä¸€å®šä¹Ÿæ˜¯ç›¸é‚»åœ°å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„ã€‚å› ä¸ºä¸€å¼ è¡¨åªæœ‰ä¸€ä¸ªç‰©ç†ç»“æ„ï¼Œå› æ­¤ä¸€å¼ è¡¨ä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ã€‚èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±æ˜¯æ•°æ®èŠ‚ç‚¹ï¼Œè€Œéèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä»ç„¶æ˜¯ç´¢å¼•èŠ‚ç‚¹ï¼Œå¹¶ä¸”æœ‰æŒ‡å‘å¯¹åº”æ•°æ®å—çš„æŒ‡é’ˆã€‚innodbé»˜è®¤ä¼šä»¥ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ä¸»é”®ï¼Œinnodbä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•æ¥ä»£æ›¿ã€‚å¦‚æœå‰é¢çš„æƒ…å†µéƒ½ä¸æ»¡è¶³ï¼Œé‚£ä¹ˆinnodbä¼šéšå¼å®šä¹‰ä¸€ä¸ªä¸»é”®æ¥ä½œä¸ºèšç°‡ç´¢å¼•ã€‚ 2.5 è¦†ç›–ç´¢å¼•è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰ä¹Ÿä¸æ˜¯å¸¸è§„æ„ä¹‰ä¸Šçš„ç´¢å¼•ã€‚å¦‚æœä¸€ä¸ªç´¢å¼•åŒ…å«äº†æ‰€æœ‰æŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼Œé‚£ä¹ˆä¹…ç§°è¿™ä¸ªç´¢å¼•ä¸ºâ€œè¦†ç›–ç´¢å¼•â€ã€‚ä½¿ç”¨â€œè¦†ç›–ç´¢å¼•â€å¯ä»¥æå¤§æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚ â…¡. SQLåˆ†æåœ¨è¿›è¡Œsqlåˆ†ææ—¶ï¼Œexplainè¯­å¥æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°†ä¸¾å‡ºä¸€äº›sqlçš„æŸ¥è¯¢æ¥è¿›è¡Œåˆ†æï¼Œä»¥ä¸‹çš„ä¾‹å­éƒ½æ¥è‡ªäºRefundè¡¨ï¼ˆè¿™å¼ è¡¨ä¸ç¬¬ä¸€ç¯‡åšæ–‡ä¸­ä½¿ç”¨çš„è¡¨ç›¸åŒï¼Œåœ°å€ï¼šmysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆä¸€ï¼‰â€”â€”ä»æ…¢æŸ¥è¯¢å®ä¾‹ä¸­å¼€å§‹åˆ†æï¼‰ explainå¾—åˆ°çš„ç»“æœåˆ†æ: è¯·çœ‹ä¸‹å›¾çš„ä¾‹å­ï¼š é¦–å…ˆæˆ‘ä»¬æ¥è§£é‡Šä¸‹explainç»“æœçš„å„ä¸ªåˆ—çš„å«ä¹‰ï¼š id:è¡¨ç¤ºselectå­å¥æ‰§è¡Œçš„idï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œidçš„åºå·å°±ä¼šé€’å¢äº†ï¼Œå¹¶ä¸”idå€¼è¶Šå¤§çš„å­å¥è¶Šå…ˆè¢«æ‰§è¡Œ select_type:è¡¨ç¤ºselectè¯­å¥çš„ç±»å‹ï¼Œæ¯”å¦‚ï¼šSIMPLEï¼ˆç®€å•æŸ¥è¯¢ï¼Œä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€…UNIONï¼‰ï¼›PRIMARY æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸ºPRIMARYï¼Œå…·ä½“ä¸å±•å¼€äº†ï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ table:å½“å‰æ‰§è¡Œçš„è¡¨å typeï¼šå½“å‰è¡¨å†…è®¿é—®æ–¹å¼ï¼Œè®¿é—®æ–¹å¼ä»å¥½åˆ°åæ’åºä¸ºï¼š system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; allsystemæŒ‡è¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼›constè¡¨ç¤ºæŸ¥è¯¢äº†ä¸€æ¬¡å°±æ‰¾åˆ°ç»“æœï¼›eq_refè¡¨ç¤ºå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ï¼›refè¡¨ç¤ºéå”¯ä¸€ç´¢å¼•æ‰«æï¼›range è¡¨ç¤ºåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œï¼›indexè¡¨ç¤ºæŸ¥è¯¢æ‰«æäº†ç´¢å¼•æ ‘ï¼›allè¡¨ç¤ºå…¨è¡¨æ‰«æ possible_keys:å¯èƒ½ä½¿ç”¨åˆ°çš„ç´¢å¼• key:ç»è¿‡ä¼˜åŒ–å™¨è¯„ä¼°æœ€ç»ˆä½¿ç”¨çš„ç´¢å¼• key_length:ä½¿ç”¨åˆ°çš„ç´¢å¼•é•¿åº¦ ref:å¼•ç”¨åˆ°çš„ä¸Šä¸€ä¸ªè¡¨çš„åˆ—rows:è¦å¾—åˆ°æœ€ç»ˆè®°å½•ç´¢è¦æ‰«æç»è¿‡çš„è®°å½•æ•°ï¼Œrowså€¼è¶Šå°è¯´æ˜æŸ¥è¯¢è¶Šé«˜æ•ˆ Extra:é¢å¤–çš„ä¿¡æ¯è¯´æ˜ï¼Œä¸»è¦çš„ç±»å‹æœ‰ï¼šUsing filesortï¼šæ–‡ä»¶æ’åºï¼Œè¯´æ˜mysqlæ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºUsing temporaryï¼šä¸´æ—¶è¡¨ï¼Œ ä½¿ç”¨äº†ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQLåœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œè¿™ä¸ªæ—¶å€™æ•ˆç‡æ˜¯æå…¶ä½ä¸‹çš„Using indexï¼šè¡¨ç¤ºç›¸åº”çš„selectæ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰ï¼Œé¿å…è®¿é—®äº†å›è¡¨è®¿é—®æ•°æ®Using whereï¼šä½¿ç”¨äº†whereè¿‡æ»¤Using join bufferï¼šä½¿ç”¨äº†è¿æ¥ç¼“å­˜impossible whereï¼šwhereå­å¥çš„å€¼æ€»æ˜¯falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•å…ƒç»„Using index conditionï¼šUsing index condition ä¼šå…ˆæ¡ä»¶è¿‡æ»¤ç´¢å¼•ï¼Œè¿‡æ»¤å®Œç´¢å¼•åæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆç´¢å¼•æ¡ä»¶çš„æ•°æ®è¡Œï¼Œéšåç”¨ WHERE å­å¥ä¸­çš„å…¶ä»–æ¡ä»¶å»è¿‡æ»¤è¿™äº›æ•°æ®è¡Œ â…¢. å®ä¾‹åˆ†æè¯·çœ‹å¦‚ä¸‹çš„sqlï¼š1explain select* from Refund where sellerUserId=93106308 å› ä¸ºç´¢å¼•æ— æ³•è¦†ç›–æŸ¥è¯¢æ‰€éœ€è¦çš„å…¨éƒ¨åˆ—ï¼Œå› æ­¤Extraä¸­æ˜¾ç¤ºâ€œUsing index conditionâ€ï¼š å†çœ‹è¿™ä¸ªSQLï¼š1explain select status from Refund where status=700 order by created è¿™é‡Œè¿›è¡Œäº†æ–‡ä»¶æ’åºï¼š è¦†ç›–ç´¢å¼•æŸ¥è¯¢ï¼š1explain select sellerUserId, status, created from Refund Refundè¡¨ä¸­æœ‰ä¸€ä¸ªå¤šåˆ—ç´¢å¼•ï¼šKEY idx_sellerUserId_created_status (sellerUserId,created,status)ï¼Œå¦‚æœåªè®¿é—®sellerUserId, status, createdè¿™ä¸‰åˆ—ï¼ŒæŸ¥è¯¢å°†ä½¿ç”¨â€œè¦†ç›–ç´¢å¼•â€ï¼šå…·ä½“æ‰§è¡Œç»“æœå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨typeåˆ—ä¸­æ˜¾ç¤ºäº†â€œindexâ€ï¼Œè¿™è¡¨ç¤ºæ­¤æ¬¡æŸ¥è¯¢å°†é€šè¿‡ç´¢å¼•æ¥è®¿é—®æ•°æ®ï¼›Extraä¸­çš„â€œUsing indexâ€è¡¨ç¤ºæ­¤æ¬¡æŸ¥è¯¢å°†ä½¿ç”¨â€œç´¢å¼•è¦†ç›–â€æŸ¥è¯¢ã€‚ æœ€åä¸€ä¸ªsqlä¾‹å­ï¼š1explain select status from Refund where sellerUserId=93106308 order by created è¿™å¥sqlä¸­çš„Extraä¸ä»…å‡ºç°äº†â€œUsing indexâ€è¿˜å‡ºç°äº†â€œUsing whereâ€ï¼Œè¿™è¡¨ç¤ºç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç°â€œUsing whereâ€ï¼Œè¡¨æ˜ç´¢å¼•ç”¨æ¥è¯»å–æ•°æ®è€Œéæ‰§è¡ŒæŸ¥æ‰¾åŠ¨ä½œã€‚ â…£. Reference[1]. EXPLAINç”¨æ³•å’Œç»“æœåˆ†æï¼šhttps://blog.csdn.net/why15732625998/article/details/80388236[2]. Schwartz B, Zaitsev P, Tkachenko V. High Performance MySQL: Optimization, Backups, and Replication[M]. Oâ€™Reilly Media, Inc. 2012.]]></content>
      <tags>
        <tag>sql</tag>
        <tag>æ•°æ®åº“</tag>
        <tag>ç´¢å¼•</tag>
        <tag>ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­£å¼å‘Šåˆ«CSDN]]></title>
    <url>%2F2018%2F08%2F08%2F20180808-sayByeToCSDN%2F</url>
    <content type="text"><![CDATA[ç»ˆäºæœ‰äº†è‡ªå·±çš„åšå®¢CSDNæ‹œæ‹œğŸ‘‹ï½æ— æ•°æ¬¡è¢«csdnè ¢å“­ï¼ä¸€æ˜¯æ„šè ¢çš„äººå·¥å®¡æ ¸æ–¹å¼ï¼›äºŒæ˜¯æ‰æ€¥çš„appåå°ï¼Œè€å¥”æºƒã€‚è€å®è¯´ï¼Œä¹‹å‰12306æ˜¯æˆ‘è§è¿‡çš„æœ€å‚»æœ€è ¢çš„appï¼å¥½äº†ï¼Œcsdnåˆ·æ–°æˆ‘è®°å½•äº†ã€‚ç°åœ¨æˆ‘æŠŠè¿™ä¸ªtitleé¢ç»™æ‚¨ï¼è¯·æ‚¨åŠ¡å¿…æ¥å—ï¼BTWï¼Œç°åœ¨ç»ˆäºä¹Ÿæ­å»ºäº†è‡ªå·±çš„åšå®¢ï½ blog4olive.topåŸŸåä¸ç®—å¥½å¬ï¼ˆç©·å›°çš„æˆ‘è¿™è¾ˆå­éƒ½ä¹°ä¸èµ·å¥½å¬çš„åŸŸåï¼å¯ä»¥è€ƒè™‘ç»™æˆ‘ä¼—ç­¹ã€‚åˆšå¥½æ·»åŠ äº†æ‰“èµåŠŸèƒ½ï¼Œæ–‡ç« æœ«å°¾å³å¯çœ‹åˆ°ï¼ï¼‰ï¼Œä½†èƒœåœ¨ç®€å•æ˜äº†å¯¹å§ï¼Ÿ å…³äºåšå®¢æ›´æ–° å¢åŠ äº†æ–‡ç« pv åšå®¢pvçš„æ˜¾ç¤º é¡µè„šiconç­‰çš„ä¼˜åŒ– æ–‡ç« ç»“æ„æ˜¾ç¤º æ–‡ç« æœç´¢åŠŸèƒ½ æ‰“èµ TODO: è¯„è®ºåŠŸèƒ½ åˆ†äº« ä»£ç é«˜äº®ç­‰æ ¼å¼ä¼˜åŒ– æ›´ç¾è§‚æ›´ä¼˜é›… ä¹‹åcsdnçš„åšå®¢éƒ½è¦è¿ç§»è¿‡æ¥ï¼Œå·¥ç¨‹é‡å·¨å¤§ï¼Œæƒ³æ‰“äºº é‚£ä¹ˆç»§ç»­åŠ æ²¹å§! é€ä¸Šä¸€å¼ ç¾ç…§ï¼Œæ”¹å¤©ï¼ˆæœˆï¼Ÿå¹´ï¼Ÿï¼‰ç»§ç»­å‡ºå»æ—…è¡Œ]]></content>
      <tags>
        <tag>éšä¾¿å†™å†™</tag>
        <tag>åæ§½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆä¸€ï¼‰â€”â€”ä»æ…¢æŸ¥è¯¢å®ä¾‹ä¸­å¼€å§‹åˆ†æ]]></title>
    <url>%2F2018%2F08%2F04%2F20180804-sqlIndexAndQueryOptimize-1%2F</url>
    <content type="text"><![CDATA[å®˜æ–¹åæ§½ä¸ºä»€ä¹ˆå†™è¿™ä¸ªå†™è¿™ä¸ªåšå®¢ä¹Ÿç®—æ˜¯é˜´å·®é˜³é”™ã€‚ä¸Šæ¬¡åšäº†ä¸ªéœ€æ±‚ï¼šé€€æ¬¾åˆ—è¡¨å¯¼å‡ºï¼ˆå¯ä»¥ç¿»ç¿»ä¹‹å‰çš„åšå®¢ï¼Œæœ‰å†™ï¼‰ã€‚è™½ç„¶äº‹æƒ…è¿‡äº†é‚£ä¹ˆä¹…ï¼Œç°åœ¨æˆ‘è¿˜æ˜¯æƒ³è¦åæ§½ä¸‹ï¼Œè¿™ä¸ªéœ€æ±‚æ˜¯çœŸçš„æœ‰å¾ˆå¤šå‘ï¼Œä½†è¯è¯´å›æ¥ï¼Œåšéš¾äº‹æ‰ä¼šæœ‰æ‰€å¾—ï¼Œè¸©çš„å‘è¶Šå¤šï¼Œé‚£æˆé•¿å°±è¶Šå¤šï¼ˆè¯·è„‘è¡¥è™ä¸»æ–‡ï¼‰ã€‚ å…³äºè¿™ä¸ªç³»åˆ—çš„åšå®¢è¿™ä¸ªåšå®¢å¤§æ¦‚æ˜¯è¿™ä¹ˆåˆ†å¸ƒçš„ï¼šç¬¬ä¸€ç¯‡å°±æ ¹æ®å®é™…åœºæ™¯æ¥åˆ†æä¸‹ç´¢å¼•åŠæŸ¥è¯¢ä¸Šçš„ä¼˜åŒ–ï¼›ç¬¬äºŒç¯‡å’Œç¬¬ä¸‰ç¯‡ï¼ˆå¦‚æœæˆ‘è¿˜èƒ½å†™å¾—å‡ºæ¥ç¬¬ä¸‰ç¯‡çš„è¯ğŸ˜…ï¼‰æ¥ç³»ç»Ÿåœ°æ•´ç†ä¸‹mysqlçš„ç´¢å¼•åŠæŸ¥è¯¢çš„ä¼˜åŒ–ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ä»¥ä¸‹ä¸ºæ­£æ–‡ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæœ‰ä¸€æ¬¡ä¸€ä¸ªå®¢æœåŒå­¦æ€¥æ€¥å¿™å¿™æ¥æ‰¾æˆ‘ï¼Œè¯´å¯¼å‡ºå‡ æ¡è®°å½•éƒ½å¤±è´¥äº†ï¼ŒæŸ¥çœ‹äº†é”™è¯¯æ—¥å¿—æ˜¾ç¤ºé”™è¯¯å¦‚ä¸‹ï¼š å¥½äº†ï¼Œä¸è¦ç›¯ç€äººå®¶çš„çº¢è‰²æ¡†æ¡†çœ‹äº†ï¼Œé‡ç‚¹ä¸æ˜¯é‚£é‡Œã€‚ é‡ç‚¹æ˜¯å‡ºç°äº†æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæˆ‘çŸ¥é“çœ‹å›¾è‚¯å®šçœ‹ä¸å‡ºæ¥è¿™æ¡sqlæ˜¯å•¥ï¼Œäºæ˜¯æˆ‘è´´å¿ƒçš„è´´äº†å‡ºæ¥ï¼š 1234567select* ï¼ˆè¿™é‡Œå…¶å®ä¸æ˜¯è¿™ä¹ˆæš´åŠ›åœ°æ‹¿å…¨åˆ—æ•°æ®ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå°±*è¡¨ç¤ºäº†ï¼‰from RefundFORCE INDEX (idx_sellerUserId_created_status)WHERE sellerUserId = 40955202 AND status IN (800, 900) AND created &gt;= 946656000 AND created &lt; 2051193600 ORDER BY created desc LIMIT 0, 50 é¦–å…ˆæ¥åˆ†æä¸‹è¿™æ¡sqlè¦åšå•¥ï¼Œå…¶å®å°±æ˜¯åœ¨Refundï¼ˆé€€æ¬¾è¡¨ï¼‰è¿™ä¸ªè¡¨ä¸­æŸ¥è¯¢æ‰€æœ‰sellerUserIdä¸º40955202ï¼Œå¹¶ä¸”çŠ¶æ€åœ¨800åŠ900ï¼ˆ800ï¼Œ900ç­‰è¡¨ç¤ºé€€æ¬¾å¤„äºçš„çŠ¶æ€ï¼Œå¦‚é€€æ¬¾ç”³è¯·ï¼Œé€€æ¬¾å®Œæˆç­‰ï¼‰ä¹‹é—´çš„ï¼Œå¹¶ä¸”åˆ›å»ºæ—¶é—´å¤§äºç­‰äº946656000ä¸”å°äº2051193600ï¼ˆè¿™æ˜¯ä¸¤ä¸ªæ—¶é—´æˆ³ï¼‰çš„æ‰€æœ‰è®°å½•ï¼Œå¹¶ä¸”å°†æ‰€æœ‰è¿™äº›è®°å½•æ ¹æ®createdï¼ˆåˆ›å»ºæ—¶é—´ï¼‰è¿›è¡Œé€†åºæ’åºåå–å¼€å¤´50æ¡ã€‚æ³¨æ„åˆ°è¿™ä¸ªsqlæœ‰ä¸€ä¸ª FORCE INDEX (idx_sellerUserId_created_status)ï¼Œè¿™ä¸ªæ„æ€æ˜¯è®©sqlå¼ºåˆ¶èµ°idx_sellerUserId_created_statusè¿™ä¸ªç´¢å¼•ï¼Œè‡³äºä¸ºä»€ä¹ˆæœ‰æ—¶å€™éœ€è¦å¼ºè¡Œèµ°ç´¢å¼•ï¼Œè¿™ä¸ªæ¶‰åŠåˆ°mysqlçš„æŸ¥è¯¢ä¼˜åŒ–ï¼Œä¹‹åä¼šè®²åˆ° çœ‹äº†ä¸Šé¢è¿™æ¡sqlï¼Œæœ‰æ²¡æœ‰å‘ç°ä»€ä¹ˆé—®é¢˜ï¼Ÿå¯èƒ½æˆ‘ä»¬ä¼šè§‰å¾—æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å¾ˆæ¸…æ™°åœ°è¯´å‡ºæ¥ã€‚é‚£ä¹ˆï¼Œé¦–å…ˆæ¥çœ‹ä¸‹mysqlçš„æ‰§è¡Œè®¡åˆ’å§ï¼ çœ‹å‡ºé—®é¢˜æ¥äº†ä¹ˆï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ¡sqlè‡³å°‘å­˜åœ¨3æ¡é—®é¢˜ï¼ä»¥ä¸‹ä¸€æ¡ä¸€æ¡æ¥åˆ†æï¼š ceratedçš„æ—¶é—´æŸ¥è¯¢èŒƒå›´è¿‡å¤§ï¼Œ946656000è½¬åŒ–ä¸ºåŒ—äº¬æ—¶é—´æ˜¯2000/1/1 0:0:0ï¼Œ2051193600è½¬åŒ–ä¸ºåŒ—äº¬æ—¶é—´æ˜¯2035/1/1 0:0:0ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶é—´æ®µæ®µå«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨æˆ‘åº”ç”¨çš„å…·ä½“æ‰§è¡Œä¸­ï¼Œå½“ç”¨æˆ·åœ¨å¯¼å‡ºé€€æ¬¾åˆ—è¡¨æ—¶æ²¡æœ‰é€‰æ‹©å¯¼å‡ºçš„æ—¶é—´æ®µæ—¶ï¼Œå°±ä¼šç»™å®šä¸€ä¸ªé»˜è®¤çš„æœç´¢æ—¶é—´æ®µï¼Œè€Œæ°å·§æˆ‘è®¾ç½®äº†æ¯”è¾ƒå¤§çš„èµ·æ­¢æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´æ®µæœ¬æ¥æ˜¯ä¸éœ€è¦è¿™ä¹ˆå¤§çš„ï¼Œè¿™ä¸ªæ—¶é—´æ®µåŸºæœ¬å°†è¿™ä¸ªç”¨æˆ·æ‰€æœ‰çš„é€€æ¬¾è®°å½•éƒ½åŒ…å«äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªç”¨æˆ·ç©¶ç«Ÿæœ‰å¤šå°‘æ¡é€€æ¬¾è®°å½•ï¼šå¥½å®¶ä¼™ï¼Œ1000å¤šwæ¡è®°å½•ã€‚ã€‚é‚£ä¹ˆæœ‰äººä¼šè¯´ï¼Œæ—¶é—´æ®µå¤§ä¹Ÿæ²¡å…³ç³»ï¼Œä¸æ˜¯è¿˜æœ‰å…¶ä»–ç´¢å¼•é¡¹å¯ä»¥è¿›è¡Œçº¦æŸå—ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒä¸ªé—®é¢˜ ç´¢å¼•çœŸçš„ç”¨ä¸Šäº†ä¹ˆï¼Ÿä¸ºäº†é˜²æ­¢mysqlä¼˜åŒ–å™¨å‡ºç°çŸ³å¿—è¡Œä¸ºï¼Œè¿™æ¡sqlç‰¹æ„å‘Šè¯‰mysqlï¼šæ‚¨å•¥ä¹Ÿä¸ç”¨æƒ³ï¼å°±ç”¨è¿™ä¸ªç´¢å¼•ï¼é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªç´¢å¼•ï¼šidx_sellerUserId_created_statusã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šåˆ—ç´¢å¼•ï¼Œæ˜¯ä¸€ä¸ªç”±sellerUserIdã€createdã€statusä¸‰åˆ—ç»„æˆçš„ä¸€ä¸ªè”åˆç´¢å¼•ã€‚å†æ¥çœ‹ä¸‹è¿™æ¡sqlçš„whereæ¡ä»¶ï¼šWHERE sellerUserId = 40955202 and status IN(800, 900) and created &gt;= 946656000 AND created &lt; 2051193600 order by createdã€‚ä¹ä¸€çœ‹ï¼Œå¥½åƒç´¢å¼•æ²¡ç”¨ä¸Šå•Šï¼Ÿç´¢å¼•çš„æ’åºæ˜¯sellerUserIdã€createdã€statusï¼Œè€Œwhereæ¡ä»¶çš„é¡ºåºæ˜¯sellerUserIdã€statusã€createdã€‚é‚£ç´¢å¼•æ˜¯ä¸æ˜¯æ²¡ç”¨äº†ï¼Ÿå½“ç„¶ä¸æ˜¯çš„ï¼mysqlå¦‚æœè¿è¿™ç‚¹ä¼˜åŒ–éƒ½æ²¡æœ‰è€ƒè™‘ï¼Œé‚£å’Œå’¸é±¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿï¼Ÿåœ¨è¿™é‡Œï¼Œmysqlä¼šå°†whereæ¡ä»¶åšä¸€ä¸ªä¼˜åŒ–ï¼Œwhereæ¡ä»¶å†…çš„é¡ºåºæ˜¯ä¸å½±å“æ­¤ç´¢å¼•çš„ä½¿ç”¨çš„ã€‚é‚£ä¹ˆè¿™ä¸ªç´¢å¼•çœŸçš„ç”Ÿæ•ˆäº†ä¹ˆï¼Ÿäº‹å®æ˜¯å¹¶æ²¡æœ‰ã€‚æˆ‘ä»¬æ¥åˆ†æä¸‹è¿™ä¸ªç´¢å¼•ï¼Œæ³¨æ„çœ‹è¿™ä¸ªæ¡ä»¶ï¼šcreated &gt;= 946656000 AND created &lt; 2051193600ï¼Œå¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ï¼Œè€Œåœ¨å¤šåˆ—ç´¢å¼•çš„ä½¿ç”¨ä¸­ï¼Œå¦‚æœç¢°åˆ°äº†èŒƒå›´æ¡ä»¶ï¼Œé‚£ä¹ˆå­˜å‚¨å¼•æ“æ˜¯ä¸ä¼šä½¿ç”¨èŒƒå›´æ¡ä»¶å³è¾¹çš„åˆ—çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå’±ä»¬è¿™æ¡sqlï¼Œç´¢å¼•åˆ°äº†idx_sellerUserId_createdå°±åˆ°å¤´äº†ï¼Œä¸ä¼šå†ä½¿ç”¨statusåšç´¢å¼•ã€‚å¼ºåˆ¶èµ°çš„è¿™ä¸ªç´¢å¼•ï¼Œå¤±æ•ˆäº†ï¼å› æ­¤è¿™æ¡æŸ¥è¯¢åªç”¨åˆ°éƒ¨åˆ†çš„ç´¢å¼• æŸ¥è¯¢çœŸçš„æœ‰å¿…è¦é‚£ä¹ˆå†™ä¹ˆï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°whereæ¡ä»¶ä¸­é™åˆ¶äº†createdå­—æ®µçš„æŸ¥è¯¢èŒƒå›´ï¼Œè€Œåœ¨æ’åºæ—¶åˆéœ€è¦æ ¹æ®createdå­—æ®µè¿›è¡Œé€†åºæ’åºï¼Œä¹‹ååˆåªå–äº†æœ€ç»ˆç»“æœçš„å¼€å¤´50è¡Œã€‚å°½ç®¡æˆ‘ä»¬å¾ˆç†æƒ³åŒ–åœ°è®¾æƒ³mysqlåªä¼šè¿”å›æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œæ¯”å¦‚åœ¨è¿™æ¡sqlä¸­æˆ‘ä»¬çœŸçš„å¾ˆå¸Œæœ›mysqlå¯ä»¥åªæ‰«æ50è¡Œå°±æœç´¢æˆ‘ä»¬éœ€è¦çš„é‚£50æ¡æ•°æ®ã€‚ç„¶è€Œï¼Œåœ¨çœŸæ­£çš„æŸ¥è¯¢ä¸­æˆ‘ä»¬æƒŠäººåœ°å‘ç°mysqlè¯»å–äº†è¶…è¿‡åƒä¸‡æ¡çš„æ•°æ®ï¼ä¸€éƒ¨åˆ†çš„åŸå› åœ¨äºæŸ¥è¯¢è¿‡ç¨‹ä¸­ä½¿ç”¨äº†ä¸å¤ªåˆé€‚çš„ç´¢å¼•ï¼Œå¦ä¸€æ–¹é¢åœ¨äºæˆ‘ä»¬çš„æŸ¥è¯¢å¤ªç´¯èµ˜äº†ï¼Œè¦æƒ³æˆ‘ä»¬çš„æŸ¥è¯¢ä¸é‚£ä¹ˆç´¯èµ˜ï¼Œé¦–å…ˆè¦ææ¸…æ¥šæˆ‘ä»¬è¦æŸ¥è¯¢ä»€ä¹ˆã€‚å¦‚ä¸Šå°±åˆ†æè¿‡ï¼Œæˆ‘ä»¬éœ€è¦çš„åªæ˜¯è¯¥ç”¨æˆ·åˆ›å»ºçš„ã€å¤„äºæŸäº›çŠ¶æ€çš„ã€æœ€æ–°çš„50æ¡è®°å½•ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹createdå­—æ®µçš„èŒƒå›´è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ é‚£ä¹ˆé’ˆå¯¹ä¸Šé¢å‡ ä¸ªé—®é¢˜ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æƒ³åŠæ³•æ¥ä¼˜åŒ–ä¸‹è¿™æ¡æŸ¥è¯¢å§ï¼ä»¥ä¸Šçš„æˆªå›¾å’Œé—®é¢˜éƒ½æ¥æºäºçº¿ä¸Šï¼Œå› ä¸ºæ¥ä¸‹æ¥çš„æ“ä½œå¯èƒ½ä¼šæ¶‰åŠåˆ°è¡¨ç»“æ„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ä½¿ç”¨ä¸€ä¸ªçº¿ä¸‹çš„dbæ¥è¿›è¡Œæ¨¡æ‹Ÿ é¦–å…ˆçœ‹ä¸‹è¡¨çš„ç»“æ„ ç„¶åæˆ‘ä»¬æ¥æŸ¥è¯¢ä¸‹é€€æ¬¾æ•°é‡æœ€å¤šçš„ç”¨æˆ· æˆ‘ä»¬å‘ç°idä¸º93106308çš„ç”¨æˆ·é€€æ¬¾æ•°é‡æœ€å¤šï¼Œå¤§æ¦‚æœ‰5wå¤šè¡Œï¼Œé‚£ä¹ˆå°±ç”¨ä»–æ¥åšæ¨¡æ‹Ÿå§ï¼ é¦–å…ˆæ¥æ¨¡æ‹Ÿä¸‹æœ€åˆçš„sqlè¯­å¥ 12345678explain select* FROM Refund FORCE INDEX (idx_sellerUserId_created_status) WHERE sellerUserId=93106308 and status IN (700, 900, 1000) AND created &gt;= 1278691200 AND created &lt; 1531152000 ORDER BY created desc LIMIT 0, 10 å¦‚ä¸Šå›¾æ‰€ç¤ºçš„æ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œmysqlç¡®å®ä½¿ç”¨äº†idx_sellerUserId_created_statusè¿™ä¸ªç´¢å¼•ï¼ˆè¿™å…¶å®æ˜¯åºŸè¯ï¼Œä½ éƒ½å¼ºåˆ¶äººå®¶èµ°äº†ï¼Œï¼Œï¼‰ï¼Œç„¶åçœ‹rowsè¿™ä¸€è¡Œï¼š64867ï¼å­˜å‚¨å¼•æ“æ‰«ææ¥6wå¤šè¡Œæ‰å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼å¯ä»¥çœ‹åˆ°åœ¨Extraè¿™ä¸€åˆ—ä¸­æ˜¾ç¤ºçš„æ˜¯ï¼šUsing index conditionï¼Œè¿™è¡¨ç¤ºæŸ¥è¯¢éƒ¨åˆ†ä½¿ç”¨äº†ç´¢å¼•ï¼Œå¯¹äºä¸åœ¨ç´¢å¼•ä¸­çš„åˆ—éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®ï¼Œè¿™ä¹Ÿå¦‚æˆ‘ä»¬é¢„æƒ³çš„é‚£æ · é‚£ä¹ˆæˆ‘ä»¬æ¥è¯•è¯•å­˜å‚¨å¼•æ“çš„è‡ªåŠ¨ä¼˜åŒ–å§ï¼š å“ˆå“ˆï¼Œå­˜å‚¨å¼•æ“çš„æŸ¥è¯¢ä¼˜åŒ–å…¶å®å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆå¥½ï¼ˆä½†ä¹Ÿæ²¡é‚£ä¹ˆå·®ï¼‰ï¼Œå»é™¤äº†å¼ºåˆ¶ç´¢å¼•åå­˜å‚¨å¼•æ“è‡ªå·±æ‰¾åˆ°äº†ä¸€ä¸ªå®ƒè®¤ä¸ºçš„æœ€ä¼˜çš„ç´¢å¼•ï¼šidx_createdï¼Œå¯ä»¥çœ‹åˆ°Extraè¿™ä¸€åˆ—ä¸­æ˜¾ç¤ºçš„æ˜¯ï¼šUsing whereï¼Œè¿™è¡¨ç¤ºæŸ¥è¯¢éœ€è¦å›è¡¨ææ•°æ®ä»¥åå†ä½¿ç”¨whereæ¡ä»¶æ¥è¿›è¡Œè¿‡æ»¤ã€‚é‚£ä¹ˆå’Œä¸Šé¢çš„æƒ…å†µåšå¯¹æ¯”ï¼Œåœ¨æ€§èƒ½ä¸Šå…¶å®æ˜¯æ¯«æ— å·®åˆ«ã€‚ é‚£æˆ‘ä»¬åœ¨ç´¢å¼•ä¸Šæ¥ä¼˜åŒ–ä¸‹å§ï¼Œä¸ºäº†é¿å…é‡åˆ°èŒƒå›´æŸ¥è¯¢è€Œä½¿å³è¾¹ç´¢å¼•åˆ—å¤±æ•ˆï¼Œæˆ‘ä»¬æ¥å°†idx_sellerUserId_created_statusç´¢å¼•ä¿®æ”¹ä¸ºidx_sellerUserId_status_createdï¼Œå¹¶ä¸”è®©å­˜å‚¨å¼•æ“å¼ºåˆ¶èµ°è¿™ä¸ªç´¢å¼•ï¼š å‘ç°å˜åŒ–äº†ä¹ˆï¼ŸæŸ¥è¯¢æ‰«æçš„è¡Œæ•°å°‘äº†å¾ˆå¤šï¼ é‚£æ¥ä¸‹æ¥å†ä¼˜åŒ–ä¸‹æŸ¥è¯¢è¯­å¥ï¼š å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºä¼˜åŒ–äº†æŸ¥è¯¢è¯­å¥ï¼Œæ ¹æ®createdè¿›è¡Œé€†åºæ’åºï¼Œå¯¼è‡´æœ€åæ‰«æçš„è¡Œæ•°å¤§ä¸ºå‡å°‘ï¼ åœ¨è¿™é‡Œï¼Œè¿™æ¡æŸ¥è¯¢çš„ä¼˜åŒ–å¹¶ä¸æ˜¯åœ¨ä»»ä½•åœºæ™¯ä¸‹éƒ½æ˜¯èƒ½ä¿è¯æœ‰å¾ˆé«˜çš„æŸ¥è¯¢æ€§èƒ½çš„ã€‚æˆ‘ä»¬çŸ¥é“ç´¢å¼•åœ¨dbä¸­ç»´æŠ¤äº†ä¸€ä¸ªb+tree ç»“æ„ï¼ˆinnodbå¼•æ“é»˜è®¤ç»“æ„ï¼‰ã€‚idx_createdç´¢å¼•å°†æ‰€æœ‰çš„æ•°æ®æ ¹æ®createdæ¥å»ºç«‹äº†ä¸€ä¸ªb+treeï¼Œå½“æˆ‘ä»¬è¦æŸ¥è¯¢çš„ç”¨æˆ·æ•°æ®æ°å¥½åœ¨b+treeçš„åæ–¹çš„æ—¶å€™ï¼ŒæŸ¥è¯¢ä¹Ÿæ˜¯éœ€è¦æ‰«æä¸å°‘è¡Œçš„ï¼š æ‰€ä»¥ä¸åŒçš„æ•°æ®åº“çš„æ•°æ®ç»“æ„éœ€è¦å…·ä½“çš„åˆ†æï¼Œå¦‚æœæ²¡æœ‰å¯¹è¡¨ç»“æ„ä»¥åŠæ•°æ®ç»“æ„æœ‰è¾ƒæ¸…æ™°çš„è®¤è¯†ï¼Œæˆ‘è®¤ä¸ºè¿™ç§æŸ¥è¯¢ä¼˜åŒ–æ˜¯ä¸å¤ªè¡Œçš„ï¼Œæœ‰æ—¶å€™ç”šè‡³ä¼šèµ·åˆ°åé¢æ•ˆæœã€‚ æ‰€ä»¥ç»¼åˆè€ƒè™‘ï¼Œæˆ‘è¿˜æ˜¯å»ºè®®ä¿®æ”¹ä¸‹ç´¢å¼•ç»“æ„å³å¯ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸æ˜¯ç›´æ¥å¢åŠ ä¸€ä¸ªç´¢å¼•ï¼Œè¿™æ˜¯ä¸ºäº†å‡å°å­˜å‚¨å¼•æ“çš„å‹åŠ›ï¼Œè¿‡å¤šçš„å†—ä½™ç´¢å¼•ä¹Ÿç»™ç»´æŠ¤å¸¦æ¥è´Ÿæ‹… æ¥ä¸‹æ¥çš„åšå®¢ä¼šç³»ç»Ÿåœ°è®²è¿°ä¸‹mysqlçš„ç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ– å¯¹ä¸Šè¿°é—®é¢˜æœ‰é—®é¢˜æˆ–è€…æƒ³ä¸€èµ·è®¨è®ºçš„æœ‹å‹å¯ä»¥éšæ—¶è”ç³»ï½]]></content>
      <tags>
        <tag>sql</tag>
        <tag>æ•°æ®åº“</tag>
        <tag>ç´¢å¼•</tag>
        <tag>ä¼˜åŒ–</tag>
      </tags>
  </entry>
</search>
