<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆäºŒï¼‰â€”â€”è§‚å¯Ÿè€…æ¨¡å¼]]></title>
    <url>%2F2018%2F12%2F01%2FobserverDesignPattern%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯å°¼å¤æ‹‰æ–¯Â·èµµå››çš„åŒå­¦æœ¬å°¼è¿ªÂ·æäº‘åœ¨äº’è”ç½‘æ°”è±¡ç«™å…¬å¸å·¥ä½œï¼Œæœ€è¿‘ä»–ä»¬å…¬å¸è¦åšä¸€ä¸ªæ°”è±¡ç›‘æµ‹çš„åº”ç”¨ã€‚è¿™ä¸ªåº”ç”¨éœ€è¦èƒ½ç›‘æ§ç°åœ¨çš„å¤©æ°”çŠ¶å†µï¼ŒæŒ‡æ ‡ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ï¼šæ¸©åº¦ï¼Œæ¹¿åº¦ä»¥åŠæ°”å‹ã€‚å¹¶ä¸”åº”ç”¨æœ‰ä¸‰å—é¢æ¿å¯ä»¥åˆ†åˆ«æ˜¾ç¤ºç›®å‰çš„å¤©æ°”çŠ¶å†µã€æ°”è±¡æ•°æ®ç»Ÿè®¡ä»¥åŠå¤©æ°”é¢„æŠ¥ã€‚å½“å¤©æ°”æƒ…å†µå˜åŒ–æ—¶ï¼Œä¸‰å—é¢æ¿å¿…é¡»æ ¹æ®å„è‡ªçš„æŒ‡æ ‡å®æ—¶æ›´æ–°ã€‚èµµå››æ‹¿åˆ°è¿™ä¸ªéœ€æ±‚ï¼Œå¹¶æ‹¿åˆ°äº†ä¸€ä¸ªWeatherDataå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯æ°”è±¡ç«™æä¾›çš„ï¼Œå¯ä»¥ç”¨æ¥è·å–åˆ°æ¸©åº¦ï¼Œæ¹¿åº¦ä»¥åŠæ°”å‹ä¸‰ä¸ªæŒ‡æ ‡ï¼ˆæ¢è€Œè¨€ä¹‹ï¼Œä»–æ ¹ä¸éœ€è¦å…³æ³¨è¿™ä¸‰ä¸ªæŒ‡æ ‡æ˜¯å¦‚ä½•è·å–åˆ°çš„ï¼Œåªéœ€è¦é€šè¿‡WeatherDataå¯¹è±¡çš„getteræ–¹æ³•å³å¯æ‹¿åˆ°å¯¹åº”æŒ‡æ ‡çš„å€¼ï¼‰ã€‚å¦å¤–ï¼Œä»–ä¹Ÿå¹¶ä¸éœ€è¦å…³æ³¨æ°”è±¡æ•°æ®çš„ç»Ÿè®¡ç®—æ³•ä»¥åŠå¤©æ°”é¢„æŠ¥çš„ç®—æ³•ï¼Œè¿™äº›ç®—æ³•éƒ½æœ‰ç°æˆçš„æ¥å£å¯ä»¥è°ƒç”¨ã€‚å› æ­¤ï¼Œä»–æ‹¿åˆ°æŒ‡æ ‡ä»¥åï¼Œä»–åªéœ€è¦å°†å¯¹åº”çš„å€¼æ”¾åˆ°å¯¹åº”çš„é¢æ¿ä¸Šè¿›è¡Œæ˜¾ç¤ºå°±å¥½äº†ã€‚é‚£ä¹ˆä¸­é—´æœ€é‡è¦çš„ä¸€æ­¥â€”â€”é¢æ¿å¦‚ä½•æ„ŸçŸ¥åˆ°ä¸‰ä¸ªæŒ‡æ ‡çš„å˜åŒ–å¹¶åŠæ—¶ä½œå‡ºå›åº”ï¼Ÿ æ–¹æ¡ˆè®¾è®¡ æœ€ç®€å•çš„å½“ç„¶æ˜¯å…šå¤©æ°”æ•°æ®å˜åŒ–æ—¶ï¼Œåœ¨WeatherDataä¸­åˆ†åˆ«è°ƒç”¨ä¸‰ä¸ªé¢æ¿çš„æ¥å£æ–¹æ³•è¿›è¡Œæ”¹å˜äº†ã€‚ç„¶è€Œè¿™ç§ç®€å•çš„åšæ³•ä¹Ÿå¸¦æ¥äº†ä¸€äº›ä¸å¤ªå¥½çš„å½±å“â€”â€”æ¯”å¦‚è¯´ç ´åäº†WeatherDataçš„å°è£…ï¼›æ¯ä¸€æ¬¡åˆ é™¤æˆ–è€…å¢åŠ ä¸€ä¸ªé¢æ¿æ—¶éƒ½ä¼šå¯¹WeatherDataç±»è¿›è¡Œæ“ä½œï¼Œè¿™ç§æ–¹å¼è®©é¢æ¿å¯¹è±¡ä¸WeatherDataå¯¹è±¡çš„è€¦åˆå¤ªç´§äº†â€¦â€¦èµµå››ä¸ºæ­¤å¤´å‘éƒ½æ‰äº†1256æ ¹ï¼Œäººä¹Ÿæ—¥æ¸æ¶ˆç˜¦ï¼Œå…¬å¸çš„èµ„æ·±ç¨‹åºå‘˜é‡Œæ–¯æœ¬Â·äºŒç‹—å­äºå¿ƒä¸å¿ï¼Œå‘èµµå››æå‡ºäº†ä¸€ä¸ªå»ºè®®ï¼Œä¸ºä»€ä¹ˆä¸è€ƒè™‘è€ƒè™‘ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å‘¢ï¼Ÿ èµµå››ä¸€è„¸æ‡µé€¼ï¼Œå¾ˆè®¤çœŸçš„å‘äºŒç‹—å­è¯·æ•™ï¼Œä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Ÿ äºŒç‹—å­é‚ªé­…ä¸€ç¬‘ï¼Œè½¬èº«å·å·ä¸Šè°·æ­Œï¼Œç„¶åè¯´é“ï¼š è§‚å¯Ÿè€…æ¨¡å¼åˆå«å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå®šä¹‰äº†å¯¹è±¡é—´ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ã€‚å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå…¶ä»–ä¾èµ–äºè¿™ä¸ªå¯¹è±¡çš„ä¾èµ–è€…ä»¬éƒ½ä¼šè¢«é€šçŸ¥ï¼Œç„¶åè‡ªåŠ¨æ›´æ–°ã€‚ä¸¾ä¸ªæ —å­ï¼Œå½“æˆ‘ä»¬å…³æ³¨äº†æŸä¸ªäººçš„åšå®¢ï¼ˆç›¸å½“äºè®¢é˜…ï¼‰ï¼Œå½“æ­¤åšå®¢æœ‰æ›´æ–°ï¼ˆå‘å¸ƒäº†æ–°æ–‡ç« ï¼‰ï¼Œé‚£ä¹ˆå…³æ³¨æ­¤åšå®¢çš„ç”¨æˆ·éƒ½ä¼šæ”¶åˆ°ç±»ä¼¼â€œæ‚¨å…³æ³¨çš„åšå®¢æœ‰æ›´æ–°â€è¿™æ ·çš„æ¶ˆæ¯ã€‚è¯¸å¦‚æ­¤ç±»çš„æ¨¡å¼å°±æ˜¯è§‚å¯Ÿè€…ã€‚ èµµå››ä¸€æƒ³ï¼Œè¯¶ï¼Ÿè¿™ä¸ªæ¨¡å¼å¬èµ·æ¥ç¡®å®å¾ˆç¬¦åˆç°åœ¨çš„éœ€æ±‚å‘€ï¼ èµµå››ä¹Ÿä¸Šç½‘ç»§ç»­æœç´¢ä¸ç­–ç•¥æ¨¡å¼ç›¸å…³çš„èµ„æ–™ï¼Œå‘ç°äº†è§‚å¯Ÿè€…æ¨¡å¼çš„ç±»å›¾ï¼š // æœ¬æ¥æœ‰ä¸ªç±»å›¾çš„ï¼Œç„¶è€Œå‘çˆ¹çš„ä¸ƒç‰›äº‘æŠŠæˆ‘å›¾åºŠçš„æµ‹è¯•åŸŸåå›æ”¶äº†ï¼Œæ¥ä¸‹æ¥è¦æƒ³ç”¨å°±å¿…é¡»å¤‡æ¡ˆç»‘å®šäº†ï¼Œæ…¢æ…¢æ¥å§ã€‚ã€‚ã€‚æ‡’ - - 1. æŠ½è±¡ä¸»é¢˜ï¼šä¸»é¢˜ä¸­åŒ…å«äº†è§‚å¯Ÿè€…çš„é›†åˆã€‚å¹¶æä¾›æ·»åŠ ï¼Œåˆ é™¤ä»¥åŠé€šçŸ¥è§‚å¯Ÿè€…çš„æ¥å£ 2. å…·ä½“ä¸»é¢˜å¯¹è±¡ï¼šç»§æ‰¿è‡³æŠ½è±¡ä¸»é¢˜ï¼Œç”¨ä¸€ä¸ªVectorå­˜å‚¨è§‚å¯Ÿè€…ï¼Œå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªçŠ¶æ€é‡ï¼Œå½“çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œå°±å‘è§‚å¯Ÿè€…è¿›è¡Œé€šçŸ¥ã€‚ 3. æŠ½è±¡è§‚å¯Ÿè€…ï¼šå†…éƒ¨æœ‰updateæ–¹æ³•ã€‚è¿™æ˜¯ä¸ºä¸»é¢˜å‘ç”Ÿæ”¹å˜æ—¶éœ€è¦è·å¾—é€šçŸ¥çš„å¯¹è±¡æ‰€å»ºç«‹çš„ä¸€ä¸ªæ›´æ–°æ¥å£ 4. å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼šå®ç°äº†æŠ½è±¡è§‚å¯Ÿè€…çš„æ¥å£ è®¾è®¡æ–¹æ¡ˆè§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡é—´ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ã€‚WeatherDataå¯¹è±¡åœ¨è¿™é‡Œå°±æ˜¯â€œä¸€â€ï¼Œè€Œé‚£äº›æ˜¾ç¤ºæŒ‡æ ‡çš„é¢æ¿å°±æ˜¯â€œå¤šâ€ã€‚å›åˆ°ä¸Šé¢èµµå››çš„ç–‘é—®ï¼šå¦‚ä½•æ„ŸçŸ¥åˆ°ä¸‰ä¸ªæŒ‡æ ‡çš„å˜åŒ–å¹¶åŠæ—¶ä½œå‡ºå›åº”ï¼Ÿä»ä¸Šé¢è§‚å¯Ÿè€…æ¨¡å¼çš„ç±»å›¾ï¼Œå¦‚æœæŠŠWeatherDataå¯¹è±¡å½“ä½œä¸»é¢˜ï¼ŒæŠŠä¸‰ä¸ªé¢æ¿å½“ä½œè§‚å¯Ÿè€…ï¼Œé¢æ¿è¦æ˜¾ç¤ºä¿¡æ¯ï¼Œå°±è¦å‘ä¸»é¢˜è¿›è¡Œæ³¨å†Œã€‚é‚£è¿™æ ·WeatherDataå¯¹è±¡å°±çŸ¥é“é¢æ¿çš„å­˜åœ¨äº†ï¼Œé‚£å½“å¤©æ°”æŒ‡æ ‡å˜åŒ–æ—¶ï¼ŒWeatherDataå°±å¯ä»¥è°ƒç”¨é¢æ¿çš„æŸä¸ªæ–¹æ³•æ¥é€šçŸ¥é¢æ¿è§‚æµ‹å€¼äº†ã€‚ é¦–å…ˆæ„å»ºWeatherDataä¸»é¢˜ç±» 1234567891011121314151617181920212223242526272829public class WeatherData extends Observable &#123; private float temperature; private float humidity; private float pressure; public void measurementsChanged() &#123; setChanged(); notifyObservers(); &#125; public void setMeasurements(float temperature, float humidity, float pressure) &#123; this.temperature = temperature; this.humidity = humidity; this.pressure = pressure; measurementsChanged(); &#125; public float getTemperature() &#123; return temperature; &#125; public float getHumidity() &#123; return humidity; &#125; public float getPressure() &#123; return pressure; &#125;&#125; å¯ä»¥çœ‹åˆ°WeatherDataç»§æ‰¿äº†Observableç±»ï¼ŒObservableæ˜¯Javaä¸ºè§‚å¯Ÿè€…æ¨¡å¼æä¾›çš„æŠ½è±¡ä¸»é¢˜ç±»ï¼ˆå³Subjectï¼‰ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨measurementsChangedæ–¹æ³•ä¸­è°ƒç”¨äº†ä¸¤ä¸ªç»§æ‰¿è‡³Observableç±»çš„æ–¹æ³•ï¼š setChanged()ï¼š æ¥çœ‹ä¸‹setChangedæ–¹æ³•çš„æºç ï¼š 1234567/** * Marks this &lt;tt&gt;Observable&lt;/tt&gt; object as having been changed; the * &lt;tt&gt;hasChanged&lt;/tt&gt; method will now return &lt;tt&gt;true&lt;/tt&gt;. */ protected synchronized void setChanged() &#123; changed = true; &#125; setChangedæ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯å°†changedå˜é‡è‡³ä¸ºtrueï¼ˆé»˜è®¤ä¸ºfalseï¼‰ã€‚è‡³äºchangedæ ‡å¿—ä½æœ‰ä»€ä¹ˆç”¨ï¼Œè¯·çœ‹ç¬¬äºŒä¸ªæ–¹æ³•ã€‚ notifyObservers()ï¼š é¦–å…ˆnotifyObservers()å†…éƒ¨è°ƒç”¨äº†å¦ä¸€ä¸ªé‡è½½çš„notifyObserversæ–¹æ³•ï¼š 123public void notifyObservers() &#123; notifyObservers(null); &#125; æˆ‘ä»¬æ¥çœ‹ä¸‹çœŸå®çš„æ–¹æ³•å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243/** * If this object has changed, as indicated by the * &lt;code&gt;hasChanged&lt;/code&gt; method, then notify all of its observers * and then call the &lt;code&gt;clearChanged&lt;/code&gt; method to indicate * that this object has no longer changed. * &lt;p&gt; * Each observer has its &lt;code&gt;update&lt;/code&gt; method called with two * arguments: this observable object and the &lt;code&gt;arg&lt;/code&gt; argument. * * @param arg any object. * @see java.util.Observable#clearChanged() * @see java.util.Observable#hasChanged() * @see java.util.Observer#update(java.util.Observable, java.lang.Object) */ public void notifyObservers(Object arg) &#123; /* * a temporary array buffer, used as a snapshot of the state of * current Observers. */ Object[] arrLocal; synchronized (this) &#123; /* We don't want the Observer doing callbacks into * arbitrary code while holding its own Monitor. * The code where we extract each Observable from * the Vector and store the state of the Observer * needs synchronization, but notifying observers * does not (should not). The worst result of any * potential race-condition here is that: * 1) a newly-added Observer will miss a * notification in progress * 2) a recently unregistered Observer will be * wrongly notified when it doesn't care */ if (!changed) return; arrLocal = obs.toArray(); clearChanged(); &#125; for (int i = arrLocal.length-1; i&gt;=0; i--) ((Observer)arrLocal[i]).update(this, arg); &#125; å¯ä»¥changedæ ‡å¿—ä½ç½®ä¸ºtrueæ‰å¯ä»¥åœ¨æ¥ä¸‹æ¥çš„notifyObservers()æ–¹æ³•ä¸­é€šçŸ¥è§‚å¯Ÿè€…è¿›è¡Œæ›´æ–°ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨éå†æ•°ç»„arrLocalé€šçŸ¥è§‚å¯Ÿè€…è¿›è¡Œupdateæ“ä½œçš„æ—¶å€™æ˜¯ä¸â€œåŒæ­¥çš„â€ï¼Œå› æ­¤æ­¤æ–¹æ³•ä¹Ÿå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼ˆå¦‚æ­¤æ®µä»£ç çš„æ³¨é‡Šï¼‰ï¼š1. å› ä¸ºéå†è§‚å¯Ÿè€…çš„æ–¹æ³•ä¸åšåŒæ­¥ï¼Œæ‰€ä»¥åœ¨åŒæ­¥æ–¹æ³•åæ–°åŠ å…¥çš„è§‚å¯Ÿè€…ï¼Œå°†ä¼šé”™è¿‡æ­¤æ¬¡æ­£åœ¨è¿›è¡Œçš„é€šçŸ¥ 2. åŒç†ï¼Œæœ€è¿‘è¢«åˆ é™¤çš„è§‚å¯Ÿè€…ä¹Ÿä¼šè¢«é”™è¯¯åœ°é€šçŸ¥ã€‚è€Œæ­¤æ—¶ï¼Œè¿™ä¸ªè§‚å¯Ÿè€…å·²ç»ä¸å…³æ³¨è¿™ä¸ªä¸»é¢˜äº†ã€‚ é¢æ¿æ˜¾ç¤ºçš„æ¥å£ 123public interface DisplayPanel &#123; void display();&#125; DisplayPanelæ¥å£ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå³ç”¨æ¥æ˜¾ç¤ºä¸€äº›æ•°æ®ã€‚æ¯ä¸ªä¸åŒçš„é¢æ¿éƒ½ä¼šå®ç°è¿™ä¸ªæ¥å£ã€‚ å®æ—¶å¤©æ°”é¢æ¿å®ç° 1234567891011121314151617181920212223242526272829public class WeatherCurrentDisplay implements Observer,DisplayPanel &#123; private Observable observable; private float temperature; private float humidity; private float pressure; public WeatherCurrentDisplay(Observable observable) &#123; this.observable = observable; observable.addObserver(this); &#125; @Override public void update(Observable obs, Object arg) &#123; if (obs instanceof WeatherData) &#123; WeatherData weatherData = (WeatherData) obs; this.temperature = weatherData.getTemperature(); this.humidity = weatherData.getHumidity(); this.pressure = weatherData.getPressure(); display(); &#125; &#125; @Override public void display() &#123; System.out.println("weather temperature:" + temperature + ", humidity:" + humidity + ", pressure:" + pressure); &#125;&#125; WeatherCurrentDisplayç±»ä¸ä»…å®ç°äº†DisplayPanelæ¥å£ï¼Œè¿˜å®ç°äº†Observeræ¥å£ã€‚ä¸Observableç±»ä¼¼ï¼ŒObserveræ¥å£åŒæ ·æ˜¯Javaå¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒã€‚å¯ä»¥çœ‹åˆ°åœ¨WeatherCurrentDisplayçš„æ„é€ å™¨ä¸­ï¼Œå°†â€œä¸»é¢˜â€å…ƒç´ ä½œä¸ºå…¥å‚ä¼ å…¥äº†è§‚å¯Ÿè€…ä¸­ï¼Œå¹¶è°ƒç”¨ä¸»é¢˜çš„addObserver()æ–¹æ³•ï¼Œå°†WeatherCurrentDisplayå¯¹è±¡æ³¨å†Œåˆ°äº†ä¸»é¢˜ä¸­ã€‚å¦å¤–ï¼Œåœ¨ä¸Šé¢çš„WeatherDataç±»ä¸­æˆ‘ä»¬è°ƒç”¨äº†Observableçš„notifyObserversæ–¹æ³•ï¼Œå†…éƒ¨å°±ä¼šå¯¹æ³¨å†Œåˆ°ä¸»é¢˜å†…çš„è§‚å¯Ÿè€…è¿›è¡Œupdate()ï¼Œè€Œåœ¨WeatherCurrentDisplayç±»ä¸­ä¾¿è¦†ç›–ï¼ˆoverrideï¼‰äº†Observeræ¥å£çš„update()æ–¹æ³•ï¼Œå…·ä½“çš„å®ç°å°±æ˜¯è°ƒç”¨äº†display()æ–¹æ³•ï¼Œå¯¹æ”¹å˜çš„å¤©æ°”æŒ‡æ ‡è¿›è¡Œæ˜¾ç¤ºã€‚ æ°”è±¡ç«™çš„ä»£ç å®ç° 123456789public class WeatherStation &#123; public static void main(String[] args) &#123; WeatherData weatherData = new WeatherData(); WeatherCurrentDisplay indexDisplay = new WeatherCurrentDisplay(weatherData); weatherData.setMeasurements(30,50, 1800); weatherData.setMeasurements(35,80, 2800); &#125;&#125; ç»“æœæ˜¾ç¤º 1234weather temperature:30.0, humidity:50.0, pressure:1800.0weather temperature:35.0, humidity:80.0, pressure:2800.0Process finished with exit code 0 æ€»ç»“ å…³äºâ€œè§‚å¯Ÿè€…æ¨¡å¼â€çš„ä¸¤ç§æ¨¡å¼ï¼š è§‚å¯Ÿè€…æ¨¡å¼åœ¨å…·ä½“å®ç°æ—¶ï¼Œæ ¹æ®ç³»ç»Ÿè®¾è®¡æ—¶çš„ä¸åŒéœ€æ±‚ï¼Œä¸€èˆ¬æœ‰ä¸¤ä¸ªä¸åŒçš„ç‰ˆæœ¬ï¼šæ¨å’Œæ‹‰ã€‚æ¨æ¨¡å¼â€”â€”å°±æ˜¯å½“ä¸»é¢˜å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¸»é¢˜ä¸»åŠ¨å°†å˜åŒ–çš„ä¿¡æ¯æ¨é€ç»™è§‚å¯Ÿè€…ã€‚æ¯”å¦‚è¯´æ°”è±¡ç«™åªéœ€è¦æ¸©åº¦ï¼Œæ¹¿åº¦å’Œæ°”å‹ä¸‰ä¸ªæŒ‡æ ‡ï¼Œé‚£ä¹ˆä¸»é¢˜åªå°†è¿™ä¸‰ä¸ªè§‚å¯Ÿè€…å…³æ³¨çš„æŒ‡æ ‡æ¨é€å‡ºå»ã€‚æ‹‰æ¨¡å¼â€”â€”å½“ä¸»é¢˜å‘ç”Ÿå˜åŒ–ï¼Œä»…ä»…åªå‘Šè¯‰è§‚å¯Ÿè€…â€œä¸»é¢˜å‘ç”Ÿå˜åŒ–â€ï¼Œè‹¥è§‚å¯Ÿè€…æƒ³è¦çŸ¥é“å…·ä½“çš„æ”¹å˜ä¿¡æ¯ï¼Œéœ€è¦ä¸»åŠ¨ä»ä¸»é¢˜ä¸­â€œæ‹‰â€å‡ºæ¥ã€‚æ‹‰æ¨¡å¼ä¸€èˆ¬ä¼šæŠŠä¸»é¢˜å¯¹è±¡ä½œä¸ºupdate()æ–¹æ³•çš„å…¥å‚ï¼Œä»è€Œä¼ é€’ç»™è§‚å¯Ÿè€…ã€‚å½“è§‚å¯Ÿè€…éœ€è¦è·å–å…·ä½“å˜åŒ–ä¿¡æ¯æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¸»é¢˜å¯¹è±¡çš„å¼•ç”¨æ¥è·å–ã€‚å¾ˆæ˜æ˜¾ï¼Œä¸Šé¢èµµå››å®ç°çš„ä»£ç å°±ä½¿ç”¨äº†æ‹‰æ¨¡å¼ã€‚ é‚£ä¹ˆæ¨å’Œæ‹‰æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ æ¨æ¨¡å¼å°†æ”¹å˜ä¿¡æ¯ä½œä¸ºupdateæ–¹æ³•çš„å…¥å‚ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦å¢åŠ ç»™è§‚å¯Ÿè€…çš„ä¿¡æ¯æ—¶ï¼Œè¦ä¹ˆæä¾›æ–°çš„updateæ–¹æ³•æˆ–è€…é‡æ–°å®ç°è§‚å¯Ÿè€…ï¼Œè¿™æ ·çš„æƒ…å†µæ˜¯ä¸æ˜“äºæ‰©å±•çš„ï¼›è€Œæ‹‰æ¨¡å‹å°†ä¸»é¢˜å¯¹è±¡è‡ªèº«ä¼ é€’ç»™è§‚å¯Ÿè€…ï¼Œè®©è§‚å¯Ÿè€…è‡ªå·±å»æŒ‰éœ€è¦å–å¾—ä¿¡æ¯ï¼Œè¿™æ ·å°±ä¸å­˜åœ¨ä¸Šè¿°çš„é—®é¢˜ã€‚ å½“æˆ‘ä»¬æ˜ç¡®çŸ¥é“éœ€è¦é€šçŸ¥çš„ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨æ¨¡å¼ã€‚è€Œå½“æˆ‘ä»¬ä¸æ¸…æ¥šè§‚å¯Ÿè€…å…·ä½“éœ€è¦çš„ä¿¡æ¯æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ‹‰æ¨¡å¼ã€‚ ä½¿ç”¨Javaè‡ªå¸¦çš„è§‚å¯Ÿè€…æ¨¡å¼æœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š å› ä¸ºéå†è§‚å¯Ÿè€…çš„æ–¹æ³•ä¸åšåŒæ­¥ï¼Œæ‰€ä»¥åœ¨åŒæ­¥æ–¹æ³•åæ–°åŠ å…¥çš„è§‚å¯Ÿè€…ï¼Œå°†ä¼šé”™è¿‡æ­¤æ¬¡æ­£åœ¨è¿›è¡Œçš„é€šçŸ¥ã€‚ åŒç†ï¼Œæœ€è¿‘è¢«åˆ é™¤çš„è§‚å¯Ÿè€…ä¹Ÿä¼šè¢«é”™è¯¯åœ°é€šçŸ¥ã€‚è€Œæ­¤æ—¶ï¼Œè¿™ä¸ªè§‚å¯Ÿè€…å·²ç»ä¸å…³æ³¨è¿™ä¸ªä¸»é¢˜äº†ã€‚ ä¸èƒ½ä¾èµ–è§‚å¯Ÿè€…è¢«é€šçŸ¥çš„æ¬¡åºã€‚å¯ä»¥ä»æºç ä¸­çœ‹åˆ°ä¸»é¢˜é€šçŸ¥è§‚å¯Ÿè€…çš„é¡ºåºæ˜¯æŒ‰ç…§listå€’åºçš„ï¼Œæ‰€ä»¥å½“ä»£ç ä»¥æ¥é€šçŸ¥é¡ºåºçš„æ—¶å€™ï¼Œä½¿ç”¨å°±éœ€è¦å¾ˆå°å¿ƒäº†ã€‚å½“ç„¶å¯ä»¥é€šè¿‡è‡ªå·±å†™ä¸»é¢˜åŠè§‚å¯Ÿè€…çš„ä»£ç é¿å…è¿™ç§æƒ…å†µï¼Œä¹Ÿä¸å¤æ‚ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å¿…é¡»ç»§æ‰¿Observableç±»ï¼Œæ‰èƒ½ç”¨åˆ°setChanged()æ–¹æ³•ã€‚å…¶å®è¿™ç§è®¾è®¡ä¹Ÿè¿åäº†â€œå¤šç”¨ç»„åˆï¼Œå°‘ç”¨ç»§æ‰¿â€è¿™ä¸ªè®¾è®¡åŸåˆ™ã€‚]]></content>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>è§‚å¯Ÿè€…æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ï¼ˆä¸€ï¼‰â€”â€”ç­–ç•¥æ¨¡å¼]]></title>
    <url>%2F2018%2F11%2F19%2FstrategyDesignPattern%2F</url>
    <content type="text"><![CDATA[ç³»åˆ—å…³äºè®¾è®¡æ¨¡å¼ï¼Œæˆ‘ä¹‹å‰ä¹Ÿè¯»è¿‡ç›¸å…³ä¹¦ç±ï¼ˆä¸»è¦æ˜¯è¿™æœ¬ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹ï¼‰ã€‚å½“æ—¶è¾¹çœ‹è¿™æœ¬ä¹¦ï¼Œè¾¹æ ¹æ®ä¹¦ä¸­çš„ä¸€äº›ä¾‹å­å†™äº†ä¸€äº›åšå®¢ï¼ˆæˆ‘çš„CSDNåšå®¢ï¼‰ã€‚è¿™äº›åšå®¢ï¼Œä¸€è€…ç°åœ¨çœ‹æ¥å¤§å¤šéƒ½æ˜¯æµæ°´è´¦ï¼›äºŒè€…å› ä¸ºåœ¨å®é™…ä¸­è¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼çœŸçš„ä¸å¤šï¼ˆå·¥ä½œç»å†ç¼ºä¹ï¼‰ï¼Œå› æ­¤ä¹Ÿå®¹æ˜“é—å¿˜ï¼›ä¸‰è€…ï¼Œå½“åˆå‚ç…§çš„ä¹¦å…³äºè®¾è®¡æ¨¡å¼è®²çš„çœŸçš„ä¸ç®—å¤ªå¥½ï¼Œå¯¹äº23ç§è®¾è®¡æ¨¡å¼æ²¡æœ‰å¾ˆæ˜ç¡®çš„åˆ†ç±»ï¼ˆæ¯”å¦‚é‡è¦æ€§ç­‰ï¼‰ï¼Œä¸¾çš„ä¾‹å­ä¹Ÿè¯´ä¸ä¸Šè´´è¿‘ç°å®å’Œé€šä¿—æ˜“æ‡‚ã€‚é‚£ä¹ˆå‰æ®µæ—¶é—´ï¼ˆå¤§æ¦‚æ˜¯618çš„æ—¶å€™ï¼‰ï¼Œæˆ‘ä¹°äº†ä¸€æœ¬ã€ŠHead Firstè®¾è®¡æ¨¡å¼ã€‹å¹¶ä¸”è¯»å®Œã€‚è¿™æœ¬ä¹¦å°±æˆ‘æ¥çœ‹ï¼Œæ°´å¹³ä»¥åŠå¯¹æˆ‘çš„å¸®åŠ©æ˜¯è¦é«˜äºä¸Šä¸€æœ¬ä¹¦çš„ã€‚å¹¶ä¸”åœ¨å·¥ä½œä¸­ï¼Œä¹Ÿç¡®å®æ„Ÿè§‰åˆ°äº†æœ‰ç†Ÿæ‚‰è®¾è®¡æ¨¡å¼çš„å¿…è¦ï¼Œå› æ­¤çœ‹å®Œåï¼Œæˆ‘ä¹Ÿç”Ÿå‡ºäº†é‡æ–°å†™ä¸€éè®¾è®¡æ¨¡å¼çš„å¿µå¤´ã€‚ä»¥ä¸‹ï¼Œä¾¿æ˜¯è¦ä»‹ç»çš„ç¬¬ä¸€ä¸ªè®¾è®¡æ¨¡å¼â€”â€”ç­–ç•¥æ¨¡å¼ â… . ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ ç­–ç•¥æ¨¡å¼å°±æ˜¯å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼Œå¹¶å°†å®ƒä»¬åˆ†åˆ«å°è£…èµ·æ¥ï¼Œä½¿ä»–ä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼ä½¿å¾—ç®—æ³•ä»¥ç‹¬ç«‹äºå®¢æˆ·è€Œå˜åŒ–ã€‚ç­–ç•¥æ¨¡å¼æ¶‰åŠåˆ°ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼š 1. æŠ½è±¡ç­–ç•¥è§’è‰²ï¼šå®šä¹‰äº†å…·ä½“ç­–ç•¥éœ€è¦å®ç°çš„æŠ½è±¡æ–¹æ³•æˆ–æ¥å£ 2. å…·ä½“ç­–ç•¥è§’è‰²ï¼šå°è£…å…·ä½“çš„ç®—æ³• 3. å®¢æˆ·è§’è‰²ï¼šå†…éƒ¨æŒæœ‰ç­–ç•¥ç±»å¯¹è±¡çš„å¼•ç”¨ ä¸æ˜ç™½æ²¡å…³ç³»ï¼Œæ¥ä¸ªä¾‹å­å°±éƒ½æ¸…æ™°äº†ï½ â…¡. ä¸¾ä¸ªä¾‹å­ä»¥ä¹¦ä¸­çš„â€œæ¨¡æ‹Ÿé¸­å­æ¸¸æˆâ€ä¸ºæ¡ˆä¾‹æ¥å…·ä½“è®²è¿°ä¸‹è¿™ä¸ªæ¨¡å¼ï½ èƒŒæ™¯çš„è¿™æ ·çš„ï¼š å°¼å¤æ‹‰æ–¯Â·èµµå››æ˜¯balabalaå…¬å¸çš„ä¸€åç¨‹åºå‘˜ã€‚æœ€è¿‘PMè®©ä»–åšä¸€æ¬¾â€œé¸­å­æ¸¸æˆâ€ï¼ˆå¾ˆæ­£ç»çš„æ¸¸æˆï¼Œæ¸¸æˆè€…å¯ä»¥é€‰æ‹©ä¸åŒçš„é¸­å­æ§åˆ¶å®ƒå«æˆ–è€…è®©å®ƒæ¸¸æ³³ä¹‹ç±»çš„ï¼Œä¸è¿‡å¤§æ¦‚å¯èƒ½åªæœ‰å°æœ‹å‹ä¼šç©å§ XDï¼‰ã€‚éœ€æ±‚ç¬¬ä¸€æœŸè¦æ±‚åšä¸€ä¸ªè®©é¸­å­å«çš„åŠŸèƒ½ï¼Œèµµå››æŒ‰ç…§æ­£å¸¸çš„è®¾è®¡é€»è¾‘ï¼Œé¦–å…ˆè®¾è®¡äº†ä¸€ä¸ªé¸­å­Duckçš„è¶…ç±»ï¼ˆå—¯ï½èµµå››æ˜¯ä¸€ä¸ªæœ‰åŸºç¡€OOç´ å…»çš„coderï¼‰ï¼Œåœ¨Duckç±»ä¸­ä»–å†™äº†ä¸€ä¸ªéæŠ½è±¡çš„quackæ–¹æ³•ï¼ˆå› ä¸ºé¸­å­éƒ½ä¼šå«ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†äº¤ç»™çˆ¶ç±»å»å®Œæˆï¼‰ï¼›ç„¶åè¿˜æœ‰ä¸€ä¸ªæŠ½è±¡çš„displayæ–¹æ³•ï¼ˆæ¯•ç«Ÿä¸åŒç§ç±»çš„é¸­å­é•¿å¾—ä¸ä¸€æ ·å˜›ï¼ï¼‰ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š ç¡®å®šäº†è®¾è®¡æ–¹æ¡ˆä»¥åï¼Œä»–è®¾è®¡äº†å¾ˆå¤šä¸ªç±»å¹¶ä¸”ç»§æ‰¿äº†Duckè¶…ç±»ï¼šæ™®é€šé¸­å­ï¼Œæ©¡çš®é¸­å­ï¼Œç»¿å¤´é¸­ï¼Œé¸³é¸¯â€¦â€¦ä»–ä¸€å£æ°”å†™äº†è¿™ä¹ˆå¤šçš„ç±»ï¼Œä½†æ˜¯å¥½æ­¹æ˜¯å®Œæˆäº†PMçš„éœ€æ±‚ï¼Œæ­£æƒ³ä¼‘æ¯ä¼šã€‚PMè¯´â€œèµµå››å‘€ï¼Œæˆ‘ä»¬ç°åœ¨è¦ç»™é¸­å­åŠ ä¸Šé£è¡Œçš„featureâ€ã€‚èµµå››ï¼šâ€œåŠ éœ€æ±‚æ˜¯ä¸å¯èƒ½åŠ çš„ï¼Œè¿™è¾ˆå­éƒ½ä¸å¯èƒ½åŠ ã€‚æˆ‘è¦æ˜¯åŠ ï¼Œæˆ‘èµµå››å°±ä»è¿™è·³ä¸‹å»ï¼â€PMï¼šâ€œæˆ‘æ›¿hrå’Œä½ è¯´ä¸€å£°ï¼Œæ˜å¤©å»è´¢åŠ¡å®¤æŠ¥é“â€èµµå››ï¼šâ€œæˆ‘é©¬ä¸ŠåŠ ç­åšï¼â€èµµå››æƒ³ï¼Œä¹ŸæŒºç®€å•å˜›ï¼Œåœ¨Duckç±»ä¸­åŠ ä¸€ä¸ªéæŠ½è±¡çš„flyæ–¹æ³•å°±å¥½äº†å˜›ï¼é¸­å­ä»¬éƒ½ç»™æˆ‘é£èµ·æ¥ï¼ 5minåï¼Œæµ‹è¯•å¦¹å­ä¸€è„¸ä¾¿ç§˜çš„æ¥æ‰¾èµµå››ï¼Œâ€œèµµå››ï¼Œä½ è„‘å­åäº†ä¹ˆï¼Ÿï¼Ÿæ©¡çš®é¸­å­æ»¡å±å¹•åœ°é£ï¼â€èµµå››ï¼šâ€œæˆ‘â€¦.â€æµ‹è¯•ï¼šâ€œä½ ä»€ä¹ˆä½ ï¼èµ¶ç´§æ”¹ï¼â€èµµå››çœ‹äº†ä¸‹è‡ªå·±çš„è®¾è®¡é€»è¾‘ï¼Œä¸€ä¸‹å°±æ‰¾åˆ°äº†é—®é¢˜â€”â€”å¹¶ä¸æ˜¯æ‰€æœ‰çš„é¸­å­éƒ½ä¼šé£ï¼Œå¦‚æœæŠŠé£è¡Œçš„è¡Œä¸ºåŠ åˆ°çˆ¶ç±»ä¸­å»å®ç°ï¼Œé‚£å°±å¯¼è‡´æŸäº›ä¸é€‚åˆè¯¥è¡Œä¸ºçš„å­ç±»ä¹Ÿå…·æœ‰äº†é£è¡Œçš„åŠŸèƒ½ã€‚é‚£åº”è¯¥æ€ä¹ˆæ ·åšå‘¢ï¼Ÿèµµå››æƒ³åˆ°è®¾è®¡æ¨¡å¼å¤§å¸ˆç»™ä»–ä»‹ç»è¿‡çš„ä¸€ä¸ªè®¾è®¡æ¨¡å¼â€”â€”ç­–ç•¥æ¨¡å¼ï¼Œæ„Ÿè§‰ç”¨åœ¨è¿™ä¸ªåœ°æ–¹å¾ˆåˆé€‚å•Šï¼äºæ˜¯ä»–å°†â€œé¸­å­æ¸¸æˆâ€ç³»ç»Ÿé€šè¿‡ç­–ç•¥æ¨¡å¼è¿›è¡Œä¿®æ”¹ï¼š é¦–å…ˆæ„å»ºé¸­å­çš„â€œé£è¡Œâ€è¡Œä¸ºæ¥å£ 123public interface FlyBehavior &#123; void fly();&#125; é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°FlyBehavioræ¥å£æ¥åˆ›å»ºä¸åŒçš„é£è¡Œè¡Œä¸º ç„¶åæ„å»ºé¸­å­çš„â€œå‘±å‘±å«â€è¡Œä¸ºæ¥å£ 123public interface QuackBehavior &#123; void quack();&#125; å»ºç«‹ä¸€ä¸ªé¸­å­çš„æŠ½è±¡ç±» 12345678910111213141516171819202122public abstract class Duck &#123; protected FlyBehavior flyBehavior; protected QuackBehavior quackBehavior; public abstract void display(); public void performFly() &#123; flyBehavior.fly(); &#125; public void performQuack() &#123; quackBehavior.quack(); &#125; public void setFlyBehavior(FlyBehavior flyBehavior) &#123; this.flyBehavior = flyBehavior; &#125; public void setQuackBehavior(QuackBehavior quackBehavior) &#123; this.quackBehavior = quackBehavior; &#125;&#125; è¿™æ˜¯â€œé¸­å­â€çš„æŠ½è±¡ç±»ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªâ€œå°å¿ƒæœºâ€ï¼Œåœ¨Duckç±»ä¸­æŒæœ‰ç€å¯¹FlyBehaviorä»¥åŠQuackBehavioræ¥å£çš„å¼•ç”¨ï¼Œå¹¶ä¸”æœ‰setteræ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­â€œåŠ¨æ€â€åœ°è®¾å®šé¸­å­ğŸ¦†çš„è¡Œä¸ºäº†ï¼ æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿæ¥å®ç°FlyBehaviorå§ 1234567public class FlyWithWings implements FlyBehavior&#123; @Override public void fly() &#123; System.out.println("I can fly! Flying with wings!"); &#125;&#125; ä¸Šé¢æ˜¯ä¸€ä¸ªâ€œä¼šé£â€ï¼ˆè€Œä¸”æ˜¯ç”¨ç¿…è†€é£ï¼‰çš„é£è¡Œè¡Œä¸ºå®ç°ï¼Œå†æ¥ä¸€ä¸ªâ€œä¸ä¼šé£â€çš„é£è¡Œè¡Œä¸ºï¼ˆæ©¡çš®é¸­å­å°±ä¸ä¼šé£å¯¹å§ï¼‰ï¼ 1234567public class CanNotFly implements FlyBehavior &#123; @Override public void fly() &#123; System.out.println("Fuck! I can't fly!"); &#125;&#125; ç»§ç»­å»ºç«‹ä¸¤ä¸ªQuackBehaviorçš„å®ç° 1234567public class Quack implements QuackBehavior &#123; @Override public void quack() &#123; System.out.println("Quack! Quack! Quack!"); &#125;&#125; ä¸Šé¢è¿™æ˜¯æ˜¯æ­£å¸¸é¸­å­çš„å«å£°ï¼ˆâ€Quack! Quack! Quack!â€ï¼‰ï¼Œæ¥ä¸‹æ¥å»ºç«‹ä¸€ä¸ªâ€œå’©å’©å’©â€å«çš„é¸­å­å«è¡Œä¸ºï¼ˆé«˜è´µçš„èµµå››è¡¨ç¤ºä»–ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰é¸­å­æ˜¯å’©å’©å«çš„ - -ï¼‰ 1234567public class MewQuack implements QuackBehavior &#123; @Override public void quack() &#123; System.out.println("Mew! Mew! Mew!"); &#125;&#125; æ¥ä¸‹æ¥æ¥å»ºç«‹ä¸¤åªä¸åŒçš„é¸­å­æ¥åšæ¨¡æ‹Ÿï¼ 123456789public class RubberDuck extends Duck &#123; @Override public void display() &#123; System.out.println("Hi! It's a RubberDuck!"); performFly(); performQuack(); &#125;&#125; ç¬¬ä¸€åªé¸­å­æ˜¯ä¸€åªæ©¡çš®é¸­å­ï¼Œèµµå››è§‰å¾—è¿˜éœ€è¦ä¸€åªâ€œæ­£å¸¸â€çš„é¸­å­ï¼š 123456789public class NormalDuck extends Duck &#123; @Override public void display() &#123; System.out.println("Hi! It's a NormalDuck!"); performFly(); performQuack(); &#125;&#125; æœ€åï¼Œæœ€åæ¥å»ºç«‹ä¸€ä¸ªé¸­å­æ¸¸æˆæ¨¡æ‹Ÿå™¨ï¼Œæ¥æ¨¡æ‹Ÿä¸‹ï¼ 123456789101112131415161718192021222324public class DuckGameSimulator &#123; public static void main(String[] args) &#123; FlyBehavior flyWithWings = new FlyWithWings(); FlyBehavior cantNotFly = new CanNotFly(); QuackBehavior quack = new Quack(); QuackBehavior mew = new MewQuack(); System.out.println("************* Duck 1 *************" + "\n"); Duck rubberDuck = new RubberDuck(); rubberDuck.setFlyBehavior(cantNotFly); rubberDuck.setQuackBehavior(mew); rubberDuck.display(); System.out.println("\n" + "************* Duck 2 *************" + "\n"); Duck normalDuck = new NormalDuck(); normalDuck.setFlyBehavior(flyWithWings); normalDuck.setQuackBehavior(quack); normalDuck.display(); &#125;&#125; çœ‹ä¸‹è¾“å‡ºçš„ç»“æœï¼ 1234567891011************* Duck 1 *************Hi! It's a RubberDuck!Fuck! I can't fly!Mew! Mew! Mew!************* Duck 2 *************Hi! It's a NormalDuck!I can fly! Flying with wings!Quack! Quack! Quack! â…£. æ€»ç»“è®¾è®¡åŸåˆ™ï¼šå°†åº”ç”¨ä¸­å˜åŒ–çš„éƒ¨åˆ†ä¸å›ºå®šçš„éƒ¨åˆ†åˆ†ç¦»ï¼Œå¹¶æŠŠâ€œå˜åŒ–â€è¿›è¡Œå°è£…ï¼Œä»è€Œä¸å½±å“åº”ç”¨å…¶ä»–çš„éƒ¨åˆ†ã€‚è¿™æ ·å°±è®©ç³»ç»Ÿçš„è€¦åˆé™ä½ï¼Œç³»ç»Ÿå°†æ›´æœ‰å¼¹æ€§ã€‚]]></content>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
        <tag>ç­–ç•¥</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Lambda+Streamå¯¹é›†åˆè¿›è¡Œæ“ä½œ]]></title>
    <url>%2F2018%2F11%2F11%2FLambdaAndStreamOperate%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢Lambdaè¡¨è¾¾å¼ä»¥åŠstream APIæ˜¯Java8æ‰æ”¯æŒçš„ä¸¤ä¸ªåŠŸèƒ½ã€‚Lambdaå…è®¸æŠŠå‡½æ•°ä½œä¸ºä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ï¼ˆå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’è¿›æ–¹æ³•ä¸­ï¼‰ï¼ŒLambda è¡¨è¾¾å¼å¡«è¡¥äº†Javaå¯¹äºå‡½æ•°å¼ç¼–ç¨‹çš„ç©ºç™½ï¼›Stream APIï¼ˆjava.util.streamï¼‰åˆ™æŠŠçœŸæ­£çš„å‡½æ•°å¼ç¼–ç¨‹é£æ ¼å¼•å…¥åˆ°Javaä¸­ã€‚ä¸¤è€…ç»“åˆå¯ä»¥å¸¦æ¥å¾ˆå¤šå¥‡å¦™çš„codeä½“éªŒï¼å¯¹å¾ˆå¤šåˆå­¦è€…ï¼ˆæ¯”å¦‚æˆ‘ï¼‰æ¥è¯´ï¼ŒLambda+Streamçš„æ–¹å¼ä¸€æ–¹é¢ç¡®å®ç®€åŒ–äº†ä»£ç çš„ä¹¦å†™ï¼Œè®©ä»£ç ç»“æ„å˜å¾—æ¯”è¾ƒä¼˜é›…ï¼Œä½†ä»å¦ä¸€æ–¹é¢æ¥è¯´è¿™æ ·çš„ä»£ç é£æ ¼ï¼Œç€å®ä¸å®¹æ˜“çœ‹æ‡‚ã€‚ä½†æ˜¯éšç€å®é™…çš„å­¦ä¹ ä½¿ç”¨ï¼Œæˆ‘æ„ˆå‘æ„Ÿè§‰åˆ°è¿™ä¸¤è€…ç»“åˆä¸ºå¼€å‘å¸¦æ¥äº†nå¤šæ•ˆç‡ä¸å¿«æ„Ÿï¼æ¥ä¸‹æ¥å°±æ¥æ¢ç´¢ä¸‹è¿™ç§å¥‡å¦™çš„ç¼–ç¨‹styleå§ï¼ P.S. æ­¤æ–‡ä¸è®²è¿°æœ€åŸºæœ¬çš„lambdaä»¥åŠstreamçš„æ¦‚å¿µå’Œç”¨æ³•ï¼Œåªç²—ç•¥çš„ä»‹ç»ä¸‹è¿™ç§codeæ–¹å¼åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­çš„åº”ç”¨ å‡å¦‚æœ‰ä¸€ä¸ªå§“åçš„listå’Œä¸€ä¸ªæ•°å­—çš„listï¼šï¼š 12private static List&lt;String&gt; nameList = Arrays.asList("Pony", "Jack", "Gay", "Porsche", "Aston", "Maybachâ€);private static List&lt;Integer&gt; numberList = Arrays.asList(1, 2, 3, 4, 5, 6); ###1. é›†åˆéå†å¦‚æœè¦éå†nameListï¼Œä¼ ç»Ÿçš„ä½¿ç”¨æ˜¯é€šè¿‡forå¾ªç¯æ¥å®ç°çš„ï¼Œå¦‚æœåˆ©ç”¨lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥è®©éå†çš„ä»£ç å˜å¾—æ›´ç®€æ´æ˜äº†ï¼š 12345678910111213// å¸¸è§„æ–¹å¼éå†System.out.println("************ ä»¥ä¸‹ä¸ºå¸¸è§„æ–¹å¼éå†list ************");for (String name : nameList) &#123; System.out.println("name:" + name);&#125;System.out.println("************ ä»¥ä¸‹ä¸ºLambda+å‡½æ•°æ“ä½œ éå†list ************");// Lambda å‡½æ•°æ“ä½œnameList.forEach(name -&gt; System.out.println("name:" + name));System.out.println("************ ä»¥ä¸‹ä¸ºLambda+åŒå†’å·æ“ä½œç¬¦ éå†list ************");// Lambda åŒå†’å·æ“ä½œç¬¦nameList.forEach(System.out::println); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š123456789101112131415161718192021************ ä»¥ä¸‹ä¸ºå¸¸è§„æ–¹å¼éå†list ************name:Ponyname:Jackname:Gayname:Porschename:Astonname:Maybach************ ä»¥ä¸‹ä¸ºLambda+å‡½æ•°æ“ä½œ éå†list ************name:Ponyname:Jackname:Gayname:Porschename:Astonname:Maybach************ ä»¥ä¸‹ä¸ºLambda+åŒå†’å·æ“ä½œç¬¦ éå†list ************PonyJackGayPorscheAstonMaybach å¯ä»¥çœ‹åˆ°è¿ç”¨äº†lambdaè¡¨è¾¾å¼çš„éå†ä»£ç å˜çš„çŸ­å°ç²¾æ‚ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å…ˆæ˜¯ç”¨å¸¸ç”¨çš„ç®­å¤´è¯­æ³•ï¼ˆ-&gt;ï¼‰åˆ›å»º Lambda è¡¨è¾¾å¼ï¼Œç„¶åè¿˜ç”¨äº† Java 8 å…¨æ–°çš„åŒå†’å·æ“ä½œç¬¦ï¼ˆ::ï¼‰ã€‚ä½†æ˜¯ä»è¾“å‡ºç»“æœä¸Šæ¥çœ‹ï¼ŒåŒå†’å·æ“ä½œç¬¦å°½ç®¡ç®€å•ï¼Œä½†å´ç¼ºä¹çµæ´»åŠå¼¹æ€§ã€‚ ###2. filter()è¿‡æ»¤ æˆ‘ä»¬ä½¿ç”¨streamä¸­çš„filterè¿‡æ»¤å™¨æ¥è¿‡æ»¤å¾—åˆ°ä»¥â€Pâ€ä¸ºå¼€å¤´çš„å§“åï¼š 12System.out.println("************ ä»¥ä¸‹ä¸ºLambda+Stream è¿‡æ»¤list ************");nameList.stream().filter(name -&gt; name.startsWith("P")).forEach(name -&gt; System.out.println("start with P: " + name)); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š123************ ä»¥ä¸‹ä¸ºLambda+Stream è¿‡æ»¤list ************start with P: Ponystart with P: Porsche å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œstreamçš„filteråŠŸèƒ½æ˜¯â€œæ­£å‘â€çš„è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯å°†ç¬¦åˆfilterå†…æ¡ä»¶çš„æ•°æ®â€œè¿‡æ»¤â€å‡ºæ¥ï¼Œè€Œä¸æ˜¯â€œæ’é™¤â€è¿™äº›æ•°æ®ã€‚ ###3. collect()æ–¹æ³• æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ collect æ–¹æ³•æ¥å°†æˆ‘ä»¬çš„ç»“æœé›†æ”¾åˆ°ä¸€ä¸ªlistï¼Œå­—ç¬¦ä¸²ï¼Œ Setä¸­: 123System.out.println("************ ä»¥ä¸‹ä¸ºLambda+Stream è¿‡æ»¤list å¹¶è¾“å‡ºä¸ºæ–°çš„list ************");List&lt;String&gt; filterNameList = nameList.stream().filter(name -&gt; name.startsWith("P")).collect(Collectors.toList());filterNameList.forEach(name -&gt; System.out.println("filterName:" + name)); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š123************ ä»¥ä¸‹ä¸ºLambda+Stream è¿‡æ»¤list å¹¶è¾“å‡ºä¸ºæ–°çš„list ************filterName:PonyfilterName:Porsche ###4. limit()é™åˆ¶ç»“æœé›†æ•°ç›® æˆ‘ä»¬ä¸æƒ³è¦å…¨éƒ¨çš„ç»“æœé›†ï¼Œåªéœ€è¦å‰é¢å‡ è¡Œæ€ä¹ˆåŠï¼Ÿeasyï¼Œlimitæ¥å¸®å¿™ï¼ä½¿ç”¨limitå¯ä»¥çµæ´»é™åˆ¶ç»“æœé›†æ•°ç›®ï¼š 12System.out.println("************ ä»¥ä¸‹ä¸ºLambda+Stream è¿‡æ»¤list å¹¶ç”¨limit é™åˆ¶ç»“æœé›†æ•°ç›® ************");nameList.stream().filter(name -&gt; name.startsWith("P")).limit(1).forEach(name -&gt; System.out.println("start with P: " + name)); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š12************ ä»¥ä¸‹ä¸ºLambda+Stream è¿‡æ»¤list å¹¶ç”¨limit é™åˆ¶ç»“æœé›†æ•°ç›® ************start with P: Pony ###5. sorted()æ’åº å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨çš„nameListæ˜¯æ— åºçš„ï¼Œä½¿ç”¨sortedå°±å¯ä»¥è¿›è¡Œç®€æ´åˆçµæ´»çš„æ’åºäº†ï¼æˆ‘ä»¬æ¥å¯¹nameListæŒ‰ç…§å§“åçš„å­—å…¸åºè¿›è¡Œæ’åºå§ï¼š 12System.out.println("************ ä»¥ä¸‹ä¸ºLambda+Stream é€šè¿‡åå­—çš„å­—å…¸åºå¯¹listæ’åº ************");nameList.stream().sorted((name1, name2) -&gt; (name1.compareTo(name2))).forEach(name -&gt; System.out.println("sorted name: " + name)); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š1234567************ ä»¥ä¸‹ä¸ºLambda+Stream é€šè¿‡åå­—çš„å­—å…¸åºå¯¹listæ’åº ************sorted name: Astonsorted name: Gaysorted name: Jacksorted name: Maybachsorted name: Ponysorted name: Porsche ###6. min()å’Œmax()å¾—åˆ°æœ€å°å€¼åŠæœ€å¤§å€¼ å¦‚æœè¦è·å–æ’åºåçš„æœ€å°å€¼ï¼ˆåºå·æœ€å°ï¼‰æˆ–æœ€å¤§å€¼ï¼ˆåºå·æœ€å¤§ï¼‰å‘¢ï¼Ÿä½¿ç”¨minå’Œmaxå§ï¼ 1234System.out.println("************ ä»¥ä¸‹ä¸ºLambda+Stream é€šè¿‡åå­—çš„å­—å…¸åºå¯¹listæ’åº ååˆ†åˆ«å–å‡ºç¬¬ä¸€ä¸ªåŠæœ€åä¸€ä¸ªname ************");String minName = nameList.stream().min((name1, name2) -&gt; (name1.compareTo(name2))).get();String maxName = nameList.stream().max((name1, name2) -&gt; (name1.compareTo(name2))).get();System.out.println("minName: " + minName + ", maxName: " + maxName); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š12************ ä»¥ä¸‹ä¸ºLambda+Stream é€šè¿‡åå­—çš„å­—å…¸åºå¯¹listæ’åº ååˆ†åˆ«å–å‡ºç¬¬ä¸€ä¸ªåŠæœ€åä¸€ä¸ªname ************minName: Aston, maxName: Porsche ###7. map()æ¥å®Œæˆå¯¹streamä¸­å€¼çš„è½¬æ¢ å¯¹äºnumberListï¼Œæˆ‘ä»¬è¦å¦‚ä½•å¯¹å…¶ä¸­æ¯ä¸€ä¸ªæ•°è¿›è¡Œå¹³æ–¹è¿ç®—å‘¢ï¼Ÿæˆ‘ä»¬å°† Lambda è¡¨è¾¾å¼ x -&gt; x * x ä¼ ç»™ map() æ–¹æ³•ï¼Œæ¥å¯¹numberListä¸­æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œã€‚ç„¶åå†æ‰“å°çœ‹çœ‹å§ï¼š 123456// mapå°†æµä¸­çš„ä¸€ä¸ªå€¼è½¬æ¢æˆä¸€ä¸ªæ–°çš„å€¼System.out.println("************ ä»¥ä¸‹ä¸ºLambda+Stream ä½¿ç”¨mapå¯¹numberListä¸­å¯¹å…ƒç´ è¿›è¡Œå¹³æ–¹è¿ç®— ************");numberList.stream().map(x -&gt; x * x).forEach(System.out::println);```Javaè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š ** ä»¥ä¸‹ä¸ºLambda+Stream ä½¿ç”¨mapå¯¹numberListä¸­å¯¹å…ƒç´ è¿›è¡Œå¹³æ–¹è¿ç®— **149162536123456789###8. reduce()ç”Ÿæˆæ–°çš„å€¼å¯¹numberListä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œå¹³æ–¹è¿ç®—åï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¾—åˆ°å®ƒä»¬çš„å’Œå‘¢ï¼Ÿæˆ‘ä»¬ä½¿ç”¨ reduce() å°†æ‰€æœ‰å…ƒç´ æ±‚å’Œç”Ÿæˆä¸€ä¸ªæ–°çš„å€¼ï¼š```JavaSystem.out.println(&quot;************ ä»¥ä¸‹ä¸ºLambda+Stream ä½¿ç”¨mapå¯¹numberListä¸­å¯¹å…ƒç´ è¿›è¡Œå¹³æ–¹è¿ç®—å å¹¶ç”¨reduceç”Ÿæˆæ–°çš„å€¼ ************&quot;);Integer newSum = numberList.stream().map(x -&gt; x * x).reduce((x, y) -&gt; x + y).get();System.out.println(&quot;newSum: &quot; + newSum); è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š12************ ä»¥ä¸‹ä¸ºLambda+Stream ä½¿ç”¨mapå¯¹numberListä¸­å¯¹å…ƒç´ è¿›è¡Œå¹³æ–¹è¿ç®—å å¹¶ç”¨reduceç”Ÿæˆæ–°çš„å€¼ ************newSum: 91 ä»¥ä¸Šåªæ˜¯ä»‹ç»äº†Lambda+Streamå¯¹é›†åˆæ“ä½œçš„ä¸€äº›ç®€å•çš„å…¥é—¨å®è·µï¼Œå¸Œæœ›èƒ½å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿå¸Œæœ›æˆ‘ä»¬èƒ½åœ¨åˆé€‚çš„åœ°æ–¹çµæ´»å¾—è¿ç”¨å®ƒä»¬ï½ å°±æ˜¯è¿™æ ·ï¼å¸Œæœ›ä½ å–œæ¬¢ï½]]></content>
      <tags>
        <tag>Lambda</tag>
        <tag>Stream</tag>
        <tag>é›†åˆ</tag>
        <tag>Java8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaä»Resourceä¸­è¯»å–.csvæ–‡ä»¶å¹¶è¿›è¡Œå¤„ç†]]></title>
    <url>%2F2018%2F10%2F24%2FreadResourceCSVFile%2F</url>
    <content type="text"><![CDATA[åŠŸèƒ½æ­£å¸¸çš„javaçš„mavenå·¥ç¨‹ä¸­éƒ½æœ‰ä¸€ä¸ªresourcesæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ç€ä¸€äº›èµ„æºæ–‡ä»¶ã€springå®¹å™¨å¯åŠ¨æ—¶çš„xmlæ–‡ä»¶ç­‰ã€‚å½“å°†ä¸€ä¸ª.csvæ–‡ä»¶æ”¾åˆ°resourcesæ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­åº”è¯¥æ€ä¹ˆè¯»å–å’Œå¤„ç†å‘¢ï¼Ÿ ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š1. æ ¹æ®Resourceæ–‡ä»¶æ‰€åœ¨çš„å®é™…Pathï¼Œç”¨ClassLoaderæ¥è·å–æ–‡ä»¶çš„è¾“å…¥æµinputStream2. ç”¨å­—ç¬¦ç¼“å†²è¾“å…¥æµBufferedReaderè¯»å–è¾“å…¥æµinputStream3. å¯¹æ–‡ä»¶æŒ‰è¡Œé¡ºåºè¯»å–å¹¶å¤„ç† ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public class InformationReadTest &#123; private static final String pathName = "information_list.csv"; private static List&lt;String&gt; readResourceFile() &#123; InputStream inputStream = null; List&lt;String&gt; fileList = new ArrayList&lt;&gt;(); try &#123; // æ ¹æ®Resourceæ–‡ä»¶æ‰€åœ¨çš„å®é™…Pathï¼Œç”¨ClassLoaderæ¥è·å–æ–‡ä»¶çš„è¾“å…¥æµ inputStream = InformationReadTest.class.getClassLoader().getResourceAsStream(pathName); // ç”¨å­—ç¬¦ç¼“å†²è¾“å…¥æµBufferedReaderè¯»å–inputStream BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream)); String line = null; // å¯¹æ–‡ä»¶æŒ‰è¡Œé¡ºåºè¯»å– while ((line = reader.readLine()) != null) &#123; fileList.add(line); &#125; &#125; catch (Exception e) &#123; System.out.println("fail! " + e); &#125; return fileList; &#125; private static String getInformation(String information) &#123; if (StringUtils.isEmpty(information)) &#123; System.out.println("input information is null!"); return null; &#125; String[] strings = information.split(","); if (strings.length != 7) &#123; System.out.println("input information format is illegal!"); return null; &#125; String result = "å§“åï¼š" + strings[0] + ", å¹´é¾„ï¼š" + strings[1] + ", èŒä¸šï¼š" + strings[2] + ", åœ°å€ï¼š" + strings[3] + ", çˆ±å¥½ï¼š" + strings[4] + ", å–å‘ï¼š" + strings[5] + ", å©šæ‹ï¼š" + strings[6]; return result; &#125; public static void main(String[] args) &#123; List&lt;String&gt; fileList = readResourceFile(); // ç”¨äº†ä¸€ä¸ªlamdaè¡¨è¾¾å¼æ¥å¾ªç¯å¤„ç†fileList fileList.stream().forEach(fileString -&gt; &#123; String result = getInformation(fileString); System.out.println(result); &#125;); &#125;&#125; è¿è¡Œç»“æœå¦‚ä¸‹ï¼š 123å§“åï¼šç‹å°æ˜, å¹´é¾„ï¼š17, èŒä¸šï¼šå­¦ç”Ÿ, åœ°å€ï¼šæµ™æ±Ÿçœæ­å·å¸‚, çˆ±å¥½ï¼šå¥èº«, å–å‘ï¼šç›´ç”·, å©šæ‹ï¼šæ²¡æœ‰å¥³æœ‹å‹Process finished with exit code 0 å·¥ç¨‹ç»“æ„å¦‚ä¸‹ï¼š P.S. mainæ–¹æ³•ä¸­ç”¨äº†ä¸€ä¸ªLambdaè¡¨è¾¾å¼ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨æ¥ä¸‹æ¥å¯¹åšå®¢ä¸­ä¼šè®²ä¸€è®²Lambdaè¡¨è¾¾å¼å¯¹ä¸€äº›ç”¨æ³•ï½ å–œæ¬¢ä½ å–œæ¬¢ï½]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Resource</tag>
        <tag>csv</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡HttpServletResponseå®ç°æµè§ˆå™¨æ–‡ä»¶ä¸‹è½½åŠå‘ç‚¹ä»‹ç»]]></title>
    <url>%2F2018%2F10%2F20%2FhttpServletResponseDownloadFile%2F</url>
    <content type="text"><![CDATA[åŠŸèƒ½æœ€è¿‘åœ¨åšä¸€ä¸ªéœ€æ±‚â€”â€”â€”â€”é€šè¿‡ä¸€ä¸ªControllerå°†ç›¸å…³æ•°æ®è½¬æˆcsvæ–‡ä»¶åç›´æ¥è®©æµè§ˆå™¨ä¸‹è½½ã€‚æ€è·¯å‘¢ï¼Œæ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦çš„æµç¨‹å¦‚ä¸‹ï¼š1. è®¾ç½®å“åº”çš„ContentTypeç±»å‹2. è®¾ç½®å“åº”å¤´3. é€šè¿‡httpServletResponseè·å–ServletOutputStreamå¯¹è±¡4. å°†éœ€è¦çš„æ•°æ®å†™åˆ°è¾“å‡ºæµä¸­ è¿™é‡Œç»™å‡ºç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334/** * ä¸‹è½½æ•°æ® */ @RequestMapping("/downloadCSVFile") public void downloadCSVFile(HttpServletResponse httpServletResponse) &#123; try &#123; // è®¾ç½®ContentType httpServletResponse.setContentType("application/x-download;charset=utf-8"); // è®¾ç½®æ–‡ä»¶åï¼Œå¹¶æŒ‡å®šç¼–ç æ ¼å¼ String fileName = URLEncoder.encode("download_records_" + System.currentTimeMillis() / 1000 +".csv", "UTF-8"); httpServletResponse.setCharacterEncoding("UTF-8"); // å°†æ–‡ä»¶åaddHeader httpServletResponse.setHeader("content-disposition", "attachment;filename=" + fileName); String message = "test"; InputStream stream = new ByteArrayInputStream(message.getBytes("UTF-8")); OutputStream out = httpServletResponse.getOutputStream(); byte buff[] = new byte[1024]; int len = 0; while ((len = stream.read(buff)) &gt; 0) &#123; out.write(buff, 0, len); &#125; out.flush(); out.close(); stream.close(); &#125; catch (Exception e) &#123; logger.error("download output error!", e); &#125; &#125; ä»£ç å¾ˆç®€å•ï¼Œé¦–å…ˆæˆ‘ä»¬è®¾ç½®äº†httpServletResponseçš„ContentTypeä¸ºapplication/x-downloadï¼Œç”¨äºè¡¨é¢æˆ‘ä»¬è¦ä¼ è¾“åº”ç”¨ç¨‹åºæ•°æ®æˆ–è€…äºŒè¿›åˆ¶æ•°æ®ã€‚éšåè®¾ç½®responseçš„å¤´ä¸ºcontent-dispositionã€‚content-dispositionç”¨æ¥å¯¹æŠ¥æ–‡ä½“è¿›è¡Œæè¿°ï¼Œè§„å®šäº†å®¢æˆ·ç«¯çš„æ˜¾ç¤ºå¤„ç†è¡Œä¸ºï¼›æœ‰ä¸¤ç§å–å€¼ï¼šattachmentå’Œinlineï¼Œåˆ†åˆ«è¡¨ç¤ºä¿å­˜å’Œç›´æ¥æ˜¾ç¤ºã€‚å¹¶ä¸”æˆ‘ä»¬è®¾ç½®äº†æ–‡ä»¶ååŠä¿å­˜çš„æ ¼å¼ç„¶åå°†æˆ‘ä»¬éœ€è¦çš„æ•°æ®é€šè¿‡å†™å…¥httpServletResponseä¸­å®Œæˆæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½ã€‚ å½“æˆ‘ä»¬éƒ¨ç½²å¥½ä»¥åï¼Œè®¿é—®controllerçš„åŸŸåå³å¯å®Œæˆä¸‹è½½ã€‚ å¥½äº†ï¼Œæˆ‘çŸ¥é“è¿™ä¹ˆå°è¯•çš„åŒå­¦éƒ½èƒ½é¡ºåˆ©æˆåŠŸçš„ã€‚ é‚£ä¹ˆæˆ‘æƒ³è¯´çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿé—®é¢˜æ˜¯å½“é€šè¿‡å‰ç«¯çš„é¡µé¢è¿›è¡Œä¸‹è½½æ—¶ä¸ä¼šå‡ºç°æ–‡ä»¶ä¸‹è½½ï¼Œåªä¼šåœ¨å‰ç«¯çš„responseä¸­æ˜¾ç¤ºæˆ‘ä¼ è¾“çš„å†…å®¹ï¼›è€Œç›´æ¥é€šè¿‡ç½‘é¡µè®¿é—®é¡µé¢æ˜¯å¯ä»¥æ­£å¸¸ä¸‹è½½çš„ï¼ é—®é¢˜çš„åŸå› ä¸è§£å†³æ–¹æ¡ˆåŸå› ä¸€å¼€å§‹æ‰¾åŸå› æ˜¯æå…¶éš¾çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ ¹æœ¬ä¸çŸ¥é“å‰ç«¯å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚åæ¥åœ¨ä¸€ç¯‡æ–‡ç« ä¸­ï¼ˆJavascript/jqueryé€šè¿‡POSTç”¨JSONæ•°æ®ä¸‹è½½æ–‡ä»¶ï¼‰æ¨æµ‹äº†åŸå› ï¼šå‰ç«¯åœ¨è¯·æ±‚æ—¶å€Ÿç”¨äº†ajaxæ¥è¿›è¡Œã€‚ä½†æ˜¯ajaxæ˜¯ä¸ç›´æ¥æ”¯æŒä¸‹è½½æ–‡ä»¶çš„ï¼Œæ¢è€Œè¨€ä¹‹ï¼Œä¸èƒ½ç›´æ¥é€šè¿‡å‘httpServletResponseå†™æ–‡ä»¶æµå¹¶é€šè¿‡ajaxä¸‹è½½ï¼ajaxæ”¯æŒçš„dataTypeåªæœ‰å¦‚ä¸‹å‡ ç§:ï¼šxmlã€htmlã€scriptã€jsonã€jsonpå’Œtextã€‚æœ‰äº†å¦‚ä¸‹æ¨æµ‹ï¼Œç›´æ¥è”ç³»å‰ç«¯åŒå­¦ï¼Œé—®å¥¹ï¼ˆå¯¹çš„ï¼Œæ˜¯ä¸ªå¦¹å­å‘¢ï¼Œå‰ç«¯å°±æ˜¯å¦¹å­å¤šï¼‰æ˜¯ä¸æ˜¯ç”¨äº†ajaxï¼Œä¸€è´´ä»£ç ï¼Œæœç„¶å¦‚æ­¤ï½ è§£å†³æ–¹æ¡ˆè®©å‰ç«¯ä¸è¦é€šè¿‡ajaxè¯·æ±‚å°±å¥½äº†ï½so easyï½ okï¼doneï¼]]></content>
      <tags>
        <tag>HttpServletResponse</tag>
        <tag>æ–‡ä»¶</tag>
        <tag>ä¸‹è½½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é€šè¿‡Apacheçš„Httpæ¡†æ¶ä»¥"application/x-www-form-urlencoded"å½¢å¼postæ•°æ®çš„ä¸¤ç§æ–¹å¼]]></title>
    <url>%2F2018%2F10%2F13%2FhttpPostDataTranser%2F</url>
    <content type="text"><![CDATA[ç®€ä»‹æœ€è¿‘ä¸ç¬¬ä¸‰æ–¹å…¬å¸ä½œä¸šåŠ¡å¯¹æ¥æ—¶ï¼Œéœ€è¦æˆ‘æ–¹å°†æ•°æ®é€šè¿‡httpè¯·æ±‚çš„æ–¹å¼ä¼ è¾“åˆ°å¯¹æ–¹æ¥å£ï¼Œæˆ‘æ–¹ä¸€ç›´é€šè¿‡å°†å¯¹åº”çš„æ•°æ®å¯¹è±¡ä»¥â€œjsonâ€çš„æ ¼å¼æ”¾åœ¨httpè¯·æ±‚ä½“ä¸­ã€‚è”è°ƒåå¯¹æ–¹è¡¨ç¤ºä¸€ç›´è¯»ä¸åˆ°æ•°æ®ã€‚ç»è¿‡å¾ˆå¤šæ–¹å¼çš„æ¢ç´¢åå‘ç°ï¼Œå¯¹é¢æ˜¯ç”¨â€œkey-valueâ€çš„æ–¹å¼åœ¨è¯»å–æ•°æ®ï¼Œæ€ªä¸å¾—æ‹¿ä¸åˆ°æ•°æ®ï¼å› ä¸ºæˆ‘ä»¬çš„httpè¯·æ±‚éƒ½æ˜¯é€šè¿‡Apacheçš„Httpæ¡†æ¶æ¥å»ºç«‹çš„ï¼Œæ¥ä¸‹é‡Œæˆ‘å°±ç®€å•ä»‹ç»ä¸‹é€šè¿‡Apacheçš„Httpæ¡†æ¶ï¼Œä»¥â€application/x-www-form-urlencodedâ€å½¢å¼postæ•°æ®çš„ä¸¤ç§æ–¹å¼ã€‚ è¿™é‡Œç»™å‡ºç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š ä¸¤ç§æ–¹æ¡ˆ1. æ•°æ®ä»¥â€jsonâ€æ ¼å¼ä¼ è¾“ä»£ç å¦‚ä¸‹ï¼š 123456// å»ºç«‹HttpPostå¯¹è±¡HttpPost postReq = new HttpPost(url);// è®¾ç½®é€šè¿‡contentTypeå’Œè¯·æ±‚æ•°æ®æ¥å»ºç«‹è¯·æ±‚ä½“StringEntity entity = new StringEntity(data, ContentType.create("application/x-www-form-urlencoded", characterSet));postReq.setEntity(entity);// ä»¥ä¸‹ä¸ºhttpè¯·æ±‚çš„å…¶ä»–é…ç½®è®¾ç½®ç­‰ 2. æ•°æ®ä»¥â€key-valueâ€å½¢å¼ä¼ è¾“é”®å€¼å¯¹çš„å­˜æ”¾éœ€è¦é€šè¿‡BasicNameValuePairå¯¹è±¡æ¥å®ç° ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314// å»ºç«‹HttpPostå¯¹è±¡HttpPost postReq = new HttpPost(url);// å»ºç«‹ä¸€ä¸ªmapæ¥å­˜æ”¾"key-value"å¯¹Map&lt;String,String&gt; parameters =JSON.parseObject(data, Map.class);// æ–°å»ºNameValuePairåˆ—è¡¨ï¼Œç”¨æ¥å­˜æ”¾é”®å€¼å¯¹List&lt;NameValuePair&gt; NameValuePairList = new ArrayList&lt;NameValuePair&gt;();for (String key : parameters.keySet()) &#123; NameValuePairList(new BasicNameValuePair(key, parameters.get(key)));&#125;// é€šè¿‡UrlEncodedFormEntityå°†NameValuePairListè¿›è¡Œæ ¼å¼åŒ–åæ”¾å…¥è¯·æ±‚ä½“ä¸­postReq.setEntity(new UrlEncodedFormEntity(NameValuePairList, characterSet));// è®¾ç½®contentTypepostReq.setHeader("Content-Type", "application/x-www-form-urlencoded");// ä»¥ä¸‹ä¸ºhttpè¯·æ±‚çš„å…¶ä»–é…ç½®è®¾ç½®ç­‰ okï¼doneï¼]]></content>
      <tags>
        <tag>Apache</tag>
        <tag>Http</tag>
        <tag>post</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java Arraylist addæ–¹æ³•çš„java.lang.UnsupportedOperationExceptionå¼‚å¸¸]]></title>
    <url>%2F2018%2F10%2F01%2FArraysException%2F</url>
    <content type="text"><![CDATA[é—®é¢˜æœ€è¿‘åœ¨å¯¹listè¿›è¡Œcodeçš„æ—¶å€™æŠ›å‡ºäº†java.lang.UnsupportedOperationExceptionå¼‚å¸¸ï¼Œä¸”çœ‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031public class BlogCaseTest &#123; private static Map&lt;String, List&lt;String&gt;&gt; cityMap = new HashMap&lt;&gt;(); public static void main(String[] args) &#123; String[] provinceString = &#123;"zhejiang", "zhejiang", "shanghai", "sichuan"&#125;; String[] cityString = &#123;"hangzhou", "jiaxing", "shanghai", "chengdu"&#125;; for (int i = 0; i &lt; provinceString.length; i++) &#123; cityMapInitialize(provinceString[i], cityString[i]); &#125; &#125; private static void cityMapInitialize(String province, String city) &#123; if (StringUtils.isEmpty(province) || StringUtils.isEmpty(city)) &#123; System.out.println("illegal input province or city"); return; &#125; try &#123; if (!CollectionUtils.isEmpty(cityMap.get(province))) &#123; List&lt;String&gt; cityList = cityMap.get(province); cityList.add(city); &#125; else &#123; List&lt;String&gt; cityList = Arrays.asList(city); cityMap.put(province, cityList); &#125; System.out.println("province: " + province + " city: " + city); &#125; catch (Exception e) &#123; System.out.println("province: " + province + " city: " + city + " cityMapInitialize exception! " + e); &#125; &#125;&#125; ä»£ç å¾ˆç®€å•ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªcityMapç”¨æ¥å­˜å‚¨â€œçœä»½-åŸå¸‚â€çš„æ˜ å°„ï¼ŒcityMapInitializeæ–¹æ³•ç”¨æ¥å¯¹cityMapè¿›è¡Œåˆå§‹åŒ–æˆ–è€…è¯´èµ‹å€¼ï¼Œæ‰§è¡Œmainå‡½æ•°åï¼Œæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š 1234province: zhejiang city: hangzhouprovince: zhejiang city: jiaxing cityMapInitialize exception! java.lang.UnsupportedOperationExceptionprovince: shanghai city: shanghaiprovince: sichuan city: chengdu å¯ä»¥çœ‹åˆ°å½“æ‰§è¡Œåˆ°â€œzhejiang-jiaxingâ€çš„æ—¶å€™ï¼ŒæŠ›å‡ºäº†å¼‚å¸¸ åŸå› ä¸è§£å†³æ–¹æ¡ˆåŸå› åŸå› å¾ˆç®€å•ï¼Œè¯·çœ‹ç¬¬19-25è¡Œä»£ç ï¼š1234567if (!CollectionUtils.isEmpty(cityMap.get(province))) &#123; List&lt;String&gt; cityList = cityMap.get(province); cityList.add(city); &#125; else &#123; List&lt;String&gt; cityList = Arrays.asList(city); cityMap.put(province, cityList); &#125; å½“cityMapä¸­æ²¡æœ‰å¯¹åº”çš„provinceæ—¶ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡Arrays.asListæ¥æ–°å»ºä¸€ä¸ªlistå¹¶putåˆ°cityMapä¸­ï¼Œè€Œå½“cityMapä¸­å·²ç»å­˜åœ¨æ­¤provinceçš„æ˜ å°„æ—¶ï¼Œå°±ä¼šå–å‡ºprovinceå¯¹åº”çš„listï¼Œå¹¶å°†æ­¤æ—¶çš„cityåŠ å…¥åˆ°listä¸­ã€‚é‚£ä¹ˆï¼Œé—®é¢˜å°±æ¥äº†â€”â€”â€”â€”é€šè¿‡Arrays.asListåˆ›å»ºçš„listæ˜¯å›ºå®šå¤§å°çš„ArrayListã€‚è¯·çœ‹Arraysä¸­asListçš„æºç ï¼š 12345678910111213141516171819202122/** * Returns a fixed-size list backed by the specified array. (Changes to * the returned list "write through" to the array.) This method acts * as bridge between array-based and collection-based APIs, in * combination with &#123;@link Collection#toArray&#125;. The returned list is * serializable and implements &#123;@link RandomAccess&#125;. * * &lt;p&gt;This method also provides a convenient way to create a fixed-size * list initialized to contain several elements: * &lt;pre&gt; * List&amp;lt;String&amp;gt; stooges = Arrays.asList("Larry", "Moe", "Curly"); * &lt;/pre&gt; * * @param &lt;T&gt; the class of the objects in the array * @param a the array by which the list will be backed * @return a list view of the specified array */ @SafeVarargs @SuppressWarnings("varargs") public static &lt;T&gt; List&lt;T&gt; asList(T... a) &#123; return new ArrayList&lt;&gt;(a); &#125; è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼Œåˆ›å»ºåˆå§‹çš„listæ—¶ï¼Œä¸è¦åˆ›å»ºå¦‚ä¸Šæ‰€è¿°çš„å›ºå®šå¤§å°çš„ArrayListã€‚å¦‚ä¸‹ï¼š 12345678if (!CollectionUtils.isEmpty(cityMap.get(province))) &#123; List&lt;String&gt; cityList = cityMap.get(province); cityList.add(city); &#125; else &#123; List&lt;String&gt; cityList = new ArrayList&lt;&gt;(); cityList.add(city); cityMap.put(province, cityList); &#125; okï¼doneï¼]]></content>
      <tags>
        <tag>Java</tag>
        <tag>å¼‚å¸¸</tag>
        <tag>List</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BASE64ç¼–ç ç»“æœå­˜åœ¨â€œæ¢è¡Œç¬¦â€åŠè§£å†³æ–¹æ¡ˆ]]></title>
    <url>%2F2018%2F09%2F18%2FBASE64encode%2F</url>
    <content type="text"><![CDATA[é—®é¢˜ä»Šå¤©ä¸ç¬¬ä¸‰æ–¹æœåŠ¡å™¨è¿›è¡Œhttpè¯·æ±‚äº¤äº’æ—¶ï¼Œå‘ç°ä¼ å…¥çš„signatureä¸æœåŠ¡å™¨signatureå¯¹ä¸ä¸Šå¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚åå‘ç°æ˜¯åœ¨è°ƒç”¨sun.miscåŒ…ä¸‹çš„BASE64Encoder().encode()æ–¹æ³•å¯¹å­—ç¬¦ä¸²â€œcontentâ€è¿›è¡Œç¼–ç æ—¶ï¼Œç¼–ç ç»“æœä¸æœåŠ¡å™¨çš„æ ‡å‡†å€¼å¯¹ä¸ä¸Šã€‚è°ƒè¯•åå‘ç°æœ¬åœ°ç¼–ç ç»“æœä¸­è«åå…¶å¦™æ··å…¥äº†å¾ˆå¤šâ€œæ¢è¡Œç¬¦â€ï¼ˆ\tï¼‰ï¼š 12345671iIiwiU2VuZGVyQWRkcmVzcyI6Iua1i+ivleWcsOWdgCIsIlNlbmRlck5hbWUiOiLlvKDkuIkiLCJSZWNlaXZlclByb3ZpbmNlIjoi5rGf6IuPIiwiU291cmNlSWQiOiIxMjM0NTYiLCJTZW5kZXJEaXN0cmljdCI6Iuemj+eUsOWMuiIsIlJlY2VpdmVyTW9iaWxlIjoiMTUyOTk5OTk5OTkiLCJTZW5kZXJQcm92aW5jZSI6IuW5v+S4nCIsIlJlY2VpdmVyRGlzdHJpY3QiOiLlp5Hoi4/ljLoiLCJSZWNlaXZlckNpdHkiOiLoi4/lt57luIIiLCJSZWNlaXZlck5hbWUiOiLlvKDkuIkiLCJTZW5kZXJNb2JpbGUiOiIxNTE4ODg4ODg4OCIsIlNlbmRlckNpdHkiOiLmt7HlnLPluIIifQ== åŸå› ä¸è§£å†³æ–¹æ¡ˆåŸå› æŸ¥è¯¢äº†å‘ç°åœ¨RFC2045ä¸­æœ‰è¿™ä¹ˆä¸€æ®µè§„å®šï¼š 1REQUIRES that encoded lines be no more than 76 characters long. If longer lines are to be encoded with the Quoted-Printable encoding, &quot;soft&quot; line breaks æ„æ€å°±æ˜¯ï¼šBASE64ä¸€è¡Œä¸èƒ½è¶…è¿‡76å­—ç¬¦ï¼Œè¶…è¿‡å°±ä¼šæ·»åŠ å›è½¦æ¢è¡Œç¬¦ã€‚åŸå› å°±æ˜¯è¿™æ ·ï¼Œä¸‹é¢ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚ è§£å†³æ–¹æ¡ˆå¯ä»¥é€šè¿‡åœ¨BASE64ç¼–ç çš„ç»“æœååŠ ä¸Š .replaceAll(â€œ\r|\nâ€, â€œâ€) è§£å†³ okï¼doneï¼]]></content>
      <tags>
        <tag>BASE64</tag>
        <tag>ç¼–ç </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springä¸­åŠ è½½é…ç½®æ–‡ä»¶çš„ä¸¤ç§æ–¹å¼]]></title>
    <url>%2F2018%2F09%2F08%2FspringLoadProperties%2F</url>
    <content type="text"><![CDATA[å‰è¨€åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ç»å¸¸ä¼šæ ¹æ®ä¸åŒçš„ç¯å¢ƒï¼ˆdev,pre,onlineï¼‰æ¥é…ç½®ä¸åŒçš„ç±»æˆ–å±æ€§ï¼Œæ¯”å¦‚è¯´æ ¹æ®ä¸åŒçš„ç¯å¢ƒé…ç½®ä¸åŒçš„zookeeperæˆ–è€…æ•°æ®åº“datasourceã€‚æœ€ç®€å•çš„æ— éå°±æ˜¯å¼€å‘äººå‘˜æ ¹æ®ä¸åŒçš„ç¯å¢ƒäººè‚‰å»ä¿®æ”¹å¯¹åº”çš„é…ç½®ï¼Œè¿™ç§æ–¹å¼ç®€å•ä½†å´è´¹æ—¶ï¼Œä¸”å¾ˆå®¹æ˜“å‡ºé”™ï¼šæå…¶å®¹æ˜“å‡ºç°é…ç½®å†™é”™æˆ–è€…å¿˜è®°ä¿®æ”¹å¯¹åº”ç¯å¢ƒé…ç½®çš„æƒ…å†µã€‚å¯¹äºè¦è§£æ”¾åŒæ‰‹çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™æ— ç–‘æ˜¯ä¸€ç§å¾ˆlowåˆå¾ˆä½æ•ˆçš„æ–¹å¼ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨springè¯»å–ä¸åŒçš„ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼ˆæ¯”å¦‚è¯´zookeeper.propertiesï¼‰ï¼Œç„¶åç”¨mavençš„å¤šç¯å¢ƒæ‰“åŒ…çš„æ–¹æ³•å°±å¯å°†å¯¹åº”ç¯å¢ƒçš„å±æ€§æ³¨å…¥ã€‚é…ç½®æ–‡ä»¶çš„å­˜åœ¨è§£å†³äº†å¾ˆå¤§ä¸€ä»½é‡å¤çš„å·¥ä½œï¼Œå¹¶ä¸”ä¹Ÿæ–¹ä¾¿äº†æˆ‘ä»¬ç»Ÿä¸€ç®¡ç†é…ç½®ã€‚ I. ä»‹ç»ä¸¤ç§è¯»å–é…ç½®æ–‡ä»¶çš„æ–¹æ³•é‚£ä¹ˆé¦–å…ˆè¦è§£å†³çš„é€šè¿‡springæ¥è¯»å–é…ç½®æ–‡ä»¶ã€‚ä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä»¥æ¥è¯»å–é…ç½®æ–‡ä»¶ï¼š1. é€šè¿‡xmlæ³¨å…¥2. é€šè¿‡@Valueæ³¨è§£æ³¨å…¥ 1. é€šè¿‡xmlæ³¨å…¥é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªUserç±»ï¼š 1234567@Data@ToStringpublic class User &#123; private String name; private String city; private String phone;&#125; @Dataå’Œ@ToStringæ˜¯lombokçš„æ³¨è§£ï¼Œæ˜¯ä¸ºäº†çœå»å†™getterï¼ŒsetteråŠtoStringæ–¹æ³•çš„ç¥å™¨ï¼Œå½“ç„¶è¿˜æœ‰å¾ˆå¤šäººè®¤ä¸ºlombokçš„æ³¨è§£æ˜¯é‚ªæ•™- -ï¼Œå¥½å§ï¼Œè¿™ä¸æ˜¯å’±ä»¬ä»Šå¤©è¦è¯´çš„é‡ç‚¹ å¯ä»¥çœ‹åˆ°Userç±»ä¸­å­˜åœ¨ä¸‰ä¸ªç§æœ‰å˜é‡ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯é€šè¿‡èµ„æºæ–‡ä»¶ä¸­çš„é…ç½®æ¥æ³¨å…¥åˆ°è¿™ä¸‰ä¸ªå˜é‡ä¸­ é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥å»ºç«‹ä¸€ä¸ªèµ„æºæ–‡ä»¶â€”â€”user.propertiesï¼Œå†…å®¹å¦‚ä¸‹ï¼š 1234#useruser.name = $&#123;test.user.name&#125;user.city = $&#123;test.user.city&#125;user.phone = $&#123;test.user.phone&#125; å…¶ä¸­ï¼Œ${test.user.name}ã€${test.user.city}ã€${test.user.phone}åˆ†åˆ«å¯¹åº”ç¯å¢ƒèµ„æºæ–‡ä»¶ä¸­çš„å±æ€§ã€‚å› ä¸ºå®é™…é¡¹ç›®å¼€å‘ä¸­éœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒæ‰“åŒ…ä¸åŒçš„ç¯å¢ƒèµ„æºæ–‡ä»¶ï¼Œå› æ­¤ä¸åŒçš„ç¯å¢ƒéƒ½ä¼šå¯¹åº”ä¸€ä»½ç¯å¢ƒèµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚dev_config.propertieså¯¹åº”çº¿ä¸‹å¼€å‘ç¯å¢ƒï¼Œpre_config.propertieså¯¹åº”é¢„å‘ç¯å¢ƒï¼Œonline_config.propertieså¯¹åº”çº¿ä¸Šæ­£å¼ç¯å¢ƒã€‚ä»¥ä¸‹æˆ‘ä»¬ç»™å‡ºçº¿ä¸‹ç¯å¢ƒçš„èµ„æºæ–‡ä»¶ï¼ˆdev_config.propertiesï¼‰é…ç½®ï¼š 1234#usertest.user.name = Olivetest.user.city = hangzhoutest.user.phone = 16668815388 ä¸ºäº†è®©springå¯ä»¥æ³¨å…¥propertiesæ–‡ä»¶ä¸­çš„é…ç½®ï¼Œé¦–å…ˆéœ€è¦åœ¨xmlä¸­é…ç½®æ‰«æåŒ…ä¸‹çš„javaæ–‡ä»¶ï¼š 1&lt;context:component-scan base-package="com.xxx.xxx.service"/&gt; ç„¶åéœ€è¦åœ¨springçš„xmlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªç±»çš„å®ä¾‹ï¼Œè¿™ä¸¤ä¸ªç±»ç”¨æ¥åŠ è½½prpertiesæ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªç±»çœŸçš„å¾ˆé‡è¦ï¼å·²ç»é‡åˆ°æ— æ•°èµ·å› ä¸ºæ²¡æœ‰é…ç½®è¿™ä¿©ç±»å¯¼è‡´çš„å¤§å‘ï¼š 12org.springframework.beans.factory.config.PropertiesFactoryBeanorg.springframework.beans.factory.config.PreferencesPlaceholderConfigurer é…ç½®å¦‚ä¸‹ï¼š 1234567891011&lt;bean id="configProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean"&gt; &lt;property name="locations"&gt; &lt;list&gt; &lt;value&gt;classpath*:message.properties&lt;/value&gt; &lt;value&gt;classpath*:user.properties&lt;/value&gt; &lt;/list&gt; &lt;/property&gt;&lt;/bean&gt;&lt;bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PreferencesPlaceholderConfigurer"&gt; &lt;property name="properties" ref="configProperties" /&gt;&lt;/bean&gt; listæ ‡ç­¾çš„valueå†™æ˜äº†è¦æ‰«æçš„propertiesæ–‡ä»¶çš„åå­—ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æš´åŠ›åœ°æ‰«ææ‰€æœ‰propertiesæ–‡ä»¶ï¼š 1&lt;value&gt;classpath*:*.properties&lt;/value&gt; æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ³¨å†ŒUserçš„beanï¼Œç„¶åå°†å¯¹åº”å±æ€§æ³¨å…¥åˆ°ç±»çš„ç§æœ‰åŸŸä¸­ï¼š 12345&lt;bean id="user" class="com.mogujie.trade.third.service.sync.User"&gt; &lt;property name="name" value="$&#123;user.name&#125;"/&gt; &lt;property name="city" value="$&#123;user.city&#125;"/&gt; &lt;property name="phone" value="$&#123;user.phone&#125;"/&gt;&lt;/bean&gt; ç„¶åæˆ‘ä»¬å†™ä¸ªå•æµ‹è·‘ä¸€è·‘ï¼š 1234567891011@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(&#123;"classpath*:spring-biz.xml"&#125;)public class UserTest &#123; @Autowired private User user; @Test public void testUserProperties() &#123; System.out.println("System out: " + user.toString()); &#125;&#125; çœ‹ä¸‹ç»“æœï¼š 1System out: User(name=Olive, city=hangzhou, phone=16668815388) okï¼doneï¼ 2. @Valueæ³¨è§£è¦ä½¿ç”¨@Valueæ³¨è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè¦å¯¹Userç±»åšå‡ºä¿®æ”¹ï¼Œå› ä¸ºä¹‹å‰æ˜¯é€šè¿‡xmlæ³¨å†Œuser beanï¼Œç°åœ¨åˆ™éœ€è¦æ˜¾å¼åœ°ç”¨@Serviceä¿®é¥°Userç±»ï¼Œå¹¶ä¸”ç»™Userç±»çš„ç§æœ‰åŸŸéƒ½åŠ ä¸Š@Valueæ³¨è§£ï¼ˆæ­¤æ—¶å°±ä¸ç”¨é€šè¿‡xmlæ¥æ³¨å†Œuser beanï¼‰ï¼š 1234567891011@Service("user")@Data@ToStringpublic class User &#123; @Value("$&#123;user.name&#125;") private String name; @Value("#&#123;configProperties['user.city']&#125;") private String city; @Value("$&#123;user.phone&#125;") private Long phone;&#125; é‡æ–°è·‘ä¸‹å•æµ‹ï¼ŒæˆåŠŸäº†ï½ç»“æœå’Œä¸Šé¢ä¸€æ ·çš„ï¼Œå°±ä¸è´´å‡ºæ¥äº† å¦å¤–ï¼Œ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨cityä¸Šçš„@Valueæ³¨è§£ç”¨çš„æ˜¯â€#{}â€ï¼Œäº†è§£@Valueæ³¨è§£çš„åŒå­¦å¯èƒ½çŸ¥é“æœ‰ä¸¤ç§è®¾ç½®å±æ€§å€¼çš„æ–¹æ³•ï¼š@Value(â€œ#{}â€)ä¸@Value(â€œ${}â€)ã€‚é‚£ä¹ˆè¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ 2.1 @Value(â€œ#{}â€) SpELè¡¨è¾¾å¼@Value(â€œ#{}â€) è¡¨ç¤ºSpElè¡¨è¾¾å¼é€šå¸¸ç”¨æ¥è·å–beançš„å±æ€§ï¼Œæˆ–è€…è°ƒç”¨beançš„æŸä¸ªæ–¹æ³•ã€‚å½“ç„¶è¿˜æœ‰å¯ä»¥è¡¨ç¤ºå¸¸é‡ã€‚@Value(â€œ#{configProperties[â€˜user.cityâ€™]}â€)æ³¨è§£ä¸­æœ‰configPropertiesï¼ŒæŒ‡çš„æ˜¯é…ç½®æ–‡ä»¶çš„åŠ è½½å¯¹è±¡ï¼Œå³æˆ‘ä»¬æœ€å¼€å§‹å¼ºè°ƒçš„è¦åœ¨xmlä¸­æ³¨å†Œçš„configProperties bean 2.2 @Value(â€œ${t1.msgname}â€)è¿™ç§å½¢å¼ä¸éœ€è¦æŒ‡å®šå…·ä½“åŠ è½½å¯¹è±¡ï¼Œè¿™æ—¶å€™éœ€è¦å®ä¾‹åŒ–PreferencesPlaceholderConfigurerç±»å¯¹è±¡ã€‚æ­¤å¯¹è±¡é…ç½®å¯ä»¥å¯ä»¥ç›´æ¥å¤ç”¨configPropertieså¯¹è±¡ä¸­çš„é…ç½®ï¼Œä¹Ÿå¯ä»¥è‡ªå®šé…ç½®æ–‡ä»¶è·¯å¾„ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±æ³¨å†Œäº†è¿™ä¸ªbeanã€‚ æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥éªŒè¯ä¸€ä¸‹ä¸Šé¢ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼ˆæˆ‘å½“ç„¶éªŒè¯è¿‡äº†å’¯:Dï¼‰ doneï¼ II. ç›¸å…³åšå®¢æ¨è[1]. Springæ³¨å…¥å€¼ï¼ˆValueæ³¨è§£ï¼‰[2]. spring(åŸºç¡€10) æ³¨è§£@Valueè¯¦è§£]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Spring</tag>
        <tag>é…ç½®æ–‡ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆä¸‰ï¼‰â€”â€”ç´¢å¼•è®¾è®¡æ¦‚è¿°]]></title>
    <url>%2F2018%2F09%2F04%2FsqlIndexAndQueryOptimize-3%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢ç»ˆäºå†™åˆ°è¿™ä¸ªç³»åˆ—æœ€åä¸€ç¯‡æ–‡ç« äº†ï¼Œå‰ä¸¤ç¯‡ç¬¬ä¸€ç¯‡é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æäº†sqlè¯­å¥ï¼Œç¬¬äºŒç¯‡è®²è¿°äº†ç´¢å¼•ç­‰æ¦‚å¿µã€ç±»å‹ï¼Œå¹¶ä¸”è®²è¿°äº†å¦‚ä½•é€šè¿‡explainæŒ‡ä»¤æ¥å¯¹sqlè¿›è¡Œåˆ†æï¼Œæœ€åä¹Ÿç»™å‡ºäº†ä¸€äº›æŸ¥è¯¢å®ä¾‹ã€‚ä»Šå¤©ç¬¬ä¸‰ç¯‡ï¼Œä¸»è¦ä¼šè®²ä¸‹mysqlä¸­ç´¢å¼•çš„æ™®é€‚æ€§è®¾è®¡æ–¹æ¡ˆï¼ˆæ¯”å¦‚ä¸‰æ˜Ÿç´¢å¼•ç­‰æ¦‚å¿µåŠè®¾è®¡æ€è·¯ï¼‰ä»¥åŠè¯„åˆ¤ç´¢å¼•æ€§èƒ½çš„ä¸¤ç§æ–¹æ³•ã€‚ â… . åŸºæœ¬æ¦‚å¿µä¸å‡è®¾1. å¯¹dbè¡¨çš„è¯»å–ï¼š ä»ç£ç›˜ä¸­è¿›è¡Œä¸€æ¬¡éšæœºI/Oï¼Œå³å°†ä¸€ä¸ªé¡µä»ç£ç›˜ä¸­è¯»å–è‡³æ•°æ®åº“ç¼“å†²æ± ï¼šå¤§çº¦10ms ä»ç£ç›˜æœåŠ¡å™¨çš„ç¼“å­˜ä¸­è¿›è¡Œè¯»å–ï¼Œå½“dbmséœ€è¦çš„é¡µä¸åœ¨æ•°æ®åº“ç¼“å†²æ± ä¸­ï¼Œä¼šå‘ç£ç›˜æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨é¦–å…ˆå›å»æŸ¥è¯¢æ­¤é¡µæ˜¯å¦åœ¨ç¼“å†²åŒºä¸­ï¼Œè‹¥åœ¨ç¼“å†²åŒºä¸­ï¼Œè¯»å–çš„æ—¶é—´å°†å¤§å¹…é™ä½ï¼š1ms å¯¹ç£ç›˜è¿›è¡Œé¡ºåºè¯»å–ï¼Œä¸Šé¢è¯´çš„éƒ½æ˜¯å°†ä¸€ä¸ªè¡¨é¡µè¯»å–åˆ°ç¼“å†²æ± çš„æƒ…å†µï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šéœ€è¦è¯»å–å¤šä¸ªé¡µåˆ°ç¼“å†²æ± ä¸­ï¼Œç„¶åè¿›è¡Œé¡ºåºå¤„ç†ï¼ŒåŒæ—¶è¯»å–å¤šä¸ªé¡µå°†å‡å°‘æ¯ä¸ªé¡µè¢«å¹³å‡è¯»å–çš„æ—¶é—´ï¼š0.1ms 2. è®¿é—®dbmsè¯»å–ä¸€ä¸ªç´¢å¼•è¡Œæˆ–ä¸€ä¸ªè¡¨è¡Œç§°ä¸ºä¸€æ¬¡è®¿é—®ï¼šç´¢å¼•è®¿é—®æˆ–è¡¨è®¿é—®ã€‚è‹¥dbmsæ‰«æç´¢å¼•æˆ–è¡¨çš„ä¸€ä¸ªç‰‡æ®µï¼ˆè¢«è¯»å–çš„è¡Œåœ¨ç‰©ç†ä¸Šç›¸é‚»ï¼‰ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è¯»å–ä¸ºéšæœºè®¿é—®ï¼ˆTRï¼‰ï¼Œåç»­è¡Œçš„è¯»å–ä¸ºé¡ºåºè®¿é—®ï¼ˆTSï¼‰ã€‚ 3. è°“è¯whereè¯­å¥ä¸­çš„æ¡ä»¶è¢«ç§°ä¸º è°“è¯ 4. ç´¢å¼•ç‰‡åŠåŒ¹é…åˆ—ç´¢å¼•ç‰‡æ˜¯sqlæŸ¥è¯¢åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰«æçš„ä¸€ä¸ªç´¢å¼•ç‰‡æ®µï¼Œåœ¨è¿™ä¸ªèŒƒå›´ä¸­çš„ç´¢å¼•å°†è¢«é¡ºåºæ‰«æï¼›ç´¢å¼•ç‰‡çš„åšåº¦æŒ‡ è°“è¯è¡¨è¾¾å¼ç¡®å®šçš„èŒƒå›´ï¼Œç´¢å¼•ç‰‡è¶Šçª„è¯´æ˜åŒ¹é…åˆ°çš„æ•°æ®è¡Œæ•°è¶Šå°‘ï¼Œé‚£ä¹ˆç´¢å¼•è®¿é—®åŠå¯¹è¡¨çš„è¯»å–çš„å¼€é”€è¶Šå°ã€‚å¦ä¸€ç§å¹¿æ³›æè¿°ç´¢å¼•ç‰‡çš„æ–¹æ³•æ˜¯å®šä¹‰ ç´¢å¼•åŒ¹é…åˆ—çš„æ•°é‡ã€‚ 5. ç´¢å¼•åŒ¹é…åˆ—å’Œè¿‡æ»¤åˆ—æœ‰äº›åˆ—å¯èƒ½åŒæ—¶å­˜åœ¨äºwhereå­å¥ä¸­ä¸ç´¢å¼•ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªåˆ—æ‰€åœ¨çš„ç´¢å¼•å´ä¸èƒ½ç”Ÿæ•ˆï¼ˆæ¯”å¦‚ä¹‹å‰æ‰€è¯´çš„ï¼Œwhereå­å¥ä¸­ç¢°åˆ°èŒƒå›´æŸ¥è¯¢ï¼Œå…¶åçš„ç´¢å¼•åˆ—å°†ä¸ç”Ÿæ•ˆï¼‰ï¼Œè¿™æ ·çš„åˆ—ç§°ä¸ºè¿‡æ»¤åˆ—ï¼Œå› ä¸ºé€šè¿‡ç´¢å¼•ä¸Šçš„è¿‡æ»¤åˆ—èƒ½å¤Ÿé¿å…å›è¡¨è®¿é—®ã€‚ä¸è¿‡æ»¤åˆ—ç›¸å¯¹çš„ï¼Œå¦‚æœwhereæ¡ä»¶ä¸­çš„ä¸€åˆ—åŒæ—¶åœ¨ç´¢å¼•ä¸­ï¼Œå¹¶ä¸”èƒ½å‚ä¸ç´¢å¼•çš„å®šä¹‰ï¼Œé‚£ä¹ˆè¿™åˆ—å°±æ˜¯åŒ¹é…åˆ—ã€‚ 6. è¿‡æ»¤å› å­å…¶æè¿°äº†è°“è¯çš„é€‰æ‹©æ€§ï¼Œå³æ»¡è¶³whereæ¡ä»¶çš„è®°å½•å æ‰€æœ‰è®°å½•æ€»æ•°çš„æ¯”ä¾‹ã€‚åœ¨è¯„ä»·ç´¢å¼•æ˜¯å¦åˆé€‚æ—¶ï¼Œè¿‡æ»¤å› å­å¾ˆé‡è¦ã€‚å¹¶ä¸”åœ¨å®é™…ä¸­ï¼Œä¸€èˆ¬è€ƒè™‘æœ€å·®æƒ…å†µä¸‹çš„è¿‡æ»¤å› å­ï¼Œè€Œä¸æ˜¯å¹³å‡è¿‡æ»¤å› å­ã€‚ â…¡. æœ€ä¼˜ç´¢å¼•æ¦‚å¿µåŠè®¾è®¡æ€è·¯1. ä¸‰æ˜Ÿç´¢å¼•ä¸‰æ˜Ÿç´¢å¼•æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œè¡¨ç¤ºå¯¹äºä¸€ä¸ªæŸ¥è¯¢æ¥è¯´æœ€ç†æƒ³çš„ç´¢å¼•ã€‚æ—¢ç„¶æ˜¯ä¸‰æ˜Ÿç´¢å¼•ï¼Œé‚£å¿…ç„¶æ˜¯æœ‰ä¸‰é¢—æ˜Ÿï¼Œé‚£ä¹ˆæ˜Ÿçº§å¦‚ä½•ç¡®å®šå‘¢ï¼Ÿå¦‚æœä¸ä¸€ä¸ªæŸ¥è¯¢ç›¸å…³çš„ç´¢å¼•è¡Œæ˜¯ç›¸é‚»çš„ï¼Œæˆ–è€…è‡³å°‘è¶³å¤Ÿé è¿‘çš„è¯ï¼Œé‚£è¿™ä¸ªç´¢å¼•å°±å¯ä»¥è¢«æ ‡è®°ä¸Šç¬¬ä¸€é¢—æ˜Ÿã€‚è¿™æœ€å°åŒ–äº†å¿…é¡»æ‰«æçš„ç´¢å¼•ç‰‡çš„å®½åº¦ï¼› å¦‚æœç´¢å¼•è¡Œçš„é¡ºåºä¸æŸ¥è¯¢è¯­å¥çš„éœ€æ±‚ä¸€è‡´ï¼Œåˆ™ç´¢å¼•å¯ä»¥è¢«æ ‡è®°ä¸Šç¬¬äºŒé¢—æ˜Ÿã€‚è¿™æ’é™¤äº†æ’åºæ“ä½œï¼› å¦‚æœç´¢å¼•è¡ŒåŒ…å«æŸ¥è¯¢è¯­å¥ä¸­çš„æ‰€æœ‰åˆ—â€”â€”é‚£ä¹ˆç´¢å¼•å°±å¯ä»¥è¢«æ ‡è®°ä¸Šç¬¬ä¸‰é¢—æ˜Ÿã€‚è¿™é¿å…äº†è®¿é—®è¡¨çš„æ“ä½œï¼Œä»…è®¿é—®ç´¢å¼•å°±å¯ä»¥äº†ã€‚ å¯¹äºè¿™ä¸‰é¢—æ˜Ÿï¼Œç¬¬ä¸‰é¢—é€šå¸¸æ˜¯æœ€é‡è¦çš„ï¼ˆå…¶å®è¿™é‡Œçš„è¯´æ˜å¾ˆç†è®ºä¹Ÿå¾ˆæ‹—å£ï¼Œä¸‹é¢ä¼šç»™å‡ºå…·ä½“ä¾‹å­æ¥è¯´æ˜ï¼‰ã€‚ 2. å®½ç´¢å¼•ä¸çª„ç´¢å¼•å®½ç´¢å¼•æ˜¯æŒ‡ä¸€ä¸ªè‡³å°‘æ»¡è¶³ç¬¬ä¸‰é¢—æ˜Ÿçš„ç´¢å¼•ï¼Œæ­¤ç´¢å¼•åŒ…å«äº†selectè¯­å¥æ‰€æ¶‰åŠçš„æ‰€æœ‰åˆ—ï¼Œå› æ­¤è¯¥æŸ¥è¯¢åªéœ€è®¿é—®ç´¢å¼•è€Œä¸å¿…å›è¡¨æŸ¥è¯¢ã€‚ 3. ä¸¾ä¸ªä¸‰æ˜Ÿç´¢å¼•è®¾è®¡çš„æ —å­ï¼šæ¯”å¦‚è¯´å¦‚ä¸‹çš„ä¸€æ¡sqlï¼š 1select sex from user where name=â€œjackâ€ and city=â€œhangzhouâ€ order by age ç¬¬ä¸€é¢—æ˜Ÿï¼šå–å‡ºæ‰€æœ‰ç­‰å€¼è°“è¯çš„åˆ—ï¼ˆå³whereæ¡ä»¶åçš„åˆ—ï¼šnameå’Œcityï¼‰ï¼Œå°†nameå’Œcityä½œä¸ºç´¢å¼•çš„å¼€å¤´ï¼Œå¹¶ä¸”ä¸è¦æ±‚ä¸¥æ ¼çš„é¡ºåºã€‚è¿™å¯ä»¥ä½¿ç´¢å¼•ç‰‡å®½åº¦ç¼©çŸ­è‡³æœ€çª„ ç¬¬äºŒé¢—æ˜Ÿï¼šå°†ç”¨æ¥æ’åºçš„åˆ—ï¼ˆoder by ageï¼‰åŠ å…¥åˆ°ç´¢å¼•ä¸­ã€‚é‚£ç°åœ¨ç´¢å¼•å°±å˜æˆï¼šname_city_age ç¬¬ä¸‰é¢—æ˜Ÿï¼šå°†æŸ¥è¯¢è¯­å¥å‰©ä½™çš„åˆ—åŠ åˆ°ç´¢å¼•ä¸­å»ï¼Œåˆ—åœ¨ç´¢å¼•ä¸­çš„é¡ºåºå¯¹æŸ¥è¯¢æ€§èƒ½æ— å½±å“ã€‚æ­¤æ—¶ç´¢å¼•å°†å˜æˆname_city_age_sexï¼Œè¿™ä¸ªç´¢å¼•å°±æ˜¯ä¸‰æ˜Ÿç´¢å¼• 4. ç´¢å¼•æ˜Ÿçº§çš„é€‰æ‹©èƒ½è®¾è®¡å‡ºä¸‰æ˜Ÿç´¢å¼•ï¼Œæ— ç–‘æ˜¯æœ€å¥½çš„æƒ…å†µï¼ˆä¸è€ƒè™‘å­˜å‚¨ç´¢å¼•ç­‰çš„å¼€é”€ï¼‰ï¼Œä½†åœ¨å¾ˆå¤šå®é™…æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•è®¾è®¡å‡ºç†æƒ³çš„ä¸‰æ˜Ÿç´¢å¼•çš„ã€‚æ¢å¥è¯è¯´ï¼Œå¯¹äºç´¢å¼•çš„æŸäº›æ˜Ÿçº§æˆ‘ä»¬å¿…é¡»è¦è¿›è¡Œèˆå¼ƒã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 1select sex from user where age between a and b and city=â€œhangzhouâ€ order by name åœ¨è¿™ä¸ªsqlä¸­ï¼Œageæ˜¯ä¸€ä¸ªèŒƒå›´æ¡ä»¶ï¼Œåœ¨å‰é¢çš„åšå®¢ä¸­ï¼ˆmysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆä¸€ï¼‰â€”â€”ä»æ…¢æŸ¥è¯¢å®ä¾‹ä¸­å¼€å§‹åˆ†æï¼‰æˆ‘ä»¬è¯´è¿‡ï¼Œå¦‚æœç´¢å¼•åˆ—æ˜¯ä¸€ä¸ªèŒƒå›´æ¡ä»¶ï¼Œé‚£ä¹ˆå…¶åçš„ç´¢å¼•éƒ½å°†å¤±æ•ˆã€‚é‚£è¿™ä¸ªæ—¶å€™ç´¢å¼•è¯¥å¦‚ä½•è®¾è®¡ï¼Ÿåœ¨å‰é¢è¯´è¿‡ï¼Œç´¢å¼•çš„ç¬¬ä¸‰é¢—æ˜Ÿé€šå¸¸æ˜¯æœ€é‡è¦çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆè®¾è®¡ç¬¬ä¸‰é¢—æ˜Ÿï¼Œç´¢å¼•å°†æ˜¯ï¼š*_userã€‚æ·»åŠ nameä¼šè®©ç´¢å¼•æ»¡è¶³ç¬¬äºŒé¢—æ˜Ÿï¼Œä½†è¿™æ˜¯åŸºäºnameå¿…é¡»åœ¨èŒƒå›´è°“è¯ageçš„å‰é¢çš„å‡è®¾çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶ç´¢å¼•å°†å˜æˆ:name_age_sexæˆ–è€…city_name_age_sexï¼Œé‚£ä¹ˆæ­¤æ—¶çš„ç´¢å¼•æ»¡ä¸æ»¡è¶³ç¬¬ä¸€é¢—æ˜Ÿçš„ï¼Œç­”æ¡ˆæ˜¯ä¸æ»¡è¶³çš„ã€‚è®²åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¸€å®šèƒ½å‘ç°ï¼Œç¬¬ä¸€é¢—æ˜Ÿå’Œç¬¬äºŒé¢—æ˜Ÿæ˜¯å­˜åœ¨äº’æ–¥çš„ï¼Œå¦‚æœè¦æ»¡è¶³ç¬¬ä¸€é¢—æ˜Ÿï¼Œé‚£ä¹ˆç´¢å¼•å°†æ˜¯city_age_name_sexï¼Œç„¶è€Œæ­¤æ—¶nameåˆ—ç´¢å¼•æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œæ­¤æ—¶å°±æ— æ³•é¿å…æ’åºï¼Œä¹Ÿå³æ— æ³•æ»¡è¶³ç¬¬äºŒé¢—æ˜Ÿã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•è®¾è®¡å‡ºç†æƒ³çš„ä¸‰æ˜Ÿç´¢å¼•çš„ï¼Œæˆ‘ä»¬å¿…é¡»è¦è¿›è¡Œå–èˆã€‚è‡³äºæ˜¯é€‰ç¬¬ä¸€é¢—æ˜Ÿè¿˜æ˜¯ç¬¬äºŒé¢—æ˜Ÿï¼Œä¸€ä¸ªæ™®éçš„ç»“è®ºï¼ˆè™½ç„¶å¹¶ä¸æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼‰æ˜¯ç¬¬ä¸€é¢—æ˜Ÿè¦æ¯”ç¬¬äºŒé¢—æ˜Ÿé‡è¦ï¼Œå› ä¸ºåœ¨ç¡¬ä»¶å‘å±•æ°´å¹³å¦‚æ­¤å¿«é€Ÿçš„ä»Šå¤©ï¼Œå¯èƒ½æ’åºå¸¦æ¥çš„å¼€é”€è¿œä½äºå› ä¸ºç´¢å¼•ç‰‡å¤ªåšè€Œå¸¦æ¥çš„æŸ¥è¯¢å¼€é”€ã€‚ å¦å¤–ï¼Œè™½ç„¶ç†è®ºä¸Šä¸ºæ¯ä¸€ä¸ªæŸ¥è¯¢éƒ½è®¾è®¡å‡ºæœ€ä¼˜çš„ç´¢å¼•çœ‹ä¼¼æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œç„¶è€ŒçœŸæ­£è¿™ä¹ˆåšçš„æ—¶å€™æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸‹å¼€é”€ï¼šé¦–å…ˆè¿‡å¤šçš„ç´¢å¼•ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦è¯„ä¼°ç´¢å¼•å¸¦æ¥çš„æ”¶ç›Šæ˜¯å¦èƒ½æŠµæ¶ˆç£ç›˜ç©ºé—´å¸¦æ¥çš„å¼€é”€ï¼›å…¶æ¬¡è¡¨ä¸Šæœ‰å¤ªå¤šçš„ç´¢å¼•ï¼ˆå¹¶ä¸”è¿™äº›ç´¢å¼•å¯èƒ½å­˜åœ¨å†—ä½™ï¼‰ï¼Œä¼šä½¿dbçš„æ’å…¥ã€æ›´æ–°ä¸åˆ é™¤æ“ä½œå˜å¾—è¾ƒæ…¢ï¼›æœ€åï¼Œè¾ƒé¢‘ç¹çš„æ’å…¥é¢‘ç‡ï¼Œå¯èƒ½ä¼šåŠ å¤§ç£ç›˜çš„è´Ÿè½½ã€‚æ‰€ä»¥ï¼Œç†è®ºç»ˆç©¶åªæ˜¯ç†è®ºï¼Œå…·ä½“é—®é¢˜è¿˜éœ€è¦å…·ä½“åˆ†æã€‚ â…¢. å¦‚ä½•è®¾è®¡åŠè¯„ä¼°ç´¢å¼•æ€§èƒ½é¦–å…ˆç»™å‡ºä¸¤ä¸ªå¿«é€Ÿä¸”æœ‰ç”¨çš„æ–¹æ³•ï¼š1. åŸºæœ¬é—®é¢˜æ³•ï¼ˆBasic Question, BQï¼‰2. å¿«é€Ÿä¸Šé™ä¼°ç®—æ³•ï¼ˆQuick Upper-Bound Estimate, QUBEï¼‰ 1. åŸºæœ¬é—®é¢˜æ³•BQæ˜¯ä¸€ä¸ªå¾ˆç®€å•å¾ˆå¿«é€Ÿçš„è¯„ä¼°æ–¹æ³•ï¼Œå¯¹äºæ¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œé¦–å…ˆéƒ½è¦é—®è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼š æ˜¯å¦å­˜åœ¨ä¸€ä¸ªç´¢å¼•åŒ…å«äº†whereå­å¥æ‰€ç”¨åˆ°çš„æ‰€æœ‰åˆ—ï¼Ÿå¦‚æœç­”æ¡ˆæ˜¯ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåº”è¯¥è€ƒè™‘å°†ç¼ºå°‘çš„åˆ—åŠ å…¥åˆ°ç°æœ‰çš„ç´¢å¼•ä¸­å»ã€‚æ­¤æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªåŠå®½ç´¢å¼•ï¼Œè™½ç„¶è¿™æ ·ç´¢å¼•åªèƒ½æ‹¿åˆ°ä¸€æ˜Ÿï¼Œä½†ç´¢å¼•è¿‡æ»¤å¯ä»¥ä¿è¯å›è¡¨è®¿é—®åªå‘ç”Ÿåœ¨æ‰€æœ‰æŸ¥è¯¢æ¡ä»¶éƒ½æ»¡è¶³çš„æ—¶å€™ã€‚å¦‚æœæ€§èƒ½è¿˜ä¸å¤Ÿï¼Œé‚£ä¹ˆå¯ä»¥å°†æŸ¥è¯¢æ‰€æœ‰æ¶‰åŠåˆ°çš„åˆ—éƒ½åŠ åˆ°ç´¢å¼•ä¸Šï¼Œè¿™ä¼šäº§ç”Ÿä¸€ä¸ªé¿å…æ‰€æœ‰è¡¨è®¿é—®çš„å®½ç´¢å¼•ã€‚å¦‚æœæŸ¥è¯¢è¿˜æ˜¯å¾ˆæ…¢ï¼Œé‚£ä¹ˆå°±é‡æ–°è®¾è®¡ç´¢å¼•ï½ 2. å¿«é€Ÿä¸Šé™ä¼°ç®—æ³•ã€‚ç›¸æ¯”äºBQï¼ŒQUBEæ˜¯ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒçš„ä¼˜ç‚¹ä¹Ÿå¾ˆæ˜æ˜¾â€”â€”QUBEå¯ä»¥ä¼°ç®—å‡ºæŸ¥è¯¢çš„æ€§èƒ½ã€‚QUBEé€šè¿‡è®¡ç®—æœ¬åœ°å“åº”æ—¶é—´ï¼ˆLRTï¼‰æ¥è¯„ä¼°æŸ¥è¯¢çš„æ€§èƒ½ã€‚æˆ‘ä»¬åªä½¿ç”¨TRï¼ˆéšæœºè®¿é—®çš„æ•°é‡ï¼‰å’ŒTSï¼ˆé¡ºåºè®¿é—®çš„æ•°é‡ï¼‰æ¥è¿›è¡ŒæŸ¥è¯¢è€—æ—¶çš„ä¼°ç®—ã€‚ QUBEä¸­å‡è®¾å•æ¬¡éšæœºè®¿é—®çš„æ—¶é—´ä¸º10msï¼Œé¡ºåºéšæœºè®¿é—®çš„æ—¶é—´ä¸º0.1ms 3. QUBEç¤ºä¾‹ï¼š 3.1 ä¸»é”®ç´¢å¼•è®¿é—®ï¼šè€ƒè™‘å¦‚ä¸‹çš„sqlï¼ˆå‡è®¾idä¸ºä¸»é”®ï¼‰ï¼šselect id, age, city from user where id = xxxé€šè¿‡ä¸»é”®ç´¢å¼•è¯»å–ä¸€ä¸ªè¡¨è¡Œéœ€è¦åˆ†åˆ«éšæœºè®¿é—®ä¸€æ¬¡è¡¨ä»¥åŠç´¢å¼•ï¼Œå› æ­¤æ­¤æŸ¥è¯¢çš„å¼€é”€å¤§çº¦æ˜¯2x10ms=20msã€‚3.2 èšç°‡ç´¢å¼•è®¿é—®ï¼š 1select id, age from user where city = xx and post = xxx order by age å‡å¦‚city_post_ageæ˜¯ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œå¹¶ä¸”æ­å·å¸‚å†…é‚®æ”¿ç¼–ç ä¸ºxxxçš„ç”¨æˆ·æœ‰1000ä¸ªï¼Œå¯ä»¥é€šè¿‡ä¸‰æ˜Ÿç´¢å¼•æ³•åˆ†æè¿™ä¸ªç´¢å¼•æ˜¯ä¸¤æ˜Ÿçš„ï¼ˆç¬¬ä¸€é¢—åŠç¬¬äºŒé¢—ï¼‰ï¼Œä½†æ˜¯æ˜¯ä¸æ»¡è¶³çš„ç¬¬ä¸‰é¢—æ˜Ÿçš„ï¼Œå®ƒå¿…é¡»å›è¡¨å»è®¿é—®ä¸åœ¨ç´¢å¼•åˆ—ä¸­çš„åˆ—ã€‚é¦–å…ˆï¼Œéœ€è¦è¿›è¡Œä¸€æ¬¡éšæœºè®¿é—®æ‰¾åˆ°ç´¢å¼•ç‰‡ä¸Šç¬¬ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„ç´¢å¼•è¡Œï¼Œè¿™æ˜¯ä¸€æ¬¡TRï¼Œç„¶åéœ€è¦1000æ¬¡TSæ¥è¯»å–ç´¢å¼•ï¼Œå› æ­¤è¯»å–ç´¢å¼•ç‰‡çš„å¼€é”€ä¸º1x10ms+1000x0.01ms=20msï¼›ç„¶åæ¥è®¡ç®—å›è¡¨çš„å¼€é”€ï¼Œå›è¡¨éœ€è¦ä¸€æ¬¡TRï¼Œä»¥åŠ999æ¬¡TSï¼Œæ‰€ä»¥å›è¡¨çš„å¼€é”€å¤§çº¦ä¹Ÿæ˜¯20msã€‚å› æ­¤è¿™æ¡sqlæ€»çš„è€—æ—¶å¤§çº¦æ˜¯40msã€‚3.3 éèšç°‡ç´¢å¼•è®¿é—®ï¼šè¿˜æ˜¯å¦‚ä¸Šçš„sqlï¼Œå¦‚æœcity_post_ageä¸æ˜¯ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“ï¼Œå›è¡¨çš„è®¿é—®å°†å˜æˆ1000æ¬¡çš„TRï¼Œæ­¤æ—¶å›è¡¨çš„è€—æ—¶å°†æ˜¯10sï¼æ­¤æ—¶å¯ä»¥è€ƒè™‘å°†idåŠ å…¥åˆ°ç´¢å¼•city_post_ageä¸­ï¼Œè¿™æ ·ä¾¿çœå»äº†å›è¡¨æŸ¥è¯¢çš„å¼€é”€ã€‚ â…£. æ€»ç»“è¿™æ¬¡æˆ‘ä»¬é¦–å…ˆå®šä¹‰äº†ä¸€äº›å‡è®¾åŠæ¦‚å¿µï¼Œç„¶åæå‡ºäº†â€œä¸‰æ˜Ÿç´¢å¼•â€çš„æ¦‚å¿µåŠè®¾è®¡æ€è·¯ï¼Œæœ€åè®²è¿°è¯„ä¼°ç´¢å¼•æ€§èƒ½çš„ä¸¤ä¸ªæ–¹æ¡ˆã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘è®¤ä¸ºè¿™é‡Œæ‰€æå‡ºçš„ç´¢å¼•è®¾è®¡åŠè¯„ä¼°çš„æ–¹æ¡ˆéƒ½æ˜¯ç®€å•æ˜“ç”¨çš„ï¼Œæœ‰å…´è¶£çš„ä¸å¦¨è¯•è¯•çœ‹ã€‚BTWï¼Œå…¶å®æˆ‘è§‰å¾—explainä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åˆ†ææ€§èƒ½çš„æ–¹æ³•ï¼Œåœ¨ç´¢å¼•å»ºç«‹å®Œä¹‹åï¼Œä¸å¦¨ä½¿ç”¨explainæ¥åˆ†æä¸‹æŸ¥è¯¢çš„æ€§èƒ½ï½ â…¤. Reference[1]. Lahdenmaki T, Leach M. Relational Database Index Design and the Optimizers[M]. Wiley-Interscience, 2005.[2]. Schwartz B, Zaitsev P, Tkachenko V. High Performance MySQL: Optimization, Backups, and Replication[M]. Oâ€™Reilly Media, Inc. 2012.]]></content>
      <tags>
        <tag>sql</tag>
        <tag>æ•°æ®åº“</tag>
        <tag>ç´¢å¼•</tag>
        <tag>ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆäºŒï¼‰â€”â€”ç´¢å¼•æ¦‚è¿°]]></title>
    <url>%2F2018%2F08%2F30%2FsqlIndexAndQueryOptimize-2%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢éš”äº†é‚£ä¹ˆä¹…ï¼Œç»ˆäºå†™äº†ç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–çš„ç¬¬äºŒç¯‡åšæ–‡ï¼Œç¡®å®ç”¨äº†å¥½é•¿çš„æ—¶é—´å»çœ‹ä¹¦ï¼Œçœ‹åšå®¢ç„¶åæ€»ç»“ã€‚ç„¶è€Œï¼Œä¸å¾—ä¸è¯´æˆ‘ä¹‹å‰å¯¹sqlä»¥åŠç´¢å¼•ç›¸å…³çš„çŸ¥è¯†äº†è§£ç¡®å®ç”šå°‘ï¼ˆå¹¶ä¸”åœ¨å®é™…ä¸­ç”¨çš„ä¹Ÿä¸å¤ªå¤šï¼‰ï¼Œå› æ­¤å³ä½¿è¡¥å……äº†ä¸€äº›ç›¸å…³çŸ¥è¯†ï¼Œ å†™å‡ºæ¥çš„æ–‡ç« ä¹Ÿä¼šæœ‰å¾ˆå¤šçš„ä¸è¶³ä¸çº°æ¼ã€‚åœ¨æ­¤ä¹Ÿå¸Œæœ›ä»æ–‡ç« ä¸­çœ‹å‡ºæœ‰ä»€ä¹ˆä¸è¶³çš„æœ‹å‹å¯ä»¥å°½æƒ…æ‰¹è¯„æŒ‡æ­£ï½è¿™ç¯‡åšå®¢ä¸»è¦åˆ†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ç®€å•ä»‹ç»äº†ç´¢å¼•çš„æ¦‚å¿µåŠç±»å‹ï¼›ç¬¬äºŒéƒ¨åˆ†ä»‹ç»äº†å¦‚ä½•é€šè¿‡ExplainæŒ‡ä»¤åˆ†æsqlï¼›ç¬¬ä¸‰éƒ¨åˆ†ç»™å‡ºäº†ä¸€äº›sqlçš„å®ä¾‹ã€‚ â… . ç´¢å¼•æ¦‚å¿µåŠç±»å‹1 ç´¢å¼•æ¦‚å¿µç´¢å¼•æ˜¯å­˜å‚¨å¼•æ“ç”¨æ¥å¿«é€Ÿæ‰¾åˆ°è®°å½•çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚ç±»ä¼¼äºä¹¦ç›®å½•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ‰¾â€œç¬¬ä¸‰ç« ç¬¬å››å°èŠ‚â€çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå…ˆä»ç›®å½•ä¸­æ‰¾åˆ°å…¶æ‰€åœ¨çš„é¡µæ•°ï¼Œç„¶åå†ä»å…·ä½“çš„é¡µä¸­æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚ç´¢å¼•ä¹Ÿæ˜¯ä¸€æ ·ï¼Œåœ¨æŸ¥è¯¢æ—¶ï¼Œå…ˆæ‰¾åˆ°ç´¢å¼•æ‰€åœ¨çš„ä½ç½®ï¼Œç„¶åæ ¹æ®ç´¢å¼•åŒ¹é…åˆ°çš„è®°å½•æ¥æ‰¾åˆ°å¯¹åº”çš„æ•°æ®ã€‚ 2 ç´¢å¼•ç±»å‹ 2.1 b-treeç´¢å¼•b-treeç´¢å¼•æ˜¯mysqlå¼•æ“ä¸­ç”¨çš„è¾ƒå¤šçš„ä¸€ç§ç±»å‹ï¼Œå¤§å¤šæ•°çš„å¼•æ“éƒ½æ”¯æŒï¼Œé™¤äº†archiveå¼•æ“ï¼ˆå¯¹è¿™ä¸ªå¥½é™Œç”Ÿ - -ï¼‰ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“ä½¿ç”¨ä¸åŒçš„b-treeç´¢å¼•ï¼Œå¹¶ä¸”æ€§èƒ½ä¹Ÿæœ‰å·®åˆ«ã€‚æ¯”å¦‚åœ¨innodbå¼•æ“ä¸­ä½¿ç”¨b+treeç´¢å¼•ã€‚myisamå¼•æ“ä¼šå¯¹ç´¢å¼•è¿›è¡Œå‰ç¼€å‹ç¼©ï¼Œæ‰€ä»¥ç´¢å¼•å¾ˆæ›´å°ï¼›myisamä¸­ç´¢å¼•é€šè¿‡æ•°æ®çš„ç‰©ç†ä½ç½®æ¥å¼•ç”¨ç´¢å¼•è¡Œï¼Œè€Œinnodbä¸­æ ¹æ®ä¸»é”®å¼•ç”¨ç´¢å¼•è¡Œã€‚b-treeç´¢å¼•å¯¹ç´¢å¼•æŒ‰ç…§é¡ºåºç»„ç»‡å­˜å‚¨çš„ï¼Œå› æ­¤é€‚åˆæŸ¥æ‰¾èŒƒå›´æ•°æ®ã€‚ B-treeç´¢å¼•åœ¨å®é™…å¼€å‘ä¸­æ˜¯ç”¨çš„æœ€å¤šæœ€å¹¿æ³›çš„ç´¢å¼•ç»“æ„ï¼Œä¹‹åçš„è®¨è®ºéƒ½é»˜è®¤æ˜¯ä»¥B-treeç´¢å¼•ä¸ºä¾‹ã€‚åœ¨æŸäº›ä¸å½“çš„æŸ¥è¯¢æˆ–è€…ç´¢å¼•çš„ä½¿ç”¨ä¸­ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œä¸»è¦æœ‰ä»¥ä¸‹è¿™å‡ ç§æƒ…å†µï¼š ä¸¥æ ¼éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ã€‚å³æŸ¥è¯¢å¿…é¡»ä»ç´¢å¼•çš„æœ€å·¦å‰åˆ—å¼€å§‹ã€‚æ¯”å¦‚ä¸€ä¸ªç´¢å¼•(name_age_dob)ï¼Œå¦‚æœè¦æŸ¥è¯¢age=18çš„ç”¨æˆ·ï¼Œå°±æ— æ³•ä½¿ç”¨(name_age_dob)è¿™ä¸ªç´¢å¼•äº†ã€‚ ä¸èƒ½è·³è¿‡ç´¢å¼•ä¸­é—´çš„åˆ—ã€‚æ¯”å¦‚æˆ‘ä»¬è¦æŸ¥æ‰¾age=18å¹¶ä¸”dob=1024çš„ç”¨æˆ·ï¼Œä½†ä¸æŒ‡å®šageï¼Œé‚£ä¹ˆå°±æ— æ³•ä½¿ç”¨åˆ°(name_age_dob)ç´¢å¼•ï¼Œåªèƒ½ä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—ã€‚ æŸ¥è¯¢ä¸­æŸä¸ªåˆ—å‡ºç°äº†èŒƒå›´æŸ¥è¯¢ï¼Œé‚£ä¹ˆå®ƒå³è¾¹çš„åˆ—éƒ½æ— æ³•é€šè¿‡ç´¢å¼•æ¥è¿›è¡Œä¼˜åŒ–æŸ¥è¯¢ã€‚è¿™åœ¨å‰ä¸€ç¯‡åšå®¢ï¼ˆxxxxï¼‰ä¸­å°±è®²è¿°è¿‡ã€‚ ç´¢å¼•å­—æ®µä¸Šä½¿ç”¨äº†ï¼ˆ!= &lt;&gt; is null is not null or æˆ–è€…likeä»¥â€%_â€ å¼€å¤´ï¼‰ç­‰ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å…¥å…¨è¡¨æ‰«æ å¯¹ç´¢å¼•åˆ—è¿›è¡Œæ“ä½œï¼ˆè¿™é‡ŒæŒ‡ç´¢å¼•åˆ—ä¸èƒ½æ˜¯è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸èƒ½æ˜¯å‡½æ•°çš„å‚æ•°ï¼‰ï¼Œæ¯”å¦‚ä¸‹è¾¹çš„sqlå°±ä¸èƒ½ä½¿ç”¨ç´¢å¼•ï¼Œæ˜çœ¼äººä¸€çœ‹å°±çŸ¥é“id=1023å•Šï¼Œç„¶è€ŒMysqlå¼•æ“å¹¶ä¸ä¼šé‚£ä¹ˆçš„æ™ºèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æŸ¥è¯¢æ—¶èƒ½ç®€åŒ–æ¡ä»¶å°±ç®€åŒ–æ¡ä»¶ï¼Œè¶Šç®€å•è¶Šå¥½ã€‚ 1select id from user where id+1=1024 2.2 å“ˆå¸Œç´¢å¼•å“ˆå¸Œç´¢å¼•åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œmysqlå¼•æ“ä¸­åªæœ‰memoryæ”¯æŒå“ˆå¸Œç´¢å¼•ï¼Œæˆ‘ä»¬çŸ¥é“å“ˆå¸Œè¡¨ä¼šå­˜åœ¨â€œå“ˆå¸Œç¢°æ’â€çš„é—®é¢˜ï¼Œmemoryå¼•æ“æ ¹æ®é“¾è¡¨æ³•æ¥è§£å†³é”®å€¼å†²çªçš„æƒ…å†µã€‚ç±»æ¯”äºå“ˆå¸Œè¡¨ï¼Œä½¿ç”¨å“ˆå¸Œç´¢å¼•æŸ¥æ‰¾çš„é€Ÿåº¦ååˆ†å¿«ã€‚ä½†ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼š å“ˆå¸Œç´¢å¼•åªåŒ…å«å“ˆå¸Œå€¼ä»¥åŠè¡ŒæŒ‡é’ˆï¼Œä¸å­˜å‚¨å…·ä½“å­—æ®µçš„å€¼ï¼Œæ‰€ä»¥ä¸èƒ½æ ¹æ®åŒ¹é…ç´¢å¼•æ¥é¿å…è¯»å–è¡¨è¡Œ å“ˆå¸Œç´¢å¼•çš„æ•°æ®ä¸æ˜¯æŒ‰ç…§ç´¢å¼•å€¼é¡ºåºå­˜å‚¨çš„ï¼Œå› æ­¤æ— æ³•ç”¨äºæ’åºï¼ˆè¿™ä¸ªåº”è¯¥å¾ˆå¥½ç†è§£ï¼‰ å“ˆå¸Œç´¢å¼•å› ä¸ºæ˜¯æ ¹æ®å¯¹keyè¿›è¡Œhashæ¥æŸ¥æ‰¾çš„ï¼Œå› æ­¤ä¸æ”¯æŒéƒ¨åˆ†ç´¢å¼•åŒ¹é…çš„æƒ…å†µã€‚ å“ˆå¸Œç´¢å¼•ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼Œåªæ”¯æŒç­‰å€¼æŸ¥è¯¢ï¼ˆæ³¨æ„IN()ä¹Ÿæ˜¯ä¸€ç§ç­‰å€¼æŸ¥è¯¢ï¼ï¼‰ ä¸Šé¢è¯´åˆ°äº†å“ˆå¸Œç¢°æ’ï¼Œå¦‚æœç¢°æ’è¿‡å¤šï¼Œå“ˆå¸Œç´¢å¼•çš„æ€§èƒ½å°†å—å¾ˆå¤§çš„å½±å“ 2.3 å…¨æ–‡ç´¢å¼•å…¨æ–‡ç´¢å¼•æŸ¥æ‰¾çš„æ˜¯æ–‡æœ¬ä¸­çš„å…³é”®è¯ï¼Œè€Œä¸æ˜¯ç›´æ¥æ¯”è¾ƒç´¢å¼•ä¸­çš„å€¼ã€‚ç”¨çš„ä¸å¤šï¼ˆæˆ‘æ ¹æœ¬æ²¡ç”¨è¿‡ï¼‰ï¼Œè¿™ä¹Ÿä¸æ˜¯æˆ‘æƒ³è¯´çš„é‡ç‚¹ï¼Œæ‰€ä»¥ä¸è¯¦ç»†å±•å¼€ã€‚ 2.4 èšç°‡ç´¢å¼•é¦–å…ˆï¼Œèšç°‡ç´¢å¼•å¹¶ä¸æ˜¯ä¸€ç§ç®€å•çš„ç´¢å¼•ç±»å‹ï¼Œè€Œæ˜¯ä¸€ç§æ•°æ®å­˜å‚¨æ–¹å¼ã€‚åœ¨innodbä¸­ï¼Œèšç°‡ç´¢å¼•å®é™…åœ¨ä¸€ä¸ªç»“æ„ä¸­åŒæ—¶ä¿å­˜äº†b-treeç´¢å¼•ä»¥åŠæ•°æ®è¡Œã€‚ èšç°‡ç´¢å¼•çš„æ•°æ®çš„ç‰©ç†å­˜æ”¾é¡ºåºä¸ç´¢å¼•é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œå³ï¼šåªè¦ç´¢å¼•æ˜¯ç›¸é‚»çš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®ä¸€å®šä¹Ÿæ˜¯ç›¸é‚»åœ°å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„ã€‚å› ä¸ºä¸€å¼ è¡¨åªæœ‰ä¸€ä¸ªç‰©ç†ç»“æ„ï¼Œå› æ­¤ä¸€å¼ è¡¨ä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ã€‚èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±æ˜¯æ•°æ®èŠ‚ç‚¹ï¼Œè€Œéèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä»ç„¶æ˜¯ç´¢å¼•èŠ‚ç‚¹ï¼Œå¹¶ä¸”æœ‰æŒ‡å‘å¯¹åº”æ•°æ®å—çš„æŒ‡é’ˆã€‚innodbé»˜è®¤ä¼šä»¥ä¸»é”®ä½œä¸ºèšç°‡ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ä¸»é”®ï¼Œinnodbä¼šé€‰æ‹©ä¸€ä¸ªå”¯ä¸€çš„éç©ºç´¢å¼•æ¥ä»£æ›¿ã€‚å¦‚æœå‰é¢çš„æƒ…å†µéƒ½ä¸æ»¡è¶³ï¼Œé‚£ä¹ˆinnodbä¼šéšå¼å®šä¹‰ä¸€ä¸ªä¸»é”®æ¥ä½œä¸ºèšç°‡ç´¢å¼•ã€‚ 2.5 è¦†ç›–ç´¢å¼•è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰ä¹Ÿä¸æ˜¯å¸¸è§„æ„ä¹‰ä¸Šçš„ç´¢å¼•ã€‚å¦‚æœä¸€ä¸ªç´¢å¼•åŒ…å«äº†æ‰€æœ‰æŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼Œé‚£ä¹ˆä¹…ç§°è¿™ä¸ªç´¢å¼•ä¸ºâ€œè¦†ç›–ç´¢å¼•â€ã€‚ä½¿ç”¨â€œè¦†ç›–ç´¢å¼•â€å¯ä»¥æå¤§æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚ â…¡. SQLåˆ†æåœ¨è¿›è¡Œsqlåˆ†ææ—¶ï¼Œexplainè¯­å¥æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°†ä¸¾å‡ºä¸€äº›sqlçš„æŸ¥è¯¢æ¥è¿›è¡Œåˆ†æï¼Œä»¥ä¸‹çš„ä¾‹å­éƒ½æ¥è‡ªäºRefundè¡¨ï¼ˆè¿™å¼ è¡¨ä¸ç¬¬ä¸€ç¯‡åšæ–‡ä¸­ä½¿ç”¨çš„è¡¨ç›¸åŒï¼Œåœ°å€ï¼šmysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆä¸€ï¼‰â€”â€”ä»æ…¢æŸ¥è¯¢å®ä¾‹ä¸­å¼€å§‹åˆ†æï¼‰ explainå¾—åˆ°çš„ç»“æœåˆ†æ: è¯·çœ‹ä¸‹å›¾çš„ä¾‹å­ï¼š é¦–å…ˆæˆ‘ä»¬æ¥è§£é‡Šä¸‹explainç»“æœçš„å„ä¸ªåˆ—çš„å«ä¹‰ï¼š id:è¡¨ç¤ºselectå­å¥æ‰§è¡Œçš„idï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œidçš„åºå·å°±ä¼šé€’å¢äº†ï¼Œå¹¶ä¸”idå€¼è¶Šå¤§çš„å­å¥è¶Šå…ˆè¢«æ‰§è¡Œ select_type:è¡¨ç¤ºselectè¯­å¥çš„ç±»å‹ï¼Œæ¯”å¦‚ï¼šSIMPLEï¼ˆç®€å•æŸ¥è¯¢ï¼Œä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€…UNIONï¼‰ï¼›PRIMARY æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸ºPRIMARYï¼Œå…·ä½“ä¸å±•å¼€äº†ï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ table:å½“å‰æ‰§è¡Œçš„è¡¨å typeï¼šå½“å‰è¡¨å†…è®¿é—®æ–¹å¼ï¼Œè®¿é—®æ–¹å¼ä»å¥½åˆ°åæ’åºä¸ºï¼š system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; allsystemæŒ‡è¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼›constè¡¨ç¤ºæŸ¥è¯¢äº†ä¸€æ¬¡å°±æ‰¾åˆ°ç»“æœï¼›eq_refè¡¨ç¤ºå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ï¼›refè¡¨ç¤ºéå”¯ä¸€ç´¢å¼•æ‰«æï¼›range è¡¨ç¤ºåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œï¼›indexè¡¨ç¤ºæŸ¥è¯¢æ‰«æäº†ç´¢å¼•æ ‘ï¼›allè¡¨ç¤ºå…¨è¡¨æ‰«æ possible_keys:å¯èƒ½ä½¿ç”¨åˆ°çš„ç´¢å¼• key:ç»è¿‡ä¼˜åŒ–å™¨è¯„ä¼°æœ€ç»ˆä½¿ç”¨çš„ç´¢å¼• key_length:ä½¿ç”¨åˆ°çš„ç´¢å¼•é•¿åº¦ ref:å¼•ç”¨åˆ°çš„ä¸Šä¸€ä¸ªè¡¨çš„åˆ—rows:è¦å¾—åˆ°æœ€ç»ˆè®°å½•ç´¢è¦æ‰«æç»è¿‡çš„è®°å½•æ•°ï¼Œrowså€¼è¶Šå°è¯´æ˜æŸ¥è¯¢è¶Šé«˜æ•ˆ Extra:é¢å¤–çš„ä¿¡æ¯è¯´æ˜ï¼Œä¸»è¦çš„ç±»å‹æœ‰ï¼šUsing filesortï¼šæ–‡ä»¶æ’åºï¼Œè¯´æ˜mysqlæ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºUsing temporaryï¼šä¸´æ—¶è¡¨ï¼Œ ä½¿ç”¨äº†ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQLåœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œè¿™ä¸ªæ—¶å€™æ•ˆç‡æ˜¯æå…¶ä½ä¸‹çš„Using indexï¼šè¡¨ç¤ºç›¸åº”çš„selectæ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰ï¼Œé¿å…è®¿é—®äº†å›è¡¨è®¿é—®æ•°æ®Using whereï¼šä½¿ç”¨äº†whereè¿‡æ»¤Using join bufferï¼šä½¿ç”¨äº†è¿æ¥ç¼“å­˜impossible whereï¼šwhereå­å¥çš„å€¼æ€»æ˜¯falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•å…ƒç»„Using index conditionï¼šUsing index condition ä¼šå…ˆæ¡ä»¶è¿‡æ»¤ç´¢å¼•ï¼Œè¿‡æ»¤å®Œç´¢å¼•åæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆç´¢å¼•æ¡ä»¶çš„æ•°æ®è¡Œï¼Œéšåç”¨ WHERE å­å¥ä¸­çš„å…¶ä»–æ¡ä»¶å»è¿‡æ»¤è¿™äº›æ•°æ®è¡Œ â…¢. å®ä¾‹åˆ†æè¯·çœ‹å¦‚ä¸‹çš„sqlï¼š1explain select* from Refund where sellerUserId=93106308 å› ä¸ºç´¢å¼•æ— æ³•è¦†ç›–æŸ¥è¯¢æ‰€éœ€è¦çš„å…¨éƒ¨åˆ—ï¼Œå› æ­¤Extraä¸­æ˜¾ç¤ºâ€œUsing index conditionâ€ï¼š å†çœ‹è¿™ä¸ªSQLï¼š1explain select status from Refund where status=700 order by created è¿™é‡Œè¿›è¡Œäº†æ–‡ä»¶æ’åºï¼š è¦†ç›–ç´¢å¼•æŸ¥è¯¢ï¼š1explain select sellerUserId, status, created from Refund Refundè¡¨ä¸­æœ‰ä¸€ä¸ªå¤šåˆ—ç´¢å¼•ï¼šKEY idx_sellerUserId_created_status (sellerUserId,created,status)ï¼Œå¦‚æœåªè®¿é—®sellerUserId, status, createdè¿™ä¸‰åˆ—ï¼ŒæŸ¥è¯¢å°†ä½¿ç”¨â€œè¦†ç›–ç´¢å¼•â€ï¼šå…·ä½“æ‰§è¡Œç»“æœå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨typeåˆ—ä¸­æ˜¾ç¤ºäº†â€œindexâ€ï¼Œè¿™è¡¨ç¤ºæ­¤æ¬¡æŸ¥è¯¢å°†é€šè¿‡ç´¢å¼•æ¥è®¿é—®æ•°æ®ï¼›Extraä¸­çš„â€œUsing indexâ€è¡¨ç¤ºæ­¤æ¬¡æŸ¥è¯¢å°†ä½¿ç”¨â€œç´¢å¼•è¦†ç›–â€æŸ¥è¯¢ã€‚ æœ€åä¸€ä¸ªsqlä¾‹å­ï¼š1explain select status from Refund where sellerUserId=93106308 order by created è¿™å¥sqlä¸­çš„Extraä¸ä»…å‡ºç°äº†â€œUsing indexâ€è¿˜å‡ºç°äº†â€œUsing whereâ€ï¼Œè¿™è¡¨ç¤ºç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç°â€œUsing whereâ€ï¼Œè¡¨æ˜ç´¢å¼•ç”¨æ¥è¯»å–æ•°æ®è€Œéæ‰§è¡ŒæŸ¥æ‰¾åŠ¨ä½œã€‚ â…£. Reference[1]. EXPLAINç”¨æ³•å’Œç»“æœåˆ†æï¼šhttps://blog.csdn.net/why15732625998/article/details/80388236[2]. Schwartz B, Zaitsev P, Tkachenko V. High Performance MySQL: Optimization, Backups, and Replication[M]. Oâ€™Reilly Media, Inc. 2012.]]></content>
      <tags>
        <tag>sql</tag>
        <tag>æ•°æ®åº“</tag>
        <tag>ç´¢å¼•</tag>
        <tag>ä¼˜åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­£å¼å‘Šåˆ«CSDN]]></title>
    <url>%2F2018%2F08%2F08%2F20180808-sayByeToCSDN%2F</url>
    <content type="text"><![CDATA[ç»ˆäºæœ‰äº†è‡ªå·±çš„åšå®¢CSDNæ‹œæ‹œğŸ‘‹ï½æ— æ•°æ¬¡è¢«csdnè ¢å“­ï¼ä¸€æ˜¯æ„šè ¢çš„äººå·¥å®¡æ ¸æ–¹å¼ï¼›äºŒæ˜¯æ‰æ€¥çš„appåå°ï¼Œè€å¥”æºƒã€‚è€å®è¯´ï¼Œä¹‹å‰12306æ˜¯æˆ‘è§è¿‡çš„æœ€å‚»æœ€è ¢çš„appï¼å¥½äº†ï¼Œcsdnåˆ·æ–°æˆ‘è®°å½•äº†ã€‚ç°åœ¨æˆ‘æŠŠè¿™ä¸ªtitleé¢ç»™æ‚¨ï¼è¯·æ‚¨åŠ¡å¿…æ¥å—ï¼BTWï¼Œç°åœ¨ç»ˆäºä¹Ÿæ­å»ºäº†è‡ªå·±çš„åšå®¢ï½ blog4olive.topåŸŸåä¸ç®—å¥½å¬ï¼ˆç©·å›°çš„æˆ‘è¿™è¾ˆå­éƒ½ä¹°ä¸èµ·å¥½å¬çš„åŸŸåï¼å¯ä»¥è€ƒè™‘ç»™æˆ‘ä¼—ç­¹ã€‚åˆšå¥½æ·»åŠ äº†æ‰“èµåŠŸèƒ½ï¼Œæ–‡ç« æœ«å°¾å³å¯çœ‹åˆ°ï¼ï¼‰ï¼Œä½†èƒœåœ¨ç®€å•æ˜äº†å¯¹å§ï¼Ÿ å…³äºåšå®¢æ›´æ–° å¢åŠ äº†æ–‡ç« pv åšå®¢pvçš„æ˜¾ç¤º é¡µè„šiconç­‰çš„ä¼˜åŒ– æ–‡ç« ç»“æ„æ˜¾ç¤º æ–‡ç« æœç´¢åŠŸèƒ½ æ‰“èµ TODO: è¯„è®ºåŠŸèƒ½ åˆ†äº« ä»£ç é«˜äº®ç­‰æ ¼å¼ä¼˜åŒ– æ›´ç¾è§‚æ›´ä¼˜é›… ä¹‹åcsdnçš„åšå®¢éƒ½è¦è¿ç§»è¿‡æ¥ï¼Œå·¥ç¨‹é‡å·¨å¤§ï¼Œæƒ³æ‰“äºº é‚£ä¹ˆç»§ç»­åŠ æ²¹å§! é€ä¸Šä¸€å¼ ç¾ç…§ï¼Œæ”¹å¤©ï¼ˆæœˆï¼Ÿå¹´ï¼Ÿï¼‰ç»§ç»­å‡ºå»æ—…è¡Œ]]></content>
      <tags>
        <tag>éšä¾¿å†™å†™</tag>
        <tag>åæ§½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ–ï¼ˆä¸€ï¼‰â€”â€”ä»æ…¢æŸ¥è¯¢å®ä¾‹ä¸­å¼€å§‹åˆ†æ]]></title>
    <url>%2F2018%2F08%2F04%2F20180804-sqlIndexAndQueryOptimize-1%2F</url>
    <content type="text"><![CDATA[å®˜æ–¹åæ§½ä¸ºä»€ä¹ˆå†™è¿™ä¸ªå†™è¿™ä¸ªåšå®¢ä¹Ÿç®—æ˜¯é˜´å·®é˜³é”™ã€‚ä¸Šæ¬¡åšäº†ä¸ªéœ€æ±‚ï¼šé€€æ¬¾åˆ—è¡¨å¯¼å‡ºï¼ˆå¯ä»¥ç¿»ç¿»ä¹‹å‰çš„åšå®¢ï¼Œæœ‰å†™ï¼‰ã€‚è™½ç„¶äº‹æƒ…è¿‡äº†é‚£ä¹ˆä¹…ï¼Œç°åœ¨æˆ‘è¿˜æ˜¯æƒ³è¦åæ§½ä¸‹ï¼Œè¿™ä¸ªéœ€æ±‚æ˜¯çœŸçš„æœ‰å¾ˆå¤šå‘ï¼Œä½†è¯è¯´å›æ¥ï¼Œåšéš¾äº‹æ‰ä¼šæœ‰æ‰€å¾—ï¼Œè¸©çš„å‘è¶Šå¤šï¼Œé‚£æˆé•¿å°±è¶Šå¤šï¼ˆè¯·è„‘è¡¥è™ä¸»æ–‡ï¼‰ã€‚ å…³äºè¿™ä¸ªç³»åˆ—çš„åšå®¢è¿™ä¸ªåšå®¢å¤§æ¦‚æ˜¯è¿™ä¹ˆåˆ†å¸ƒçš„ï¼šç¬¬ä¸€ç¯‡å°±æ ¹æ®å®é™…åœºæ™¯æ¥åˆ†æä¸‹ç´¢å¼•åŠæŸ¥è¯¢ä¸Šçš„ä¼˜åŒ–ï¼›ç¬¬äºŒç¯‡å’Œç¬¬ä¸‰ç¯‡ï¼ˆå¦‚æœæˆ‘è¿˜èƒ½å†™å¾—å‡ºæ¥ç¬¬ä¸‰ç¯‡çš„è¯ğŸ˜…ï¼‰æ¥ç³»ç»Ÿåœ°æ•´ç†ä¸‹mysqlçš„ç´¢å¼•åŠæŸ¥è¯¢çš„ä¼˜åŒ–ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ä»¥ä¸‹ä¸ºæ­£æ–‡ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæœ‰ä¸€æ¬¡ä¸€ä¸ªå®¢æœåŒå­¦æ€¥æ€¥å¿™å¿™æ¥æ‰¾æˆ‘ï¼Œè¯´å¯¼å‡ºå‡ æ¡è®°å½•éƒ½å¤±è´¥äº†ï¼ŒæŸ¥çœ‹äº†é”™è¯¯æ—¥å¿—æ˜¾ç¤ºé”™è¯¯å¦‚ä¸‹ï¼š å¥½äº†ï¼Œä¸è¦ç›¯ç€äººå®¶çš„çº¢è‰²æ¡†æ¡†çœ‹äº†ï¼Œé‡ç‚¹ä¸æ˜¯é‚£é‡Œã€‚ é‡ç‚¹æ˜¯å‡ºç°äº†æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæˆ‘çŸ¥é“çœ‹å›¾è‚¯å®šçœ‹ä¸å‡ºæ¥è¿™æ¡sqlæ˜¯å•¥ï¼Œäºæ˜¯æˆ‘è´´å¿ƒçš„è´´äº†å‡ºæ¥ï¼š 1234567select* ï¼ˆè¿™é‡Œå…¶å®ä¸æ˜¯è¿™ä¹ˆæš´åŠ›åœ°æ‹¿å…¨åˆ—æ•°æ®ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå°±*è¡¨ç¤ºäº†ï¼‰from RefundFORCE INDEX (idx_sellerUserId_created_status)WHERE sellerUserId = 40955202 AND status IN (800, 900) AND created &gt;= 946656000 AND created &lt; 2051193600 ORDER BY created desc LIMIT 0, 50 é¦–å…ˆæ¥åˆ†æä¸‹è¿™æ¡sqlè¦åšå•¥ï¼Œå…¶å®å°±æ˜¯åœ¨Refundï¼ˆé€€æ¬¾è¡¨ï¼‰è¿™ä¸ªè¡¨ä¸­æŸ¥è¯¢æ‰€æœ‰sellerUserIdä¸º40955202ï¼Œå¹¶ä¸”çŠ¶æ€åœ¨800åŠ900ï¼ˆ800ï¼Œ900ç­‰è¡¨ç¤ºé€€æ¬¾å¤„äºçš„çŠ¶æ€ï¼Œå¦‚é€€æ¬¾ç”³è¯·ï¼Œé€€æ¬¾å®Œæˆç­‰ï¼‰ä¹‹é—´çš„ï¼Œå¹¶ä¸”åˆ›å»ºæ—¶é—´å¤§äºç­‰äº946656000ä¸”å°äº2051193600ï¼ˆè¿™æ˜¯ä¸¤ä¸ªæ—¶é—´æˆ³ï¼‰çš„æ‰€æœ‰è®°å½•ï¼Œå¹¶ä¸”å°†æ‰€æœ‰è¿™äº›è®°å½•æ ¹æ®createdï¼ˆåˆ›å»ºæ—¶é—´ï¼‰è¿›è¡Œé€†åºæ’åºåå–å¼€å¤´50æ¡ã€‚æ³¨æ„åˆ°è¿™ä¸ªsqlæœ‰ä¸€ä¸ª FORCE INDEX (idx_sellerUserId_created_status)ï¼Œè¿™ä¸ªæ„æ€æ˜¯è®©sqlå¼ºåˆ¶èµ°idx_sellerUserId_created_statusè¿™ä¸ªç´¢å¼•ï¼Œè‡³äºä¸ºä»€ä¹ˆæœ‰æ—¶å€™éœ€è¦å¼ºè¡Œèµ°ç´¢å¼•ï¼Œè¿™ä¸ªæ¶‰åŠåˆ°mysqlçš„æŸ¥è¯¢ä¼˜åŒ–ï¼Œä¹‹åä¼šè®²åˆ° çœ‹äº†ä¸Šé¢è¿™æ¡sqlï¼Œæœ‰æ²¡æœ‰å‘ç°ä»€ä¹ˆé—®é¢˜ï¼Ÿå¯èƒ½æˆ‘ä»¬ä¼šè§‰å¾—æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å¾ˆæ¸…æ™°åœ°è¯´å‡ºæ¥ã€‚é‚£ä¹ˆï¼Œé¦–å…ˆæ¥çœ‹ä¸‹mysqlçš„æ‰§è¡Œè®¡åˆ’å§ï¼ çœ‹å‡ºé—®é¢˜æ¥äº†ä¹ˆï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ¡sqlè‡³å°‘å­˜åœ¨3æ¡é—®é¢˜ï¼ä»¥ä¸‹ä¸€æ¡ä¸€æ¡æ¥åˆ†æï¼š ceratedçš„æ—¶é—´æŸ¥è¯¢èŒƒå›´è¿‡å¤§ï¼Œ946656000è½¬åŒ–ä¸ºåŒ—äº¬æ—¶é—´æ˜¯2000/1/1 0:0:0ï¼Œ2051193600è½¬åŒ–ä¸ºåŒ—äº¬æ—¶é—´æ˜¯2035/1/1 0:0:0ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶é—´æ®µæ®µå«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨æˆ‘åº”ç”¨çš„å…·ä½“æ‰§è¡Œä¸­ï¼Œå½“ç”¨æˆ·åœ¨å¯¼å‡ºé€€æ¬¾åˆ—è¡¨æ—¶æ²¡æœ‰é€‰æ‹©å¯¼å‡ºçš„æ—¶é—´æ®µæ—¶ï¼Œå°±ä¼šç»™å®šä¸€ä¸ªé»˜è®¤çš„æœç´¢æ—¶é—´æ®µï¼Œè€Œæ°å·§æˆ‘è®¾ç½®äº†æ¯”è¾ƒå¤§çš„èµ·æ­¢æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´æ®µæœ¬æ¥æ˜¯ä¸éœ€è¦è¿™ä¹ˆå¤§çš„ï¼Œè¿™ä¸ªæ—¶é—´æ®µåŸºæœ¬å°†è¿™ä¸ªç”¨æˆ·æ‰€æœ‰çš„é€€æ¬¾è®°å½•éƒ½åŒ…å«äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªç”¨æˆ·ç©¶ç«Ÿæœ‰å¤šå°‘æ¡é€€æ¬¾è®°å½•ï¼šå¥½å®¶ä¼™ï¼Œ1000å¤šwæ¡è®°å½•ã€‚ã€‚é‚£ä¹ˆæœ‰äººä¼šè¯´ï¼Œæ—¶é—´æ®µå¤§ä¹Ÿæ²¡å…³ç³»ï¼Œä¸æ˜¯è¿˜æœ‰å…¶ä»–ç´¢å¼•é¡¹å¯ä»¥è¿›è¡Œçº¦æŸå—ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬äºŒä¸ªé—®é¢˜ ç´¢å¼•çœŸçš„ç”¨ä¸Šäº†ä¹ˆï¼Ÿä¸ºäº†é˜²æ­¢mysqlä¼˜åŒ–å™¨å‡ºç°çŸ³å¿—è¡Œä¸ºï¼Œè¿™æ¡sqlç‰¹æ„å‘Šè¯‰mysqlï¼šæ‚¨å•¥ä¹Ÿä¸ç”¨æƒ³ï¼å°±ç”¨è¿™ä¸ªç´¢å¼•ï¼é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªç´¢å¼•ï¼šidx_sellerUserId_created_statusã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šåˆ—ç´¢å¼•ï¼Œæ˜¯ä¸€ä¸ªç”±sellerUserIdã€createdã€statusä¸‰åˆ—ç»„æˆçš„ä¸€ä¸ªè”åˆç´¢å¼•ã€‚å†æ¥çœ‹ä¸‹è¿™æ¡sqlçš„whereæ¡ä»¶ï¼šWHERE sellerUserId = 40955202 and status IN(800, 900) and created &gt;= 946656000 AND created &lt; 2051193600 order by createdã€‚ä¹ä¸€çœ‹ï¼Œå¥½åƒç´¢å¼•æ²¡ç”¨ä¸Šå•Šï¼Ÿç´¢å¼•çš„æ’åºæ˜¯sellerUserIdã€createdã€statusï¼Œè€Œwhereæ¡ä»¶çš„é¡ºåºæ˜¯sellerUserIdã€statusã€createdã€‚é‚£ç´¢å¼•æ˜¯ä¸æ˜¯æ²¡ç”¨äº†ï¼Ÿå½“ç„¶ä¸æ˜¯çš„ï¼mysqlå¦‚æœè¿è¿™ç‚¹ä¼˜åŒ–éƒ½æ²¡æœ‰è€ƒè™‘ï¼Œé‚£å’Œå’¸é±¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿï¼Ÿåœ¨è¿™é‡Œï¼Œmysqlä¼šå°†whereæ¡ä»¶åšä¸€ä¸ªä¼˜åŒ–ï¼Œwhereæ¡ä»¶å†…çš„é¡ºåºæ˜¯ä¸å½±å“æ­¤ç´¢å¼•çš„ä½¿ç”¨çš„ã€‚é‚£ä¹ˆè¿™ä¸ªç´¢å¼•çœŸçš„ç”Ÿæ•ˆäº†ä¹ˆï¼Ÿäº‹å®æ˜¯å¹¶æ²¡æœ‰ã€‚æˆ‘ä»¬æ¥åˆ†æä¸‹è¿™ä¸ªç´¢å¼•ï¼Œæ³¨æ„çœ‹è¿™ä¸ªæ¡ä»¶ï¼šcreated &gt;= 946656000 AND created &lt; 2051193600ï¼Œå¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ï¼Œè€Œåœ¨å¤šåˆ—ç´¢å¼•çš„ä½¿ç”¨ä¸­ï¼Œå¦‚æœç¢°åˆ°äº†èŒƒå›´æ¡ä»¶ï¼Œé‚£ä¹ˆå­˜å‚¨å¼•æ“æ˜¯ä¸ä¼šä½¿ç”¨èŒƒå›´æ¡ä»¶å³è¾¹çš„åˆ—çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå’±ä»¬è¿™æ¡sqlï¼Œç´¢å¼•åˆ°äº†idx_sellerUserId_createdå°±åˆ°å¤´äº†ï¼Œä¸ä¼šå†ä½¿ç”¨statusåšç´¢å¼•ã€‚å¼ºåˆ¶èµ°çš„è¿™ä¸ªç´¢å¼•ï¼Œå¤±æ•ˆäº†ï¼å› æ­¤è¿™æ¡æŸ¥è¯¢åªç”¨åˆ°éƒ¨åˆ†çš„ç´¢å¼• æŸ¥è¯¢çœŸçš„æœ‰å¿…è¦é‚£ä¹ˆå†™ä¹ˆï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°whereæ¡ä»¶ä¸­é™åˆ¶äº†createdå­—æ®µçš„æŸ¥è¯¢èŒƒå›´ï¼Œè€Œåœ¨æ’åºæ—¶åˆéœ€è¦æ ¹æ®createdå­—æ®µè¿›è¡Œé€†åºæ’åºï¼Œä¹‹ååˆåªå–äº†æœ€ç»ˆç»“æœçš„å¼€å¤´50è¡Œã€‚å°½ç®¡æˆ‘ä»¬å¾ˆç†æƒ³åŒ–åœ°è®¾æƒ³mysqlåªä¼šè¿”å›æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œæ¯”å¦‚åœ¨è¿™æ¡sqlä¸­æˆ‘ä»¬çœŸçš„å¾ˆå¸Œæœ›mysqlå¯ä»¥åªæ‰«æ50è¡Œå°±æœç´¢æˆ‘ä»¬éœ€è¦çš„é‚£50æ¡æ•°æ®ã€‚ç„¶è€Œï¼Œåœ¨çœŸæ­£çš„æŸ¥è¯¢ä¸­æˆ‘ä»¬æƒŠäººåœ°å‘ç°mysqlè¯»å–äº†è¶…è¿‡åƒä¸‡æ¡çš„æ•°æ®ï¼ä¸€éƒ¨åˆ†çš„åŸå› åœ¨äºæŸ¥è¯¢è¿‡ç¨‹ä¸­ä½¿ç”¨äº†ä¸å¤ªåˆé€‚çš„ç´¢å¼•ï¼Œå¦ä¸€æ–¹é¢åœ¨äºæˆ‘ä»¬çš„æŸ¥è¯¢å¤ªç´¯èµ˜äº†ï¼Œè¦æƒ³æˆ‘ä»¬çš„æŸ¥è¯¢ä¸é‚£ä¹ˆç´¯èµ˜ï¼Œé¦–å…ˆè¦ææ¸…æ¥šæˆ‘ä»¬è¦æŸ¥è¯¢ä»€ä¹ˆã€‚å¦‚ä¸Šå°±åˆ†æè¿‡ï¼Œæˆ‘ä»¬éœ€è¦çš„åªæ˜¯è¯¥ç”¨æˆ·åˆ›å»ºçš„ã€å¤„äºæŸäº›çŠ¶æ€çš„ã€æœ€æ–°çš„50æ¡è®°å½•ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹createdå­—æ®µçš„èŒƒå›´è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ é‚£ä¹ˆé’ˆå¯¹ä¸Šé¢å‡ ä¸ªé—®é¢˜ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æƒ³åŠæ³•æ¥ä¼˜åŒ–ä¸‹è¿™æ¡æŸ¥è¯¢å§ï¼ä»¥ä¸Šçš„æˆªå›¾å’Œé—®é¢˜éƒ½æ¥æºäºçº¿ä¸Šï¼Œå› ä¸ºæ¥ä¸‹æ¥çš„æ“ä½œå¯èƒ½ä¼šæ¶‰åŠåˆ°è¡¨ç»“æ„ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥ä½¿ç”¨ä¸€ä¸ªçº¿ä¸‹çš„dbæ¥è¿›è¡Œæ¨¡æ‹Ÿ é¦–å…ˆçœ‹ä¸‹è¡¨çš„ç»“æ„ ç„¶åæˆ‘ä»¬æ¥æŸ¥è¯¢ä¸‹é€€æ¬¾æ•°é‡æœ€å¤šçš„ç”¨æˆ· æˆ‘ä»¬å‘ç°idä¸º93106308çš„ç”¨æˆ·é€€æ¬¾æ•°é‡æœ€å¤šï¼Œå¤§æ¦‚æœ‰5wå¤šè¡Œï¼Œé‚£ä¹ˆå°±ç”¨ä»–æ¥åšæ¨¡æ‹Ÿå§ï¼ é¦–å…ˆæ¥æ¨¡æ‹Ÿä¸‹æœ€åˆçš„sqlè¯­å¥ 12345678explain select* FROM Refund FORCE INDEX (idx_sellerUserId_created_status) WHERE sellerUserId=93106308 and status IN (700, 900, 1000) AND created &gt;= 1278691200 AND created &lt; 1531152000 ORDER BY created desc LIMIT 0, 10 å¦‚ä¸Šå›¾æ‰€ç¤ºçš„æ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œmysqlç¡®å®ä½¿ç”¨äº†idx_sellerUserId_created_statusè¿™ä¸ªç´¢å¼•ï¼ˆè¿™å…¶å®æ˜¯åºŸè¯ï¼Œä½ éƒ½å¼ºåˆ¶äººå®¶èµ°äº†ï¼Œï¼Œï¼‰ï¼Œç„¶åçœ‹rowsè¿™ä¸€è¡Œï¼š64867ï¼å­˜å‚¨å¼•æ“æ‰«ææ¥6wå¤šè¡Œæ‰å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼å¯ä»¥çœ‹åˆ°åœ¨Extraè¿™ä¸€åˆ—ä¸­æ˜¾ç¤ºçš„æ˜¯ï¼šUsing index conditionï¼Œè¿™è¡¨ç¤ºæŸ¥è¯¢éƒ¨åˆ†ä½¿ç”¨äº†ç´¢å¼•ï¼Œå¯¹äºä¸åœ¨ç´¢å¼•ä¸­çš„åˆ—éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®ï¼Œè¿™ä¹Ÿå¦‚æˆ‘ä»¬é¢„æƒ³çš„é‚£æ · é‚£ä¹ˆæˆ‘ä»¬æ¥è¯•è¯•å­˜å‚¨å¼•æ“çš„è‡ªåŠ¨ä¼˜åŒ–å§ï¼š å“ˆå“ˆï¼Œå­˜å‚¨å¼•æ“çš„æŸ¥è¯¢ä¼˜åŒ–å…¶å®å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆå¥½ï¼ˆä½†ä¹Ÿæ²¡é‚£ä¹ˆå·®ï¼‰ï¼Œå»é™¤äº†å¼ºåˆ¶ç´¢å¼•åå­˜å‚¨å¼•æ“è‡ªå·±æ‰¾åˆ°äº†ä¸€ä¸ªå®ƒè®¤ä¸ºçš„æœ€ä¼˜çš„ç´¢å¼•ï¼šidx_createdï¼Œå¯ä»¥çœ‹åˆ°Extraè¿™ä¸€åˆ—ä¸­æ˜¾ç¤ºçš„æ˜¯ï¼šUsing whereï¼Œè¿™è¡¨ç¤ºæŸ¥è¯¢éœ€è¦å›è¡¨ææ•°æ®ä»¥åå†ä½¿ç”¨whereæ¡ä»¶æ¥è¿›è¡Œè¿‡æ»¤ã€‚é‚£ä¹ˆå’Œä¸Šé¢çš„æƒ…å†µåšå¯¹æ¯”ï¼Œåœ¨æ€§èƒ½ä¸Šå…¶å®æ˜¯æ¯«æ— å·®åˆ«ã€‚ é‚£æˆ‘ä»¬åœ¨ç´¢å¼•ä¸Šæ¥ä¼˜åŒ–ä¸‹å§ï¼Œä¸ºäº†é¿å…é‡åˆ°èŒƒå›´æŸ¥è¯¢è€Œä½¿å³è¾¹ç´¢å¼•åˆ—å¤±æ•ˆï¼Œæˆ‘ä»¬æ¥å°†idx_sellerUserId_created_statusç´¢å¼•ä¿®æ”¹ä¸ºidx_sellerUserId_status_createdï¼Œå¹¶ä¸”è®©å­˜å‚¨å¼•æ“å¼ºåˆ¶èµ°è¿™ä¸ªç´¢å¼•ï¼š å‘ç°å˜åŒ–äº†ä¹ˆï¼ŸæŸ¥è¯¢æ‰«æçš„è¡Œæ•°å°‘äº†å¾ˆå¤šï¼ é‚£æ¥ä¸‹æ¥å†ä¼˜åŒ–ä¸‹æŸ¥è¯¢è¯­å¥ï¼š å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºä¼˜åŒ–äº†æŸ¥è¯¢è¯­å¥ï¼Œæ ¹æ®createdè¿›è¡Œé€†åºæ’åºï¼Œå¯¼è‡´æœ€åæ‰«æçš„è¡Œæ•°å¤§ä¸ºå‡å°‘ï¼ åœ¨è¿™é‡Œï¼Œè¿™æ¡æŸ¥è¯¢çš„ä¼˜åŒ–å¹¶ä¸æ˜¯åœ¨ä»»ä½•åœºæ™¯ä¸‹éƒ½æ˜¯èƒ½ä¿è¯æœ‰å¾ˆé«˜çš„æŸ¥è¯¢æ€§èƒ½çš„ã€‚æˆ‘ä»¬çŸ¥é“ç´¢å¼•åœ¨dbä¸­ç»´æŠ¤äº†ä¸€ä¸ªb+tree ç»“æ„ï¼ˆinnodbå¼•æ“é»˜è®¤ç»“æ„ï¼‰ã€‚idx_createdç´¢å¼•å°†æ‰€æœ‰çš„æ•°æ®æ ¹æ®createdæ¥å»ºç«‹äº†ä¸€ä¸ªb+treeï¼Œå½“æˆ‘ä»¬è¦æŸ¥è¯¢çš„ç”¨æˆ·æ•°æ®æ°å¥½åœ¨b+treeçš„åæ–¹çš„æ—¶å€™ï¼ŒæŸ¥è¯¢ä¹Ÿæ˜¯éœ€è¦æ‰«æä¸å°‘è¡Œçš„ï¼š æ‰€ä»¥ä¸åŒçš„æ•°æ®åº“çš„æ•°æ®ç»“æ„éœ€è¦å…·ä½“çš„åˆ†æï¼Œå¦‚æœæ²¡æœ‰å¯¹è¡¨ç»“æ„ä»¥åŠæ•°æ®ç»“æ„æœ‰è¾ƒæ¸…æ™°çš„è®¤è¯†ï¼Œæˆ‘è®¤ä¸ºè¿™ç§æŸ¥è¯¢ä¼˜åŒ–æ˜¯ä¸å¤ªè¡Œçš„ï¼Œæœ‰æ—¶å€™ç”šè‡³ä¼šèµ·åˆ°åé¢æ•ˆæœã€‚ æ‰€ä»¥ç»¼åˆè€ƒè™‘ï¼Œæˆ‘è¿˜æ˜¯å»ºè®®ä¿®æ”¹ä¸‹ç´¢å¼•ç»“æ„å³å¯ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸æ˜¯ç›´æ¥å¢åŠ ä¸€ä¸ªç´¢å¼•ï¼Œè¿™æ˜¯ä¸ºäº†å‡å°å­˜å‚¨å¼•æ“çš„å‹åŠ›ï¼Œè¿‡å¤šçš„å†—ä½™ç´¢å¼•ä¹Ÿç»™ç»´æŠ¤å¸¦æ¥è´Ÿæ‹… æ¥ä¸‹æ¥çš„åšå®¢ä¼šç³»ç»Ÿåœ°è®²è¿°ä¸‹mysqlçš„ç´¢å¼•åŠæŸ¥è¯¢ä¼˜åŒ– å¯¹ä¸Šè¿°é—®é¢˜æœ‰é—®é¢˜æˆ–è€…æƒ³ä¸€èµ·è®¨è®ºçš„æœ‹å‹å¯ä»¥éšæ—¶è”ç³»ï½]]></content>
      <tags>
        <tag>sql</tag>
        <tag>æ•°æ®åº“</tag>
        <tag>ç´¢å¼•</tag>
        <tag>ä¼˜åŒ–</tag>
      </tags>
  </entry>
</search>
